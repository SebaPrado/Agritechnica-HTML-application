<!DOCTYPE html>
<html>
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&family=Montserrat:wght@400;500;700;900&family=Be+Vietnam+Pro:wght@400;500;700;900&family=Noto+Sans:wght@400;500;700;900"
    />

    <title>Zetrack Energy Management</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.5.0/mapbox-gl-draw.css" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <style>
      /* Estilos para notificaciones */
      @keyframes slideIn {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      @keyframes slideOut {
        from {
          transform: translateX(0);
          opacity: 1;
        }
        to {
          transform: translateX(100%);
          opacity: 0;
        }
      }

      .notification {
        animation: slideIn 0.3s ease forwards;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        transition: all 0.3s ease;
      }

      .notification.hiding {
        animation: slideOut 0.3s ease forwards;
      }

      /* Estilos para los inputs de fecha */
      input[type="datetime-local"] {
        background-color: transparent !important;
        color: var(--turqueza) !important;
      }
      
      input[type="datetime-local"]::-webkit-calendar-picker-indicator {
        filter: invert(62%) sepia(86%) saturate(434%) hue-rotate(130deg) brightness(92%) contrast(98%);
        cursor: pointer;
      }

      /* Estilos para los badges de estado */
      .status-badge {
        transition: all 0.3s ease;
      }

      :root {
        /* Variables globales de colores */
        --azul-oscuro: #253544;
        --turqueza: #4ABBBD;
        --azul-2: #0b2545;
      }

      .view {
        transition: opacity 0.3s ease;
        opacity: 1;
        position: relative;
        z-index: 10;
      }

      .view.hidden {
        display: none !important;
        opacity: 0;
      }

      /* Asegurar que las vistas sean visibles */
      .view:not(.hidden) {
        display: block !important;
        opacity: 1 !important;
        visibility: visible !important;
      }

      /* Asegurar que las vistas tomen todo el ancho disponible */
      .view {
        width: 100% !important;
        max-width: none !important;
        min-width: 0 !important; 
      }

      .nav-item {
        border-radius: 8px;
        transition: all 0.2s ease;
        white-space: nowrap;
      }

      .nav-item:hover {
        background-color: #1a2040;
      }

      .nav-item.active {
        background-color: #21284a !important;
      }

      /* Estilos para el sidebar expandible */
      .sidebar {
        position: fixed;
        width: 250px !important;
        top: 0;
        left: 0;
        height: 100vh;
        transition: width 0.5s ease;
        z-index: 100;
        /* box-shadow: 3px 0px 6px -3px rgba(47, 57, 106, 0.5); */
      }

      .sidebar.collapsed {
        width: 80px !important;
      }

      .sidebar.collapsed .nav-text {
        display: none;
      }

      .sidebar.collapsed .sidebar-title {
        display: none;
      }

      #main-content {
        margin-left: 250px;
        transition: margin-left 0.5s ease;
        /* background-color: green; */
        /* padding-top: 1.25rem; */
        /* padding-bottom: 1.25rem; */
      }

      body.sidebar-colapsado #main-content {
        margin-left: 80px;
      }


      .nav-item {
        border-radius: 8px;
        transition: all 0.2s ease;
        white-space: nowrap;
      }

      .nav-item:hover {
        background-color: #1a2040;
      }

      .nav-item.active {
        background-color: #21284a !important;
      }

      /* Estilos para el ícono de flecha */
      .toggle-arrow {
        transition: transform 0.3s ease;
      }

      .sidebar.collapsed .toggle-arrow {
        transform: rotate(180deg);
      }

      /* Ocultar watermark de Mapbox en el mapa de misiones */
      #missionsMap .mapboxgl-ctrl-bottom-right {
        display: none !important;
      }
      
      #missionsMap .mapboxgl-ctrl-bottom-left {
        display: none !important;
      }
      
      /* Ocultar logo de Mapbox */
      #missionsMap .mapboxgl-ctrl-logo {
        display: none !important;
      }
      
      /* Ocultar enlaces de Mapbox */
      #missionsMap .mapboxgl-ctrl-attrib {
        display: none !important;
      }
      
      /* Estilos adicionales para el mapa de misiones */
      #missionsMap {
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      }
      
      /* Ocultar cualquier control adicional de Mapbox */
      #missionsMap .mapboxgl-ctrl-group {
        display: none !important;
      }
      
      #missionsMap .mapboxgl-ctrl {
        display: none !important;
      }

      #vehicle-general {
        /* background-color: red; */
        height: 100%;
      }
      /* Estilos para tooltips */
      .nav-tooltip {
        position: relative;
      }

      .nav-tooltip::before {
        content: attr(data-tooltip);
        position: absolute;
        left: 100%;
        top: 50%;
        transform: translateY(-50%);
        background-color: #21284a;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.2s ease;
        margin-left: 8px;
        z-index: 1000;
      }

      .sidebar.collapsed .nav-tooltip:hover::before {
        opacity: 1;
      }

      /* Estilos para tooltips de botones flotantes del mapa */
      .map-tooltip {
        position: relative;
      }

      .map-tooltip::before {
        content: attr(data-tooltip);
        position: absolute;
        left: 100%;
        top: 50%;
        transform: translateY(-50%);
        background-color: #21284a;
        color: white;
        padding: 6px 10px;
        border-radius: 6px;
        font-size: 10px;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        margin-left: 8px;
        z-index: 1000;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      }

      .map-tooltip::after {
        content: '';
        position: absolute;
        left: 100%;
        top: 50%;
        transform: translateY(-50%);
        margin-left: 4px;
        border: 4px solid transparent;
        border-right-color: #21284a;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        z-index: 1000;
      }

      .map-tooltip:hover::before,
      .map-tooltip:hover::after {
        opacity: 1;
      }

      /* Estilos para las barras de batería */
      /* .battery-bar {
        position: relative;
        height: 100%;
        flex: 1;
        display: flex;
        align-items: center;
      } */

      .threshold-line {
        position: absolute;
        left: 0;
        height: 100%;
        background-color: #ff6b6b;
        opacity: 0.65;
        transition: width 0.3s ease, opacity 0.3s ease;
        z-index: 5;
      }

      .progress-bar {
        position: relative;
        z-index: 10;
        height: 100%;
        background-color: rgba(33, 40, 74, 0.8);
        border-right: 2px solid #8e99cc;
        transition: all 0.3s ease;
        backdrop-filter: blur(1px);
      }

      /* Efecto de fade-in desde la izquierda para las barras de progreso */
      .progress-bar-animate {
        animation: progressBarSlideIn 1.2s ease-out 0.5s both;
        transform-origin: left center;
      }

      @keyframes progressBarSlideIn {
        from {
          transform: scaleX(0);
          opacity: 0;
        }
        to {
          transform: scaleX(1);
          opacity: 1;
        }
      }

      /* Efecto sutil de brillo que se desliza desde la izquierda */
      .progress-bar::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.08), transparent);
        transform: translateX(-100%);
        transition: transform 0.4s ease-out;
        pointer-events: none;
        z-index: 1;
      }

      .progress-bar-animate::before {
        transform: translateX(100%);
      }

      /* Estilos para el slider interactivo */
      .threshold-slider {
        user-select: none;
        touch-action: none;
      }

      #threshold-handle {
        transition: left 0.1s ease-out;
        z-index: 10;
        border: 1px solid rgba(255, 255, 255, 0.6);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      }

      #threshold-handle:hover {
        box-shadow: 0 0 10px rgba(96, 122, 251, 0.6), 0 2px 8px rgba(0, 0, 0, 0.3);
        transform: translateY(-50%) scale(1.1);
      }

      #threshold-handle:active {
        transform: translateY(-50%) scale(1.2);
        box-shadow: 0 0 15px rgba(96, 122, 251, 0.8), 0 2px 8px rgba(0, 0, 0, 0.3);
      }

      .threshold-slider.dragging #threshold-handle {
        transition: none;
        transform: translateY(-50%) scale(1.2);
        box-shadow: 0 0 15px rgba(96, 122, 251, 0.8), 0 2px 8px rgba(0, 0, 0, 0.3);
      }

      /* Animación para el círculo de progreso */
      .progress-circle-animate {
        animation: progressCircleDraw 2s ease-out 0.8s both;
        stroke-dasharray: 0, 100;
      }

      .progress-circle-animate-22 {
        animation: progressCircleDraw22 2s ease-out 0.8s both;
        stroke-dasharray: 0, 100;
      }

      .progress-circle-animate-80 {
        animation: progressCircleDraw80 2s ease-out 0.8s both;
        stroke-dasharray: 0, 100;
      }

      /* Estilos para el slider de baterías */
      .battery-slide {
        transition: all 0.5s ease-in-out;
      }

      .battery-slide.active {
        opacity: 1;
        transform: translateX(0);
      }

      .battery-slide.hidden {
        opacity: 0;
        transform: translateX(100%);
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
      }

      .slide-indicator {
        transition: all 0.3s ease;
        cursor: pointer;
      }

      .slide-indicator.active {
        background-color: #607afb;
        transform: scale(1.2);
      }

      /* Estilos para el modal de baterías */
      .modal-backdrop {
        /* background-color: rgba(0, 0, 0, 0.8); */
        background-color: green;
        backdrop-filter: blur(4px);
      }

      .modal-content {
        animation: modalSlideIn 0.3s ease-out;
      }

      @keyframes modalSlideIn {
        from {
          opacity: 0;
          transform: scale(0.9) translateY(-20px);
        }
        to {
          opacity: 1;
          transform: scale(1) translateY(0);
        }
      }

      .modal-battery-slide {
        transition: all 0.5s ease-in-out;
      }

      .modal-battery-slide.active {
        opacity: 1;
        transform: translateX(0);
      }

      .modal-battery-slide.hidden {
        opacity: 0;
        transform: translateX(100%);
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
      }

      .modal-slide-indicator {
        transition: all 0.3s ease;
        cursor: pointer;
      }

      .modal-slide-indicator.active {
        background-color: #607afb;
        transform: scale(1.2);
      }

      @keyframes progressCircleDraw {
        from {
          stroke-dasharray: 0, 100;
        }
        to {
          stroke-dasharray: 65.46, 100;
        }
      }

      @keyframes progressCircleDraw22 {
        from {
          stroke-dasharray: 0, 100;
        }
        to {
          stroke-dasharray: 22, 100;
        }
      }

      @keyframes progressCircleDraw80 {
        from {
          stroke-dasharray: 0, 100;
        }
        to {
          stroke-dasharray: 80, 100;
        }
      }

      .progress-bar.below-threshold {
        background-color: rgba(255, 107, 107, 0.9);
        border-right-color: #ff6b6b;
      }

      /* Estilos para el slider */
      input[type="range"] {
        -webkit-appearance: none;
        appearance: none;
        height: 4px;
        /* background: #21284a; */
        /* background: red; */
        border-radius: 2px; /* Ajustado para mantener proporción */
        background-image: linear-gradient(#607afb, #607afb);
        background-repeat: no-repeat;
      }

      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        height: 10px; /* Reducido de 16px a 12px */
        width: 10px; /* Reducido de 16px a 12px */
        border-radius: 50%;
        background: #8598f9;
        /* background: red; */
        cursor: pointer;
        box-shadow: 0 0 2px 0 #555;
        transition: background .3s ease-in-out;
        margin-top: -3px; /* Ajuste para centrar el thumb */
      }

      input[type="range"]::-webkit-slider-runnable-track {
        -webkit-appearance: none;
        box-shadow: none;
        border: none;
        background: transparent;
        height: 4px; /* Reducido para coincidir */
      }

      /* Estilos para el mapa en vivo */
      .live-map-container {
        position: relative;
        height: 600px;
        /* O la altura que prefieras */
        background-color: #0c0f1a;
        /* Un color de fondo oscuro */
        border-radius: 8px;
        background-size: cover;
        background-position: center;
      }

      .vehicle-icon {
        position: absolute;
        display: flex;
        flex-direction: column;
        align-items: center;
        cursor: pointer;
        transition: transform 0.2s ease;
      }

      .vehicle-icon:hover {
        transform: scale(1.1);
        z-index: 20;
      }

      .vehicle-icon svg {
        width: 32px;
        height: 32px;
        padding: 4px;
        border-radius: 50%;
        background-color: rgba(16, 19, 35, 0.8);
        border: 1px solid var(--turqueza);
      }

      .vehicle-icon-label {
        margin-top: 4px;
        padding: 2px 6px;
        font-size: 12px;
        font-weight: 500;
        color: white;
        background-color: rgba(0, 0, 0, 0.6);
        border-radius: 4px;
        white-space: nowrap;
      }

      /* --- MAPBOX STYLES --- */
      #map {
        width: 100%;
        height: 100%;
        position: relative;
        border-radius: 8px;
      }
      .mapboxgl-canvas {
        border-radius: 8px;
      }
      .calculation-box {
        height: 75px;
        width: 150px;
        position: absolute;
        bottom: 10px;
        left: 10px;
        background-color: rgba(16, 19, 35, 0.9);
        padding: 15px;
        text-align: center;
        border-radius: 6px;
        border: 1px solid var(--turqueza);
        color: #8e99cc;
        z-index: 20;
      }

      .calculation-box p {
        font-family: 'Montserrat', 'Be Vietnam Pro', 'Noto Sans', sans-serif;
        margin: 0;
        font-size: 13px;
      }
      
      .calculation-box p strong {
        color: #fff;
      }

      #areas-list {
        position: absolute;
        top: 10px;
        left: 10px;
        width: 250px;
        z-index: 20;
        background: rgba(16, 19, 35, 0.9);
        border: 1px solid var(--turqueza);
        border-radius: 6px;
        padding: 10px;
        font-family: 'Montserrat', 'Be Vietnam Pro', 'Noto Sans', sans-serif;
        font-size: 14px;
        color: #8e99cc;
      }
      #areas-list b { color: #fff; }
      #areas-list ul { list-style:none; padding:0; margin-top: 8px;}
      #areas-list li { margin-bottom:8px; color: #fff; }
      #areas-list button {
        margin-left:8px; 
        background:none; 
      }

      /* Estilos para el botón flotante del mapa */
      .map-info-btn {
        position: relative;
        z-index: 30;
        transition: all 0.3s ease;
      }

      .map-info-btn:hover {
        transform: scale(1.1);
        box-shadow: 0 8px 25px rgba(47, 57, 106, 0.4);
      }

      .map-info-btn:active {
        transform: scale(0.95);
      }

      /* Estilos para todos los modales */
      #mapModal,
      #energyStatusModal
      /* #vehicleListModal */
       {
        animation: fadeIn 0.3s ease-out;
      }

      /* Efecto de blur y oscurecimiento para toda la vista */
      .modal-backdrop {
        /* backdrop-filter: blur(20px); */
        /* -webkit-backdrop-filter: blur(20px); */
        background: rgba(0, 0, 0, 0.6);
        transition: all 0.3s ease;
        z-index: 50;
      }

      /* Clase para controlar la visibilidad del modal */
      .modal-visible {
        display: flex !important;
        animation: fadeIn 0.3s ease-out forwards;
      }

      /* Aseguramos que la animación funcione correctamente */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: scale(0.95);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      /* Estado oculto del modal */
      .modal-backdrop.hidden {
        display: none;
        z-index: -1;
        pointer-events: none;
        /* opacity: 0; ya no es necesaria porque display: none oculta el elemento */
      }

      /* Animación de entrada para el contenido del modal */
      .modal-content {
        animation: slideIn 0.3s ease-out;
      }

      /* Estilos para el slider de vehículos */
      .vehicle-slide {
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        opacity: 0;
        transform: translateX(100%) scale(0.95);
        pointer-events: none;
        filter: blur(2px);
      }

      .vehicle-slide.hidden {
        opacity: 0;
        transform: translateX(-100%) scale(0.95);
        pointer-events: none;
        filter: blur(2px);
      }

      .vehicle-slide.active {
        opacity: 1;
        transform: translateX(0) scale(1);
        pointer-events: auto;
        filter: blur(0px);
      }

      .vehicle-slide.prev {
        opacity: 0.3;
        transform: translateX(-100%) scale(0.9);
        pointer-events: none;
        filter: blur(3px);
      }

      .vehicle-slide.next {
        opacity: 0.3;
        transform: translateX(100%) scale(0.9);
        pointer-events: none;
        filter: blur(3px);
      }

      /* Contenedor del slider con overflow hidden */
      .vehicle-slider-container {
        position: relative;
        overflow: hidden;
        min-height: 320px;
        /* background: linear-gradient(135deg, rgba(16, 19, 35, 0.1) 0%, rgba(47, 57, 106, 0.05) 100%); */
        border-radius: 12px;
        padding-top: 2px;
        transition: height 0.3s ease;
        /* background: red; */
        /* padding: 20px; */
      }

      /* Transiciones suaves para elementos internos del slide */
      .vehicle-slide * {
        transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      }

      /* ===== SISTEMA DE ANIMACIONES DEL SLIDER ===== */
      
      /* Clases de comportamiento de animación (no de color) */
      .slide-text-fade-in {
        animation: fadeInElement 0.6s ease-out 0.3s both;
      }
      
      .slide-text-fade-in-delayed {
        animation: fadeInElement 0.8s ease-out 0.5s both;
      }
      
      .slide-element-slide-in {
        animation: slideInElement 0.8s ease-out 0.7s both;
      }
      
      /* Aplicar animaciones a elementos específicos del slider con mayor especificidad */
      .vehicle-slide.active .slide-text-fade-in {
        animation: fadeInElement 0.6s ease-out 0.3s both !important;
      }
      
      .vehicle-slide.active .slide-text-fade-in-delayed {
        animation: fadeInElement 0.8s ease-out 0.5s both !important;
      }
      
      .vehicle-slide.active .slide-element-slide-in {
        animation: slideInElement 0.8s ease-out 0.7s both !important;
      }
      
      /* Asegurar que las animaciones funcionen incluso con Tailwind */
      .slide-text-fade-in {
        animation: fadeInElement 0.6s ease-out 0.3s both !important;
      }

      /* Transición suave para el título del modal */
      #vehicleModalTitle {
        transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      }

      /* Estilos para las barras de progreso del slider */
      /* .vehicle-slide .bg-[var(--turqueza)] {
        transition: width 0.8s ease;
      } */

      /* Indicadores de slide */
      .slide-indicators {
        display: flex;
        justify-content: center;
        gap: 8px;
        margin-top: 8px;
      }

      .slide-indicator {
        width: 10px;
        height: 10px;
        border-radius: 51%;
        background-color: #2f396a;
        cursor: pointer;
        transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        transform: scale(0.8);
        opacity: 0.6;
      }

      .slide-indicator.active {
        background-color: #607afb;
        transform: scale(1.3);
        opacity: 1;
        box-shadow: 0 0 10px rgba(96, 122, 251, 0.5);
      }

      /* Efecto de sombra para el slide activo */
      /*.vehicle-slide.active {
         filter: drop-shadow(0 15px 35px rgba(0, 0, 0, 0.4)); 
         box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2); 
      }

       #mapModal .bg-[var(--azul-oscuro)] {
        animation: slideIn 0.3s ease-out;
      } */

      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }

      @keyframes slideIn {
        from { 
          opacity: 0; 
          transform: translateY(-20px) scale(0.95);
        }
        to { 
          opacity: 1; 
          transform: translateY(0) scale(1);
        }
      }

      /* Animaciones para elementos del slider */
      @keyframes slideInElement {
        from { 
          opacity: 0; 
          transform: translateX(-30px);
        }
        10% {
          opacity: 0.05;
          transform: translateX(-15px);
        }
        to { 
          opacity: 1; 
          transform: translateX(0);
        }
      }

      @keyframes fadeInElement {
        from { 
          opacity: 0; 
          transform: translateY(10px);
        }
        to { 
          opacity: 1; 
          transform: translateY(0);
        }
      }

      /* NOTA: Las animaciones ahora se manejan con las clases de comportamiento */
      /* .slide-text-fade-in, .slide-text-fade-in-delayed, etc. */

      /* Estilos para los checkboxes del modal */
      .form-checkbox {
        appearance: none;
        width: 18px;
        height: 18px;
        border: 2px solid #2f396a;
        border-radius: 4px;
        background-color: transparent;
        cursor: pointer;
        position: relative;
        transition: all 0.2s ease;
      }

      .form-checkbox:checked {
        background-color: #607afb;
        border-color: #607afb;
      }

      .form-checkbox:checked::after {
        content: '✓';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 12px;
        font-weight: bold;
      }

      .form-checkbox:hover {
        border-color: #607afb;
      }

      #json-modal {
        display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.6); z-index:9999; align-items:center; justify-content:center;
      }
      #json-modal-content-wrapper {
        background:var(--turqueza); border-radius:8px; padding:24px 18px 18px 18px; min-width:320px; max-width:90vw; max-height:80vh; overflow:auto; position:relative; box-shadow:0 4px 24px #0003; border: 1px solid var(--turqueza);
      }
      #close-json-modal {
        position:absolute; top:8px; right:12px; background:none; border:none; font-size:22px; cursor:pointer; color: #8e99cc;
      }
      #json-modal-content {
        font-family:monospace; font-size:13px; white-space:pre-wrap; margin:0; color: #e2e8f0;
      }
      .mapboxgl-ctrl-group {
        background-color: #181d35 !important;
        border-radius: 6px !important;
        box-shadow: 0 0 10px 0 rgba(0,0,0,0.5)
      }
      .mapboxgl-ctrl-group button {
        background-color: #21284a !important;
        width: 34px !important;
        height: 34px !important;
        border: none !important;
      }
       .mapboxgl-ctrl-group button:not(:last-child){
         border-bottom: 1px solid var(--turqueza) !important;
       }
      .mapboxgl-ctrl-group button:hover {
        background-color: #2f396a !important;
      }

      .mapboxgl-ctrl-group .mapbox-gl-draw_ctrl-draw-btn .mapboxgl-ctrl-icon {
        background-size: 60%;
        background-repeat: no-repeat;
        background-position: center;
      }

      .mapbox-gl-draw_polygon {
        background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M20.78 6.22a.75.75 0 0 0-1.06-1.06L13 11.94V5.75a.75.75 0 0 0-1.5 0v7.5a.75.75 0 0 0 .75.75h7.5a.75.75 0 0 0 0-1.5h-6.19l6.78-6.78Z'/%3E%3Cpath d='M3.22 17.78a.75.75 0 0 0 1.06 1.06l6.72-6.72v6.19a.75.75 0 0 0 1.5 0v-7.5a.75.75 0 0 0-.75-.75h-7.5a.75.75 0 0 0 0 1.5h6.19l-6.72 6.72Z'/%3E%3C/svg%3E") !important;
      }

      .mapbox-gl-draw_trash {
        background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath fill-rule='evenodd' d='M16.5 4.478v.227a49.81 49.81 0 0 1 3.978 0v-.227a3 3 0 0 0-3-3h-3.879a.75.75 0 0 1 0-1.5h3.879a4.5 4.5 0 0 1 4.5 4.5v.227c.33.04.66.094.99.158a.75.75 0 1 1-.296 1.456 48.345 48.345 0 0 0-7.898 0 .75.75 0 0 1-.296-1.456c.33-.064.66-.118.99-.158v-.227a3 3 0 0 0-3-3h-3.879a.75.75 0 0 1 0-1.5h3.879a4.5 4.5 0 0 1 4.5 4.5ZM8.25 6.375a.75.75 0 0 1 .75.75v8.25a.75.75 0 0 1-1.5 0V7.125a.75.75 0 0 1 .75-.75Zm3.75 0a.75.75 0 0 1 .75.75v8.25a.75.75 0 0 1-1.5 0V7.125a.75.75 0 0 1 .75-.75Zm3.75 0a.75.75 0 0 1 .75.75v8.25a.75.75 0 0 1-1.5 0V7.125a.75.75 0 0 1 .75-.75Z' clip-rule='evenodd'/%3E%3Cpath d='M8.547 21.22a.75.75 0 0 1-.722-.559l-1.356-4.067a.75.75 0 0 1 .23-.79L10.02 12.5a.75.75 0 1 1 1.255.828l-3.325 3.325.867 2.6a.75.75 0 0 1-.559.722l-4.067 1.356a.75.75 0 0 1-.22.029Zm7.896 0a.75.75 0 0 1-.942-.26L12 16.039l3.43 3.92a.75.75 0 0 1-.26.942l-1.356 1.355a.75.75 0 0 1-.56.22Z'/%3E%3C/svg%3E") !important;
      }
      .mapbox-gl-draw_polygon.active {
        background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23607afb'%3E%3Cpath d='m21.426 12.922-3.172 4.229a.75.75 0 0 1-1.206-.06l-4.124-6.873a.75.75 0 0 0-1.248,0L8.528 15.68l-2.43-2.43a.75.75 0 0 0-1.06 0l-3.25 3.25a.75.75 0 0 0 0 1.061l3.5 3.5a.75.75 0 0 0 1.06 0l3.074-3.073 2.518 2.517a.75.75 0 0 0 1.132-.213l4.336-7.227 3.384-4.512a.75.75 0 0 0-1.033-1.033l-4.512 3.384-1.218.914-.914-1.218.914-1.218 1.218-.914a.75.75 0 0 1 .914 1.218l-.305.406 3.172-4.23a.75.75 0 0 1 1.206.061l4.124 6.873a.75.75 0 0 0 1.248 0l.94-1.565a.75.75 0 1 1 1.3.782l-.94 1.566a.75.75 0 0 1-1.248 0Z'/%3E%3C/svg%3E") !important;
      }

      /* --- POPUP STYLES --- */
      .mapboxgl-popup-content {
        background-color: #181d358f !important;
        color: white !important;
        border-radius: 6px !important;
        padding: 12px 15px !important;
        border: 1px solid var(--turqueza) !important;
        box-shadow: 0 2px 10px rgba(0,0,0,0.5) !important;
      }
      .mapboxgl-popup-tip {
        border-top-color: #181d35 !important;
      }
      .mapboxgl-popup-close-button {
        color: #8e99cc !important;
        font-size: 22px;
        padding: 0 5px;
        height: 25px;
        width: 25px;
        line-height: 25px;
      }
      .mapboxgl-popup-close-button:hover {
        background-color: #2f396a !important;
      }
      .mapboxgl-popup-content h1 {
        font-size: 1rem; /* 16px */
        font-weight: 400;
        margin-bottom: 4px;
        color: #fff;
      }
      .mapboxgl-popup-content p {
        font-size: 0.875rem; /* 14px */
        margin: 0;
        color: #8e99cc;
      }
      .mapboxgl-popup-content p strong { color: #fff; }
      .mapboxgl-popup-content ul { list-style-type: none; padding-left: 0; margin-top: 4px; }
      .mapboxgl-popup-content li { font-size: 0.875rem; color: #8e99cc; margin-left: 10px; }


 /*  ====================================        ANIMACIONES           =========================================== */

/* ✅ SOLUCIÓN 2: Elementos anidados (más control) */
.attention-wrapper {
  animation: fadeIn 0.8s ease-out 0.6s both;
  display: inline-block;
}

.attention-text-nested {
  animation: attentionPulse 2.3s ease-in-out infinite;
  display: inline-block;
  transform-origin: center;
  font-weight: 500;
  text-shadow: 0 0 8px rgba(34, 197, 94, 0.6);
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes attentionPulse {
  0%, 100% {
    transform: scale(1.0);
    opacity: 1;
    text-shadow: 0 0 8px rgba(34, 197, 94, 0.6);
  }
  50% {
    transform: scale(1.05);
    opacity: 0.8;
    text-shadow: 0 0 15px rgba(34, 197, 94, 0.9);
  }
}
/*=========================================================================================================== */

/* ====================================        SIMULACIÓN DE BATERÍA           =========================================== */

/* Transición sutil para cambios de valor de batería */
.battery-value-change {
  transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
}

/* Efecto sutil de "respiración" durante el cambio */
.battery-value-changing {
  animation: batteryBreathing 0.8s ease-in-out;
}

@keyframes batteryBreathing {
  0%, 100% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(1.05);
    opacity: 0.8;
  }
}

/* Indicador visual de descarga (opcional) */
.battery-low {
  color: #fbbf24 !important; /* Cambio a amarillo cuando está bajo */
  text-shadow: 0 0 8px rgba(251, 191, 36, 0.4);
}

.battery-critical {
  color: #ef4444 !important; /* Cambio a rojo cuando es crítico */
  text-shadow: 0 0 8px rgba(239, 68, 68, 0.4);
}

        /* Estilo para los decimales de la batería */
        .battery-decimal {
          font-size: 55%;
          opacity: 0.8;
          vertical-align: baseline;
        }
        
        /* ====================================        EFECTO DE TRES PUNTOS           =========================================== */
        
        /* Contenedor de los puntos - ancho fijo para evitar movimiento */
        .battery-dots {
          display: inline-block;
          margin-left: 2px;
          font-weight: normal;
          color: #ffffff; /* Mismo color blanco que el texto */
          opacity: 0.4; /* Opacidad reducida */
          width: 24px; /* Ancho fijo para evitar movimiento */
          text-align: left;
          overflow: hidden;
          vertical-align: text-bottom; /* Alinear exactamente en la base del texto */
          line-height: 1; /* Mantener la altura de línea normal */
          height: auto; /* Altura automática */
        }
        
        /* Animación de escritura de puntos */
        .battery-dots::before {
          content: '';
          animation: writeDots 5.5s ease-in-out infinite;
        }
        
        @keyframes writeDots {
          0% {
            content: '';
          }
          20% {
            content: '.';
          }
          40% {
            content: '..';
          }
          60% {
            content: '...';
          }
          80% {
            content: '';
          }
          100% {
            content: '';
          }
        }



       /* Estilos para las barras de batería */
      .battery-bar {
        position: relative;
        height: 100%;
        flex: 1;
        display: flex;
        align-items: center;
      }

      #map2 {
        width: 100%;
        height: 100%;
        position: relative;
        border-radius: 8px;
      }
      #map3 {
        width: 100%;
        height: 100%;
        position: relative;
        border-radius: 8px;
      }

      /* --- CUSTOM ZOOM CONTROLS --- */
      .custom-zoom-controls {
        position: absolute;
        top: 10px;
        right: 10px;
        z-index: 20;
        display: flex;
        flex-direction: column;
        background-color: var(--azul-oscuro);
        border-radius: 6px;
        box-shadow: 0 0 10px 0 rgba(0,0,0,0.5);
      }
      .custom-zoom-controls button {
        background-color: var(--azul-oscuro);
        color: #fff;
        border: none;
        width: 34px;
        height: 34px;
        font-size: 22px;
        font-weight: bold;
        cursor: pointer;
        line-height: 34px;
      }
      .custom-zoom-controls button:first-child {
        border-top-left-radius: 6px;
        border-top-right-radius: 6px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }
      .custom-zoom-controls button:last-child {
        border-bottom-left-radius: 6px;
        border-bottom-right-radius: 6px;
      }
      .custom-zoom-controls button:hover {
        background-color: var(--azul-oscuro);
        opacity: 0.8;
      }

      /* Animaciones para el reloj - hover en el card completo */
      .animated-clock {
        transition: all 0.3s ease;
      }

      .clock-card:hover .animated-clock {
        animation: clock-pulse 2s ease-in-out infinite;
      }

      .clock-hands {
        transform-origin: 128px 128px;
        transition: all 0.3s ease;
      }

      .clock-card:hover .animated-clock .clock-hands {
        animation: clock-tick 2s linear infinite;
      }

      @keyframes clock-pulse {
        0%, 100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.7;
          transform: scale(1.05);
        }
      }

      @keyframes clock-tick {
        0% {
          stroke-dasharray: 0 200;
          stroke-dashoffset: 0;
        }
        50% {
          stroke-dasharray: 100 100;
          stroke-dashoffset: -50;
        }
        100% {
          stroke-dasharray: 0 200;
          stroke-dashoffset: -200;
        }
      }
    </style>
  </head>
  <body class="sidebar-colapsado">
    <div
      class="relative flex size-full min-h-screen pr-4 flex-col bg-[var(--azul-oscuro)] dark group/design-root overflow-x-hidden"
      style='font-family: "Montserrat", "Be Vietnam Pro", "Noto Sans", sans-serif;'
    >
       <div class="layout-container flex h-full grow flex-col">
        <div class="gap- 1 flex flex-1 justify-start py-5">

  <!-- ================================================================================ -->
          
  <!--=================                Sidebar Navigation               ==================-->
          
  <!-- ================================================================================ -->

  <!--  Sidebar Navigation  -->
          <div class="sidebar collapsed shadow-[var(--turqueza)]/50/50 flex-col mt-4">
                    <div class="flex h-full flex-col justify-between p-4">
              <div class="flex flex-col h-full justify-between">
                <!-- Grupo Superior -->
              <div class="flex flex-col gap-4">
                <div class="flex items-center gap-3 " style="margin: -7px; margin-bottom: 0;">
                  <img src="data:image/png;base64,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
                    " alt="Logo" style="width: 100%; height: 38px; object-fit: contain;" />
                  <!-- <h1 class="sidebar-title text-white text-base font-medium leading-normal">Energy Management</h1> -->
                </div>
                
                <div class="flex flex-col gap-2">
                  <div onclick="toggleSidebar()" class="nav-tooltip nav-item grid items-center px-3 py-2 cursor-pointer" style="grid-template-columns: 24px 1fr 24px;" data-tooltip="Toggle Menu">
                    <div class="toggle-arrow" data-icon="CaretLeft" data-size="24px" data-weight="regular" style="color: var(--turqueza); padding-left: 2px ">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="18px" fill="currentColor" viewBox="0 0 256 256">
                        <path d="M168.49,199.51a12,12,0,0,1-17,17l-80-80a12,12,0,0,1,0-17l80-80a12,12,0,0,1,17,17L97,128Z"></path>
                      </svg>
                    </div>
                    <p class="nav-text text-xs font-medium leading-normal text-center" style="color: var(--turqueza);">Energy Management</p>
                    <div></div>
                  </div>
                  <div onclick="navigateTo('live-monitoring-2')" class="nav-tooltip nav-item flex items-center gap-3 px-3 py-2 cursor-pointer" data-view="live-monitoring-2" data-tooltip="Live Monitoring">
                    <div class="text-white" data-icon="Globe" data-size="20px" data-weight="regular" style="padding-left: 2px;">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="18px" fill="currentColor" viewBox="0 0 256 256"><path d="M128,24a104,104,0,1,0,104,104A104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm64-88a64.71,64.71,0,0,1-3.34,21.34l-5.65-5.65A40,40,0,0,0,128,88V40.48A87.83,87.83,0,0,1,192,128ZM40,128A87.83,87.83,0,0,1,88,40.48V88a40,40,0,0,0,52.31,38.66l-5.65,5.65A64.71,64.71,0,0,1,40,128Z"></path></svg>
                    </div>
                    <p class="nav-text text-white text-xs font-medium leading-normal">Live Monitoring</p>
                  </div>
                  
                  <div onclick="navigateTo('reservation')" class="nav-tooltip nav-item flex items-center gap-3 px-3 py-2 cursor-pointer" data-view="reservation" data-tooltip="Battery as a Service">
                    <div class="text-white" data-icon="BatteryCharging" data-size="20px" data-weight="regular" style="padding-left: 2px;">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="18px" fill="currentColor" viewBox="0 0 256 256">
                        <path d="M200,56H32A24,24,0,0,0,8,80v96a24,24,0,0,0,24,24H200a24,24,0,0,0,24-24V80A24,24,0,0,0,200,56Zm8,120a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8H200a8,8,0,0,1,8,8Zm48-80v64a8,8,0,0,1-16,0V96a8,8,0,0,1,16,0ZM138.81,123.79a8,8,0,0,1,.35,7.79l-16,32a8,8,0,0,1-14.32-7.16L119.06,136H100a8,8,0,0,1-7.16-11.58l16-32a8,8,0,1,1,14.32,7.16L112.94,120H132A8,8,0,0,1,138.81,123.79Z"></path>
                      </svg>
                    </div>
                    <p class="nav-text text-white text-xs font-medium leading-normal">Battery as a Service</p>
                  </div>
                  <div onclick="navigateTo('work')" class="nav-tooltip nav-item flex items-center gap-3 px-3 py-2 cursor-pointer" data-view="work" data-tooltip="Energy Master">
                    <div class="text-white" data-icon="Briefcase" data-size="20px" data-weight="regular" style="padding-left: 2px;">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="18px" fill="currentColor" viewBox="0 0 256 256">
                        <path d="M152,80V56a16,16,0,0,0-16-16H120a16,16,0,0,0-16,16V80H40a16,16,0,0,0-16,16v80a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V96a16,16,0,0,0-16-16ZM120,56h16V80H120ZM216,176H40V96H216v80Z"></path>
                      </svg>
                    </div>
                    <p class="nav-text text-white text-xs font-medium leading-normal">Energy Planner</p>
                  </div>
                  <div onclick="navigateTo('history')" class="nav-tooltip nav-item flex items-center gap-3 px-3 py-2 cursor-pointer" data-view="history" data-tooltip="Consumption History">
                    <div class="text-white" data-icon="ChartLine" data-size="20px" data-weight="regular" style="padding-left: 2px;">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="18px" fill="currentColor" viewBox="0 0 256 256">
                        <path d="M232,208a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V48a8,8,0,0,1,16,0V152.77l61.17-61.18a8,8,0,0,1,11.31,0L148.1,127.2,215.32,60A8,8,0,0,1,226.63,71.32l-73.54,73.54a8,8,0,0,1-11.31,0L106.17,109.25,40,175.42V200H224A8,8,0,0,1,232,208Z"></path>
                      </svg>
                    </div>
                    <p class="nav-text text-white text-xs font-medium leading-normal">Consumption History</p>
                  </div>
                  </div>
                </div>
                
                <!-- Grupo Inferior -->
                <div class="flex flex-col gap-2 mt-auto pt-4 pb-8 border-t border-[var(--turqueza)] border-opacity-50">
                  <div onclick="navigateTo('battery')" class="nav-tooltip nav-item flex items-center gap-3 px-3 py-2 cursor-pointer" data-view="battery" data-tooltip="Battery System Health">
                    <div class="text-white flex items-center justify-center text-lg font-bold" style="width: 20px; height: 18px;">
                      1
                    </div>
                    <p class="nav-text text-white text-xs font-medium leading-normal">Battery System Health</p>
                  </div>
                  <div onclick="navigateTo('missions')" class="nav-tooltip nav-item flex items-center gap-3 px-3 py-2 cursor-pointer" data-view="missions" data-tooltip="Missions & Tasks">
                    <div class="text-white flex items-center justify-center text-lg font-bold" style="width: 20px; height: 18px;">
                      2
                    </div>
                    <p class="nav-text text-white text-xs font-medium leading-normal">Missions</p>
                  </div>
                  <div onclick="navigateTo('settings')" class="nav-tooltip nav-item flex items-center gap-3 px-3 py-2 cursor-pointer" data-view="settings" data-tooltip="Settings">
                    <div class="text-white" data-icon="GearSix" data-size="20px" data-weight="regular" style="padding-left: 2px;">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="18px" fill="currentColor" viewBox="0 0 256 256">
                        <path d="M232,112a16,16,0,0,1-8.18,13.9l-51.35,29.68a16,16,0,0,1-16.36.69L135.68,139.9a16,16,0,0,1-7.68-13.9V112a16,16,0,0,1,8.18-13.9l51.35-29.68a16,16,0,0,1,16.36-.69L223.68,98.1A16,16,0,0,1,232,112ZM128,80a48,48,0,1,0,48,48A48.05,48.05,0,0,0,128,80Zm0,80a32,32,0,1,1,32-32A32,32,0,0,1,128,160Z"></path>
                      </svg>
                    </div>
                    <p class="nav-text text-white text-xs font-medium leading-normal">Settings</p>
                  </div>
                </div>
              </div>
              <button class="toggle-btn hidden" onclick="toggleSidebar()">
                <div class="text-white toggle-arrow" data-icon="CaretLeft" data-size="20px" data-weight="regular">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="18px" fill="currentColor" viewBox="0 0 256 256">
                    <path d="M168.49,199.51a12,12,0,0,1-17,17l-80-80a12,12,0,0,1,0-17l80-80a12,12,0,0,1,17,17L97,128Z"></path>
                  </svg>
                </div>
              </button>
            </div>
          </div>

<!-- ================================================================================ -->
          
<!--=================                Main Content Area               ==================-->
          
<!-- ================================================================================ -->

            <!-- Main Content Area -->
          <div id="main-content" class="flex flex-col flex-1">
            <!-- ================================================================== -->
            <!-- =                  Battery as a service VIEW                      = -->
            <!-- ================================================================== -->
            <div id="reservation-view" class="view hidden w-full">
              <div class="flex flex-wrap justify-between gap-3 px-10 py-5">
                <p class="text-white tracking-light text-[28px]  leading-tight min-w-72">Battery as a Service</p>
              </div>
              <!-- <h2 class="text-white text-[22px] leading-tight tracking-[-0.015em]   px-10">Reservation Management</h2> -->
              <div class="flex flex-wrap gap-4 px-10 py-5">
                <div class="flex min-w-[158px] flex-1 flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                  <p class="text-white text-base font-medium leading-normal">Confirmed Reservations</p>
                  <p class="text-white tracking-light text-2xl font-bold leading-tight">1</p>
                </div>
                <div class="flex min-w-[158px] flex-1 flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                  <p class="text-white text-base font-medium leading-normal">Pending Reservations</p>
                  <p class="text-white tracking-light text-2xl font-bold leading-tight">1</p>
                </div>
              </div>
              <div class="p-10">
                
                <h3 class="text-white text-lg mb-4"> My Reservations</h3>
                <div class="overflow-x-auto">
                  <table class="w-full">
                    <thead>
                      <tr class="text-left">
                        <th class="text-white text-sm font-medium p-2">Reservation Id</th>
                        <th class="text-white text-sm font-medium p-2">Start Time</th>
                        <th class="text-white text-sm font-medium p-2">End Time</th>
                        <th class="text-white text-sm font-medium p-2">Consumption kvh</th>
                        <th class="text-white text-sm font-medium p-2">Status</th>
                      </tr>
                    </thead>
                    <tbody id="reservationList">
                      <!-- Las reservas se agregarán aquí dinámicamente -->
                    </tbody>
                  </table>
                
               </div>
              </div>
              <div class="p-4">
                <div class="rounded p-6  transition-all duration-300 border-opacity-50">
                   <h3 class="text-white text-lg mb-6 text-center flex items-center justify-center gap-2">
                     <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-6 h-6 text-[var(--turqueza)] me-3">
                       <rect width="256" height="256" fill="none"/>
                       <path d="M224,200v8a32,32,0,0,1-32,32H136" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/>
                       <path d="M224,128H192a16,16,0,0,0-16,16v40a16,16,0,0,0,16,16h32V128a96,96,0,1,0-192,0v56a16,16,0,0,0,16,16H64a16,16,0,0,0,16-16V144a16,16,0,0,0-16-16H32" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/>
                     </svg>
                     Make a Reservation
                   </h3>
                  
                  <!-- Toggle Switch -->
                  <div class="flex items-center justify-center mb-6">
                    <div class="flex items-center space-x-4 bg-[var(--azul-oscuro)]/50 p-2 rounded-full border border-[#4ABBBD]/30">
                      <button id="packToggle" onclick="toggleReservationType('pack')" class="px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 bg-[var(--turqueza)] text-white">
                        Pack
                      </button>
                      <button id="stationToggle" onclick="toggleReservationType('station')" class="px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 text-[var(--turqueza)]">
                        Battery Station
                      </button>
                    </div>
                  </div>

                  <div class="grid grid-cols-1 gap-4 p-10  border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70" style="border-radius: 8px;">
                    <div id="vehicleSection">
                      <label class="block text-white text-sm font-medium mb-2">Vehicle</label>
                      <select id="reservationVehicle" class="w-full p-2 rounded bg-transparent text-[var(--turqueza)] border border-[#4a5578]">
                        <option value="" disabled selected class="bg-transparent text-[var(--turqueza)]">Select vehicle</option>
                        <option value="zetrabot1" class="bg-transparent text-[var(--azul-oscuro)]">Zetrabot-001</option>
                        <option value="zetrabot2" class="bg-transparent text-[var(--azul-oscuro)]">Zetrabot-002</option>
                      </select>
                    </div>
                    <div>
                      <label id="quantityLabel" class="block text-white text-sm font-medium mb-2">Number of packs</label>
                      <select id="reservationPacks" class="w-full p-2 rounded bg-transparent text-[var(--turqueza)] border border-[#4a5578]">
                        <option value="" disabled selected class="bg-transparent text-[var(--turqueza)]">select the amount</option>
                        <option value="1" class="bg-transparent text-[var(--azul-oscuro)]">1</option>
                        <option value="2" class="bg-transparent text-[var(--azul-oscuro)]">2</option>
                        <option value="3" class="bg-transparent text-[var(--azul-oscuro)]">3</option>
                        <option value="4" class="bg-transparent text-[var(--azul-oscuro)]">4</option>
                      </select>
                    </div>
                    <div>
                      <label class="block text-white text-sm font-medium mb-2">Start Time</label>
                      <input id="reservationStart" type="datetime-local" class="w-full p-2 rounded bg-transparent text-[var(--turqueza)] border border-[#4a5578]">
                    </div>
                    <div>
                      <label class="block text-white text-sm font-medium mb-2">End Time</label>
                      <input id="reservationEnd" type="datetime-local" class="w-full p-2 rounded bg-transparent text-[var(--turqueza)] border border-[#4a5578]">
                    </div>
                    <button onclick="requestReservation()" class="mt-4 bg-[var(--turqueza)] text-white px-6 py-2 rounded hover:scale-105 transition-all duration-300">
                      Request Reservation
                    </button>
                  </div>
                  
                </div>
              </div>
            </div>

            <!-- ===================================================================================================================== -->
            <!-- ============                                LIVE MONITORING 2 VIEW (Map View)                          =============== -->
            <!-- ===================================================================================================================== -->
           
            <div id="live-monitoring-2-view" class="view hidden h-full">
               <!-- ================================================================== -->
               <!-- =                        MAP view                                = -->
               <!-- ================================================================== -->
              <div class="bg-[white] rounded-lg relative border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50" style="height: 95vh;">
                <div id="map3"></div>
                
                <!-- Botón flotante de Energy Status (lado izquierdo 1/3 ) -->
                <div class="absolute top-4 left-4 z-30">
                  <button 
                    onclick="openEnergyStatusModal()" 
                    class="map-info-btn map-tooltip bg-[var(--azul-oscuro)] hover:bg-[var(--azul-oscuro)]/80 text-white rounded-full w-12 h-12 flex items-center justify-center shadow-lg transition-all duration-200 hover:scale-110 hover:shadow-xl"
                    data-tooltip="Energy Overview"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 256 256">
                      <path d="M240,160v24a16,16,0,0,1-16,16H115.93a4,4,0,0,1-3.24-6.35L174.27,109a8.21,8.21,0,0,0-1.37-11.3,8,8,0,0,0-11.37,1.61l-72,99.06A4,4,0,0,1,86.25,200H32a16,16,0,0,1-16-16V161.13c0-1.79,0-3.57.13-5.33a4,4,0,0,1,4-3.8H48a8,8,0,0,0,8-8.53A8.17,8.17,0,0,0,47.73,136H23.92a4,4,0,0,1-3.87-5c12-43.84,49.66-77.13,95.52-82.28a4,4,0,0,1,4.43,4V80a8,8,0,0,0,8.53,8A8.17,8.17,0,0,0,136,79.73V52.67a4,4,0,0,1,4.43-4A112.18,112.18,0,0,1,236.23,131a4,4,0,0,1-3.88,5H208.27a8.17,8.17,0,0,0-8.25,7.47,8,8,0,0,0,8,8.53h27.92a4,4,0,0,1,4,3.86C240,157.23,240,158.61,240,160Z"></path>
                    </svg>
                  </button>
                </div>

                <!-- Botón flotante de Vehicle Fleet Status (lado izquierdo, 2/3 ) -->
                <div class="absolute top-20 left-4 z-30">
                  <button 
                    onclick="openVehicleStatusModal()" 
                    class="map-info-btn map-tooltip bg-[var(--azul-oscuro)] hover:bg-[var(--azul-oscuro)]/80 text-white rounded-full w-12 h-12 flex items-center justify-center shadow-lg transition-all duration-200 hover:scale-110 hover:shadow-xl"
                    data-tooltip="Vehicle Fleet Status"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="384 282 32 32">
                      <g>
                        <path d="m390.49085,289.18182l0,7.25c-1.34766,0.30469 -2.58203,0.88281 -3.625,1.71875l1.25,1.5625c1.19922,-0.96094 2.71484,-1.53125 4.375,-1.53125c3.87891,0 7,3.12109 7,7l4.5625,0c-0.34766,0.59375 -0.5625,1.26563 -0.5625,2c0,2.19922 1.80078,4 4,4c2.19922,0 4,-1.80078 4,-4c0,-1.02734 -0.41797,-1.94531 -1.0625,-2.65625l2,-4.96875l0.0625,-0.1875l0,-2.1875l-3.78888,-0.02626l-3.42733,0.02626l-3.09629,0l-2.75,-7.34375l-0.25,-0.65625l-8.6875,0zm2,2l5.3125,0l2.75,7.34375l0.25,0.65625l9.59375,0l-1.59375,4l-7.5625,0c-0.91797,-3.99609 -4.48047,-7 -8.75,-7l0,-5zm0,8c-3.30078,0 -6,2.69922 -6,6c0,3.30078 2.69922,6 6,6c3.30078,0 6,-2.69922 6,-6c0,-3.30078 -2.69922,-6 -6,-6zm0,2c2.22266,0 4,1.77734 4,4c0,2.22266 -1.77734,4 -4,4c-2.22266,0 -4,-1.77734 -4,-4c0,-2.22266 1.77734,-4 4,-4zm0,2c-1.10547,0 -2,0.89453 -2,2c0,1.10547 0.89453,2 2,2c1.10547,0 2,-0.89453 2,-2c0,-1.10547 -0.89453,-2 -2,-2zm15,2c1.11719,0 2,0.88281 2,2c0,1.11719 -0.88281,2 -2,2c-1.11719,0 -2,-0.88281 -2,-2c0,-1.11719 0.88281,-2 2,-2z" />
                        <path d="m407.27288,289.85509l2.95442,-5.12783l0,3.50852l2.95444,0l-2.95444,5.12783l0.00012,-3.50852l-2.95454,0z"/>
                      </g>
                    </svg>
                  </button>
                </div>

                <!-- Botón flotante de información sobre el mapa (lado izquierdo, 3/3 ) -->
                <div class="absolute top-36 left-4 z-30">
                  <div class="relative">
                    <button 
                      onclick="openMapModal()" 
                      class="map-info-btn map-tooltip bg-[var(--azul-oscuro)] hover:bg-[var(--azul-oscuro)]/80 text-white rounded-full w-12 h-12 flex items-center justify-center shadow-lg transition-all duration-200 hover:scale-110 hover:shadow-xl"
                      data-tooltip="Alerts"
                    >
                      <svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 256 256">
                        <path
                          d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm-8-80V80a8,8,0,0,1,16,0v56a8,8,0,0,1-16,0Zm20,36a12,12,0,1,1-12-12A12,12,0,0,1,140,172Z"
                        ></path>
                      </svg>
                    </button>
                
                    <!-- Badge con el número -->
                    <span class="absolute bottom-0 right-0 translate-x-1/4 translate-y-1/4 bg-[var(--turqueza)] text-white text-xs w-5 h-5 rounded-full flex items-center justify-center shadow z-40">
                      1
                    </span>
                  </div>
                </div>
                

                <div class="custom-zoom-controls">
                  <button id="zoom-in-btn">+</button>
                  <button id="zoom-out-btn">-</button>
                </div>
              </div>

              <!-- Modal del mapa -->
              <div id="mapModal" class="modal-backdrop fixed inset-0 z-50 hidden flex items-center justify-center">
                <div class="modal-content bg-[var(--azul-oscuro)] border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 rounded-lg shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                  <!-- Header del modal -->
                  <div class="flex items-center justify-between p-6 border-b border-[var(--turqueza)] border-opacity-50">
                    <h3 class="text-white text-xl font-semibold">Notifications </h3>
                    <button 
                      onclick="closeMapModal()" 
                      class="text-[#8e99cc] hover:text-white transition-colors duration-200"
                    >
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
                        <path d="M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"></path>
                      </svg>
                    </button>
                  </div>

                  <!-- Contenido del modal -->
                  <!-- <h2 class="text-white text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">Alerts</h2> -->
                  <div class="flex items-center gap-4 bg-[var(--azul-oscuro)] px-4 min-h-[72px] py-2">
                    <div class="text-white flex items-center justify-center rounded bg-[var(--turqueza)] shrink-0 size-12" data-icon="WarningCircle" data-size="24px" data-weight="regular">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                        <path
                          d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm-8-80V80a8,8,0,0,1,16,0v56a8,8,0,0,1-16,0Zm20,36a12,12,0,1,1-12-12A12,12,0,0,1,140,172Z"
                        ></path>
                      </svg>
                    </div>
                    <div class="flex flex-col justify-center">
                      <p class="text-white text-base font-medium leading-normal line-clamp-1">Vehicle C</p>
                      <p class="text-[var(--turqueza)] text-sm font-normal leading-normal line-clamp-2">Charging Failure</p>
                    </div>
                  </div>
                  <div class="flex items-center gap-4 px-4 min-h-[72px] py-2">
                    <div class="text-white flex items-center justify-center rounded bg-[var(--azul-2)] shrink-0 size-12" data-icon="WarningCircle" data-size="24px" data-weight="regular">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                        <path
                          d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm-8-80V80a8,8,0,0,1,16,0v56a8,8,0,0,1-16,0Zm20,36a12,12,0,1,1-12-12A12,12,0,0,1,140,172Z"
                        ></path>
                      </svg>
                    </div>
                    <div class="flex flex-col justify-center">
                      <p class="text-white text-base font-medium leading-normal line-clamp-1">Vehicle B</p>
                      <p class="text-[var(--turqueza)] text-sm font-normal leading-normal line-clamp-2">Abnormal Charging Time</p>
                    </div>
                  </div>
                  <div class="flex items-center gap-4  px-4 min-h-[72px] py-2">
                    <div class="text-white flex items-center justify-center rounded bg-[var(--azul-2)] shrink-0 size-12" data-icon="WarningCircle" data-size="24px" data-weight="regular">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                        <path
                          d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm-8-80V80a8,8,0,0,1,16,0v56a8,8,0,0,1-16,0Zm20,36a12,12,0,1,1-12-12A12,12,0,0,1,140,172Z"
                        ></path>
                      </svg>
                    </div>
                    <div class="flex flex-col justify-center">
                      <p class="text-white text-base font-medium leading-normal line-clamp-1">Vehicle A</p>
                      <p class="text-[var(--turqueza)] text-sm font-normal leading-normal line-clamp-2">Damaged Cells</p>
                    </div>
                  </div>
                  <div class="flex items-center gap-4 px-4 min-h-[72px] py-2">
                    <div class="text-white flex items-center justify-center rounded bg-[var(--azul-2)] shrink-0 size-12" data-icon="WarningCircle" data-size="24px" data-weight="regular">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                        <path
                          d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm-8-80V80a8,8,0,0,1,16,0v56a8,8,0,0,1-16,0Zm20,36a12,12,0,1,1-12-12A12,12,0,0,1,140,172Z"
                        ></path>
                      </svg>
                    </div>
                    <div class="flex flex-col justify-center">
                      <p class="text-white text-base font-medium leading-normal line-clamp-1">Vehicle C</p>
                      <p class="text-[var(--turqueza)] text-sm font-normal leading-normal line-clamp-2">Overheating</p>
                    </div>
                  </div>

                 
                </div>
              </div>

              <!-- Modal de Energy Status -->
              <div id="energyStatusModal" class="modal-backdrop fixed inset-0 z-50 hidden flex items-center justify-center">
                <div class="modal-content bg-[var(--azul-oscuro)] border border-[#4ABBBD]/50 rounded-lg shadow-2xl max-w-5xl w-full mx-4 max-h-[95vh] overflow-y-auto custom-scrollbar">
                  <style>
                    .custom-scrollbar::-webkit-scrollbar {
                      width: 8px;
                    }
                    .custom-scrollbar::-webkit-scrollbar-track {
                      background: rgba(47, 57, 106, 0.2);
                      border-radius: 4px;
                    }
                    .custom-scrollbar::-webkit-scrollbar-thumb {
                      background: rgba(74, 187, 189, 0.3);
                      border-radius: 4px;
                    }
                    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                      background: rgba(74, 187, 189, 0.5);
                    }
                  </style>
                  <!-- Header del modal -->
                  <div class="flex items-center justify-between p-6 border-b border-[#4ABBBD]/50">
                    <h3 class="text-white text-xl font-semibold">Energy Overview</h3>
                    <button 
                      onclick="closeEnergyStatusModal()" 
                      class="text-[var(--turqueza)] hover:text-white transition-colors duration-200"
                    >
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
                        <path d="M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"></path>
                      </svg>
                    </button>
                  </div>

                  <!-- Contenido del modal -->
                  <div class="p-10 space-y-8">
                    <!-- Resumen de energía del sistema -->
                    <div class="space-y-6">
                      <!-- <h4 class="text-white text-lg font-medium border-b border-[var(--turqueza)] border-opacity-50 pb-2">System Energy Summary</h4> -->
                      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="p-6 rounded-lg border border-[#4ABBBD]/50 text-center hover:border-[--turqueza] transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-[#4ABBBD]/20">
                          <p class="text-white text-sm slide-text-fade-in">Total Capacity</p>
                          <p class="text-white text-2xl font-bold slide-text-fade-in flex items-center justify-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 256 256" class="me-2">
                              <rect width="24" height="24" fill="none"/>
                              <rect x="16" y="64" width="200" height="128" rx="16" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="8"/>
                              <line x1="176" y1="96" x2="176" y2="160" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="8"/>
                              <line x1="136" y1="96" x2="136" y2="160" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="8"/>
                              <line x1="96" y1="96" x2="96" y2="160" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="8"/>
                              <line x1="56" y1="96" x2="56" y2="160" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="8"/>
                              <line x1="248" y1="96" x2="248" y2="160" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="8"/>
                            </svg>
                          <span id="energy-total-capacity">160 kWh</span>
                          <p class="text-[var(--turqueza)] text-sm slide-text-fade-in">0-100%</p>
                        </div>
                        <div class="p-6 rounded-lg border border-[#4ABBBD]/50 text-center hover:border-[var(--turqueza)] transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-[#4ABBBD]/20">
                          <p class="text-white text-sm slide-text-fade-in">Available Energy</p>
                          <p class="text-white text-2xl font-bold slide-text-fade-in flex items-center justify-center gap-2">
                             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 256 256" class="me-2">
                               <rect width="256" height="256" fill="none"/>
                               <rect x="16" y="64" width="200" height="128" rx="16" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/>
                               <line x1="96" y1="96" x2="96" y2="160" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/>
                               <line x1="56" y1="96" x2="56" y2="160" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/>
                               <line x1="248" y1="96" x2="248" y2="160" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/>
                             </svg>
                          
                          <span id="energy-available">107 kWh</span>
                          <div class="flex flex-row justify-center">
                            <p class="text-[var(--turqueza)] text-sm slide-text-fade-in" id="energy-available-percent">66%</p>
                            <p class="text-[var(--turqueza)] text-sm slide-text-fade-in">&nbsp;of Capacity</p>
                          </div>
                        </div>
                        <div class="p-6 rounded-lg border border-[#4ABBBD]/50 text-center hover:border-[var(--turqueza)] transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-[#4ABBBD]/20 clock-card">
                          <p class="text-white text-sm slide-text-fade-in">Current Consumption</p>
                          <p class="text-white text-2xl font-bold slide-text-fade-in flex items-center justify-center gap-2" id="energy-operational-range">
                             <!-- <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="24" height="24" class="animated-clock">
                               <rect width="256" height="256" fill="none"/>
                               <circle cx="128" cy="128" r="96" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="8"/>
                               <polyline points="128 72 128 128 184 128" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="8" class="clock-hands"/>
                             </svg> -->
                             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 256 256">
                              <rect width="256" height="256" fill="none"/><circle cx="40" cy="200" r="24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/>
                              <circle cx="96" cy="96" r="24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/>
                              <circle cx="160" cy="160" r="24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/>
                              <circle cx="216" cy="56" r="24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/>
                              <line x1="84.62" y1="117.13" x2="51.38" y2="178.87" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/>
                              <line x1="143.03" y1="143.03" x2="112.97" y2="112.97" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/>
                              <line x1="204.62" y1="77.13" x2="171.38" y2="138.87" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/>
                            </svg>
                           <span> 8 kWh/hr </span> </p>
                          <p class="text-[var(--turqueza)] text-sm slide-text-fade-in">196 kWh consumed</p>
                        </div>
                      </div>
                    </div>

                    <!-- ------------------------------------------------------------------------------------------------------ -->
                    
                    <div class=" space-y-8">
                      <h4 class="text-white text-lg font-medium pb-1">Packs</h4>
                      <!-- Resumen de energía del sistema -->
                      <div class="">
                        <!-- <h4 class="text-white text-lg font-medium border-b border-[var(--turqueza)] border-opacity-50 pb-2">System Energy Summary</h4> -->
                         <div class="relative">
                           <!-- Líneas horizontales como techos -->
                           <div class="absolute top-0 left-0 h-px bg-[#4ABBBD]/50" style="width: calc(40% - 0.5rem);"></div>
                           <div class="absolute top-0 right-0 h-px bg-[#4ABBBD]/50" style="width: calc(60% - 0.5rem);"></div>
                           
                           <!-- Etiquetas superpuestas -->
                           <div class="absolute -top-2 left-0 w-[40%] flex justify-center pointer-events-none">
                             <span class="px-2 bg-[var(--azul-oscuro)] text-[var(--turqueza)] text-[10px] tracking-[0.15em] uppercase rounded-full/px shadow-[0_0_10px_rgba(74,187,189,0.25)]">Fixed</span>
                           </div>
                           <div class="absolute -top-2 right-0 w-[60%] flex justify-center pointer-events-none">
                             <span class="px-2 bg-[var(--azul-oscuro)] text-[var(--turqueza)] text-[10px] tracking-[0.15em] uppercase rounded-full/px shadow-[0_0_10px_rgba(74,187,189,0.25)]">Swappable</span>
                           </div>
                           
                           <div class="grid grid-cols-1 md:grid-cols-5 gap-4 pt-4">
                             <div class="p-6 rounded-lg border border-[#4ABBBD]/50 text-center hover:border-[--turqueza] transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-[#4ABBBD]/20">
                               <p class="text-white text-sm slide-text-fade-in">Fixed-Z426</p>
                               <p class="text-white text-2xl font-bold slide-text-fade-in" id="energy-total-capacity">20 kWh</p>
                               <p class="text-[var(--turqueza)] text-sm slide-text-fade-in">f-866-zt</p>
                             </div>
                             <div class="p-6 rounded-lg border border-[#4ABBBD]/50 text-center hover:border-[--turqueza] transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-[#4ABBBD]/20">
                               <p class="text-white text-sm slide-text-fade-in">Fixed-Z45</p>
                               <p class="text-white text-2xl font-bold slide-text-fade-in" id="energy-total-capacity">20 kWh</p>
                               <p class="text-[var(--turqueza)] text-sm slide-text-fade-in">f-866-zt</p>
                             </div>
                             <div class="p-6 rounded-lg border border-[#4ABBBD]/50 text-center hover:border-[--turqueza] transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-[#4ABBBD]/20">
                               <p class="text-white text-sm slide-text-fade-in">Swap-S15</p>
                               <p class="text-white text-2xl font-bold slide-text-fade-in" id="energy-total-capacity">20 kWh</p>
                               <p class="text-[var(--turqueza)] text-sm slide-text-fade-in">s-866-zt</p>
                             </div>
                             <div class="p-6 rounded-lg border border-[#4ABBBD]/50 text-center hover:border-[--turqueza] transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-[#4ABBBD]/20">
                               <p class="text-white text-sm slide-text-fade-in">Swap-S36</p>
                               <p class="text-white text-2xl font-bold slide-text-fade-in" id="energy-total-capacity">20 kWh</p>
                               <p class="text-[var(--turqueza)] text-sm slide-text-fade-in">s-866-zt</p>
                             </div>
                             <div class="p-6 rounded-lg border border-[#4ABBBD]/50 text-center hover:border-[--turqueza] transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-[#4ABBBD]/20">
                               <p class="text-white text-sm slide-text-fade-in">Station-38</p>
                               <p class="text-white text-2xl font-bold slide-text-fade-in" id="energy-total-capacity">20 kWh</p>
                               <p class="text-[var(--turqueza)] text-sm slide-text-fade-in">bt-866-zt</p>
                             </div>
                           </div>
                         </div>
                      </div>


                    <!-- ------------------------------------------------------------------------------------------------------ -->


                    <!-- Gráfico de energía actual -->
                    <div class="space-y-6">
                      <h4 class="text-white text-lg font-medium border-b border-[#4ABBBD]/50 pb-2 pt-4">Current Energy Distribution</h4>
                      <div class=" rounded-lg">
                        <!-- Flexbox de tres divs hijos -->
                        <div class="flex-col " >
                          <!-- Div hijo 1: Flex padre de dos hijos, dirección columna -->
                            <div class="flex flex-row gap-3 flex-1 items-center">
                               <!--    Zetrabot 1    -->
                            <!-- <div class="flex-1 p-6 flex-row rounded-xl border border-[#4ABBBD]/50 text-center  hover:border-[var(--turqueza)] hover:bg-[#1f2438] transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-[#4ABBBD]/20 cursor-pointer group">
                              <p class="text-white text-sm mb-3 slide-text-fade-in font-medium  transition-colors duration-300">Zetrabot 1</p>
                              <div class="flex flex-col gap-3 mb-3  transition-transform duration-300">
                                <div class="flex items-center gap-3">
                                  <span class="text-white text-xs opacity-80">Fixed</span>
                                  <div class="flex-1 h-2 bg-[#21284a] rounded-full overflow-hidden">
                                    <div class="h-full bg-[var(--turqueza)]" style="width: 80%;"></div>
                                  </div>
                                  <span class="text-white text-sm font-semibold" id="energy-zetrabot1-fixed-percent">80% <span class="text-[var(--turqueza)] text-xs">/35.5 kWh</span></span>
                                </div>
                                <div class="flex items-center gap-3">
                                  <span class="text-white text-xs opacity-80">Swappable</span>
                                  <div class="flex-1 h-2 bg-[#21284a] rounded-full overflow-hidden">
                                    <div class="h-full bg-[var(--turqueza)]" style="width: 50%;"></div>
                                  </div>
                                  <span class="text-white text-sm font-semibold" id="energy-zetrabot1-swappable-percent">50% <span class="text-[var(--turqueza)] text-xs">/25.5 kWh</span></span>
                                </div>
                              </div>
                              <div class="my-2" style="height:1px; background-color: rgba(74,187,189,0.35);"></div>
                              <div class="flex items-center gap-3 mt-2">
                                <span class="text-white text-xs opacity-80">Total</span>
                                <div class="flex-1 h-2 bg-[#21284a] rounded-full overflow-hidden">
                                  <div class="h-full bg-[var(--turqueza)]" style="width: 65.46%;"></div>
                                </div>
                                <span class="text-white text-sm font-semibold">65.46%</span>
                              </div>
                            </div> -->
                            
                            <!-- Zetrabot 2 -->
                              <!-- <div class="flex-1 p-6 flex-row rounded-xl border border-[#4ABBBD]/50 text-center  hover:border-[var(--turqueza)] hover:bg-[#1f2438] transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-[#4ABBBD]/20 cursor-pointer group">
                                  <p class="text-white text-sm mb-3 slide-text-fade-in font-medium  transition-colors duration-300">Zetrabot 2</p>
                                  <div class="flex flex-col gap-3 mb-3  transition-transform duration-300">
                                  <div class="flex items-center gap-3">
                                  <span class="text-white text-xs opacity-80">Fixed</span>
                                   <div class="flex-1 h-2 bg-[#21284a] rounded-full overflow-hidden">
                                   <div class="h-full bg-[var(--turqueza)]" style="width: 80%;"></div>
                                   </div>
                                   <span class="text-white text-sm font-semibold" id="energy-zetrabot1-fixed-percent">80% <span class="text-[var(--turqueza)] text-xs">/35.5 kWh</span></span>
                                   </div>
                                   <div class="flex items-center gap-3">
                                    <span class="text-white text-xs opacity-80">Swappable</span>
                                   <div class="flex-1 h-2 bg-[#21284a] rounded-full overflow-hidden">
                                   <div class="h-full bg-[var(--turqueza)]" style="width: 50%;"></div>
                                  </div>
                                  <span class="text-white text-sm font-semibold" id="energy-zetrabot1-swappable-percent">50% <span class="text-[var(--turqueza)] text-xs">/25.5 kWh</span></span>
                                  </div>
                                  </div>
                                  <div class="my-2" style="height:1px; background-color: rgba(74,187,189,0.35);"></div>
                                  <div class="flex items-center gap-3 mt-2">
                                  <span class="text-white text-xs opacity-80">Total</span>
                                  <div class="flex-1 h-2 bg-[#21284a] rounded-full overflow-hidden">
                                  <div class="h-full bg-[var(--turqueza)]" style="width: 65.46%;"></div>
                                  </div>
                                  <span class="text-white text-sm font-semibold">65.46%</span>
                                  </div>             
                            </div> -->
                  
                               <!-- <div class="flex-1 p-6 rounded-xl border border-[#4ABBBD]/50 text-center  hover:border-[var(--turqueza)] hover:bg-[#1f2438] hover:scale-105 transition-all duration-500 ease-out hover:shadow-2xl hover:shadow-[var(--turqueza)]/50/30 cursor-pointer group">
                              <p class="text-white text-sm mb-3 slide-text-fade-in font-medium  transition-colors duration-300 opacity-80">Zetrabot 2</p>
                              <div class="flex items-center justify-center gap-4 mb-3 group-hover:scale-110 transition-transform duration-300">
                                <div class="relative w-24 h-12">
                                  <svg class="w-full h-full group-hover:drop-shadow-lg group-hover:drop-shadow-[var(--turqueza)]/50/50 transition-all duration-300" viewBox="0 0 100 50">
                                    <path d="M 10,45 A 40,40 0 0,1 90,45" stroke="var(--turqueza)/20" stroke-width="8" fill="none" stroke-linecap="round"></path>
                                    <path d="M 10,45 A 40,40 0 0,1 90,45" stroke="var(--turqueza)" stroke-width="8" fill="none" stroke-linecap="round" stroke-dasharray="125.66" stroke-dashoffset="25.132" class="group-hover:stroke-[var(--turqueza)] transition-colors duration-300"></path>
                                  </svg>
                                  <div class="absolute inset-0 flex flex-col items-center justify-center mt-2">
                                    <p class="text-white text-lg font-bold mt-6 slide-text-fade-in  transition-colors duration-300" id="energy-zetrabot3-percent">80%</p>
                                  </div>
                                </div>
                                <div class="relative w-24 h-22">
                                  <svg class="w-full h-full group-hover:drop-shadow-lg group-hover:drop-shadow-[var(--turqueza)]/50/50 transition-all duration-300" viewBox="0 0 100 50">
                                    <path d="M 10,45 A 40,40 0 0,1 90,45" stroke="var(--turqueza)/20" stroke-width="8" fill="none" stroke-linecap="round"></path>
                                    <path d="M 10,45 A 40,40 0 0,1 90,45" stroke="var(--turqueza)" stroke-width="8" fill="none" stroke-linecap="round" stroke-dasharray="125.66" stroke-dashoffset="113.094" class="group-hover:stroke-[var(--turqueza)] transition-colors duration-300"></path>
                                  </svg>
                                  <div class="absolute inset-0 flex flex-col items-center justify-center mt-2">
                                    <p class="text-white text-lg font-bold mt-6 slide-text-fade-in  transition-colors duration-300" id="energy-zetrabot3-percent">10%</p>
                                  </div>
                                </div>
                              </div>
                              <div class="flex items-center justify-center gap-8 mb-2 text-xs text-white/80">
                                <div class="text-center">
                                  <p>Swappable</p>
                                </div>
                                <div class="text-center">
                                  <p>Fixed </p>
                                  <p>8.6 kWh</p>
                                </div>
                              </div>
                              <p class="text-white text-center text-lg font-bold "> 22%</p>
                            </div>
                             -->
                            
                             </div>
                          <!-- Nueva fila para Battery Station -->
                          <!-- Battery Station -->
                             <!-- <div class="flex flex-row mt-3">
                              <div class="flex-1 p-6 rounded-xl border border-[#4ABBBD]/50 text-center hover:border-[var(--turqueza)] hover:bg-[#1f2438] transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-[#4ABBBD]/20 cursor-pointer group"> 
                              <p class="text-white text-sm mb-3 slide-text-fade-in font-medium transition-colors duration-300">Battery Station</p>
                              <div class="flex items-center justify-center mb-3 group-hover:scale-110 transition-transform duration-300">
                                <div class="relative w-24 h-12">
                                  <svg class="w-full h-full group-hover:drop-shadow-lg group-hover:drop-shadow-[var(--turqueza)]/50/50 transition-all duration-300" viewBox="0 0 100 50">
                                    <path d="M 10,45 A 40,40 0 0,1 90,45" stroke="var(--turqueza)/20" stroke-width="8" fill="none" stroke-linecap="round"></path>
                                    <path d="M 10,45 A 40,40 0 0,1 90,45" stroke="var(--turqueza)" stroke-width="8" fill="none" stroke-linecap="round" stroke-dasharray="125.66" stroke-dashoffset="0" class=" transition-colors duration-300"></path>
                                  </svg>
                                  <div class="absolute inset-0 flex flex-col items-center justify-center mt-2">
                                    <p class="text-white text-lg font-bold mt-6 slide-text-fade-in  transition-colors duration-300" id="energy-battery-station-percent">100%</p>
                                  </div>
                                </div>
                              </div> 
                              <p class="text-white text-sm slide-text-fade-in group-hover:text-[var(--turqueza)] transition-colors duration-300" id="energy-battery-station-kwh">20.0 kWh</p>
                              </div>
                             </div>  -->
                          <!-- Nueva fila para cuadro de vehiculos -->
                             <div>
                               <div class=" py-3 @container">
                                <div class="flex overflow-hidden rounded border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 bg-[var(--azul-oscuro)] shadow-lg shadow-[var(--turqueza)]/50/50 transition-shadow duration-300 hover:shadow-xl">
                                   <table class="flex-1">
                                     <thead>
                                       <tr class="bg-[var(--turqueza)]">
                                         <th class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 px-4 py-3 text-left text-white w-[300px] text-xs font-medium leading-normal"></th>
                                         <th class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-180 px-4 py-3 text-left text-white w-[400px] text-xs font-medium leading-normal">State of Charge</th>
                                         <th class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 px-4 py-3 text-left text-white w-[400px] text-xs font-medium leading-normal">Fixed Pack</th>
                                         <th class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 px-4 py-3 text-left text-white w-[400px] text-xs font-medium leading-normal">Swappable Pack</th>
                                         <!-- <th class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 px-4 py-3 text-left text-white w-60 text-xs font-medium leading-normal">Status</th> -->
                                       </tr>
                                     </thead>
                                     <tbody>
                                       <tr class="border-t border-t-[#4ABBBD]/50">
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 h-[72px] px-4 py-2 w-[300px] text-white text-sm font-normal leading-normal">Zetrabot 1</td>
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-180 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                                           <p class="text-white text-base">72.5% <span class="text-[var(--turqueza)] text-sm">/ 62.8 kWh</span></p>
                                         </td>
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                                           <div class="flex items-center gap-4">
                                             <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                                               <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 85%;"></div>
                                             </div>
                                             <p class="text-white text-base ">85% <span class="text-[var(--turqueza)] text-sm">/ 35.5 kWh</span></p>
                                           </div>
                                         </td>
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                                           <div class="flex items-center gap-4">
                                             <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                                               <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 60%;"></div>
                                             </div>
                                             <p class="text-white text-base ">60% <span class="text-[var(--turqueza)] text-sm">/ 27.3 kWh</span></p>
                                           </div>
                                         </td>
                                         <!-- <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 h-[72px] px-4 py-2 w-60 text-white text-base  leading-normal">
                                           On duty
                                         </td> -->
                                       </tr>
                                       <tr class="border-t border-t-[#4ABBBD]/50">
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 h-[72px] px-4 py-2 w-[300px] text-white text-sm font-normal leading-normal">Zetrabot 2</td>
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-180 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                                           <p class="text-white text-base">67.5% <span class="text-[var(--turqueza)] text-sm">/ 58.9 kWh</span></p>
                                         </td>
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                                           <div class="flex items-center gap-4">
                                             <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                                               <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 45%;"></div>
                                             </div>
                                             <p class="text-white text-base ">45% <span class="text-[var(--turqueza)] text-sm">/ 22.4 kWh</span></p>
                                           </div>
                                         </td>
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                                           <div class="flex items-center gap-4">
                                             <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                                               <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 90%;"></div>
                                             </div>
                                             <p class="text-white text-base ">90% <span class="text-[var(--turqueza)] text-sm">/ 36.5 kWh</span></p>
                                           </div>
                                         </td>
                                         <!-- <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 h-[72px] px-4 py-2 w-60 text-white text-base  leading-normal">
                                           Available
                                         </td> -->
                                       </tr>
                                       <!-- <tr class="border-t border-t-[#4ABBBD]/50">
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 h-[72px] px-4 py-2 w-[400px] text-white text-sm font-normal leading-normal">Zetrabot-003</td>
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                                           <div class="flex items-center gap-4">
                                             <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                                               <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 20%;"></div>
                                             </div>
                                             <p class="text-white text-base ">20% <span class="text-[var(--turqueza)] text-sm">/ 16.8 kWh</span></p>
                                           </div>
                                         </td>
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                                           <div class="flex items-center gap-4">
                                             <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                                               <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 30%;"></div>
                                             </div>
                                             <p class="text-white text-base ">30% <span class="text-[var(--turqueza)] text-sm">/ 24.5 kWh</span></p>
                                           </div>
                                         </td>
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 h-[72px] px-4 py-2 w-60 text-white text-base  leading-normal">
                                           Charging
                                         </td>
                                       </tr> -->
                                       <tr class="border-t border-t-[#4ABBBD]/50">
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 h-[72px] px-4 py-2 w-[300px] text-white text-sm font-normal leading-normal">Battery Station</td>
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-180 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                                           <p class="text-white text-base">100% <span class="text-[var(--turqueza)] text-sm">/ 88 kWh</span></p>
                                         </td>
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                                           <div class="flex items-center gap-4">
                                             <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                                               <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 100%;"></div>
                                             </div>
                                             <p class="text-white text-base ">100% <span class="text-[var(--turqueza)] text-sm">/ 44 kWh</span></p>
                                           </div>
                                         </td>
                                         <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                                           <div class="flex items-center gap-4">
                                             <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                                               <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 100%;"></div>
                                             </div>
                                             <p class="text-white text-base ">100% <span class="text-[var(--turqueza)] text-sm">/ 44 kWh</span></p>
                                           </div>
                                         </td>
                                         <!-- <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 h-[72px] px-4 py-2 w-60 text-white text-base  leading-normal">
                                           Available
                                         </td> -->
                                      </tr>
                                      <!-- <tr class="border-t border-t-[#607afb]">
                                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 h-[72px] px-4 py-2 w-[400px] text-white text-base font-bold leading-normal">Total</td>
                                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                                          <div class="flex items-center gap-4">
                                            <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                                              <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 50%;"></div>
                                            </div>
                                            <p class="text-white text-base font-bold">50% <span class="text-[var(--turqueza)] text-sm">/ 74.7 kWh</span></p>
                                          </div>
                                        </td>
                                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                                          <div class="flex items-center gap-4">
                                            <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                                              <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 70%;"></div>
                                            </div>
                                            <p class="text-white text-base font-bold">70% <span class="text-[var(--turqueza)] text-sm">/ 132.3 kWh</span></p>
                                          </div>
                                        </td>
                                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 h-[72px] px-4 py-2 w-60 text-center text-sm font-normal leading-normal">-</td>
                                      </tr> -->
                                    </tbody>
                                  </table>
                                </div>
                                <style>
                                  @container(max-width:120px){.table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120{display: none;}}
                                  @container(max-width:240px){.table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240{display: none;}}
                                  @container(max-width:360px){.table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360{display: none;}}
                                  @container(max-width:480px){.table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-480{display: none;}}
                                  @container(max-width:600px){.table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600{display: none;}}
                                </style>
                               </div>
                             </div>
                         </div>
                          
                          <!-- Div hijo 3: Flex padre de dos hijos, dirección columna -->
                          <!-- <div class="flex flex-row gap-6 flex-1 items-center justify-around">
                            
                           
                          </div> -->
                        </div>
                      </div>
                    </div>

                  
                  </div>

                  <!-- Footer del modal -->
                  <!-- <div class="flex justify-end p-6 border-t border-[var(--turqueza)] border-opacity-50">
                    <button 
                      onclick="closeEnergyStatusModal()" 
                      class="bg-[var(--turqueza)] hover:bg-[#4c63d2] text-white py-2 px-6 rounded-lg transition-colors duration-200"
                    >
                      Close
                    </button>
                  </div> -->
                </div>
              </div>

              <!-----------------         Modal de Vehicle List INCIO      ------------- -->
             

              <!-----------------         Modal de Vehicle List FIN      ------------- -->



                    
                     
              </div> 
              <!--  -->
              <div id="vehicleListModal" class="modal-backdrop fixed inset-0 z-50 hidden flex items-center justify-center">
                <div class="modal-content bg-[var(--azul-oscuro)] border border-[#4ABBBD]/50 rounded-lg shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto relative">
                  <!-- Header del modal -->
                  <div class="flex items-center justify-around p-6 border-b border-[#4ABBBD]/50">
                    <!-- Flecha izquierda -->
                    <button 
                      onclick="previousVehicle()" 
                      class=" hover:bg-[#4ABBBD]/10 text-white p-2 rounded-lg transition-colors duration-200"
                      id="prevVehicleBtn"
                    >
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                        <path d="M168.49,199.51a12,12,0,0,1-17,0l-64-64a12,12,0,0,1,0-17l64-64a12,12,0,0,1,17,17L113,128l55.51,55.51A12,12,0,0,1,168.49,199.51Z"></path>
                      </svg>
                    </button>
                    
                    <!-- Título centrado -->
                    <h3 class="text-white text-xl font-semibold" id="vehicleModalTitle">Vehicle Fleet Status</h3>
                    
                    <!-- Flecha derecha -->
                    <button 
                      onclick="nextVehicle()" 
                      class="bg-[var(--turqueza)]/20 hover:bg-[#4ABBBD]/10 text-white p-2 rounded-lg transition-colors duration-200"
                      id="nextVehicleBtn"
                    >
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
                      </svg>
                    </button>
                  </div>
                  
                  <!-- Botón de cerrar flotante en la esquina superior derecha -->
                  <button 
                    onclick="closeVehicleListModal()" 
                    class="absolute top-4 right-4 text-[var(--turqueza)] hover:text-white transition-colors duration-200 z-10"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
                      <path d="M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"></path>
                    </svg>
                  </button>

                  <!-- Contenido del modal -->
                  <div class="p-6 pb-2 space-y-4">

                    <!-- Slider de vehículos individuales -->
                    <div class="space-y-1">
                      <!-- Contenido del slider -->
                      <div class="vehicle-slider-container h-full">
                        <!-- Slide 0: General -->
                        <div class="vehicle-slide hidden" id="vehicle-general">
                          <div class="w-full">
                            <!-- General Table -->
                            <div class="bg-[#181d35]  rounded-lg border border-[#4ABBBD]/50">
                              <div class="overflow-hidden rounded">
                                <table class="w-full">
                                  <thead>
                                    <tr class="bg-[var(--turqueza)]/20">
                                      <th class="px-4 py-3 text-left text-white text-sm font-medium">Vehicle</th>
                                      <th class="px-3 py-3 text-left text-white text-sm font-medium">Battery</th>
                                      <th class="px-4 py-3 text-left text-white text-sm font-medium">Status</th>
                                      <th class="px-4 py-3 text-left text-white text-sm font-medium">Location</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr class="border-t border-t-[#4ABBBD]/50">
                                      <td class="px-4 py-3 text-white text-sm slide-text-fade-in">Zetrabot 1</td>
                                      <td class="px-4 py-3 text-white text-sm slide-text-fade-in battery-value-change" id="zetrabot1-battery">65<span class="battery-decimal">.46</span>%<span class="battery-dots"></span></td>
                                      <td class="px-4 py-3 text-green-400 text-sm">
                                        <span class="attention-wrapper">
                                          <span class="attention-text-nested text-[#4ABBBD]">Working</span>
                                        </span>
                                      </td>
                                      <td class="px-4 py-3 text-white text-sm slide-text-fade-in">P 3</td>
                                    </tr>
                                    <!-- <tr class="border-t border-t-[#4ABBBD]/50">
                                      <td class="px-4 py-3 text-white text-sm slide-text-fade-in">Zetrabot 3</td>
                                      <td class="px-4 py-3 text-white text-sm slide-text-fade-in battery-value-change" id="zetrabot3-battery">80<span class="battery-decimal">.00</span>%</td>
                                      <td class="px-4 py-3 text-green-400 text-sm slide-text-fade-in">Available</td>
                                      <td class="px-4 py-3 text-white text-sm slide-text-fade-in">P 3</td>
                                    </tr> -->
                                    <tr class="border-t border-t-[#4ABBBD]/50">
                                      <td class="px-4 py-3 text-white text-sm slide-text-fade-in">Zetrabot 2</td>
                                      <td class="px-4 py-3 text-white text-sm slide-text-fade-in battery-value-change" id="zetrabot2-battery">22<span class="battery-decimal">.36</span>%<span class="battery-dots"></span></td>
                                      <td class="px-4 py-3 text-yellow-400 text-sm slide-text-fade-in">
                                        <span class="attention-wrapper">
                                          <span class="attention-text-nested text-[#4ABBBD]">Charging</span>
                                        </span>
                                      </td>
                                      <td class="px-4 py-3 text-white text-sm slide-text-fade-in">Warehouse</td>
                                    </tr>
                                    <tr class="border-t border-t-[#4ABBBD]/50">
                                      <td class="px-4 py-3 text-white text-sm slide-text-fade-in">Battery station</td>
                                      <td class="px-4 py-3 text-white text-sm slide-text-fade-in battery-value-change" id="battery-station">80<span class="battery-decimal">.00</span>%</td>
                                      <td class="px-4 py-3 text-white text-sm slide-text-fade-in">Available</td>
                                      <td class="px-4 py-3 text-white text-sm slide-text-fade-in">Warehouse</td>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                          </div>
                        </div>


                        <!-- Slide 1: Zetrabot 1 -->
                        <div class="vehicle-slide hidden" id="vehicle-001">
                          <!-- Header con icono del vehículo y gráfico circular -->
                          <div class="flex items-center justify-center mb-10">
                            <div class="relative">
                              <!-- Gráfico circular de carga -->
                              <svg class="w-32 h-32 transform -rotate-90" viewBox="0 0 36 36">
                                <!-- Fondo del círculo -->
                                <path
                                  d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                                  fill="none"
                                  stroke="#2f396a"
                                  stroke-width="2"
                                  stroke-linecap="round"
                                />
                                <!-- Círculo de progreso (65.46% de Zetrabot 1) -->
                                <path
                                  d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                                  fill="none"
                                  stroke="var(--turqueza)"
                                  stroke-width="2"
                                  stroke-linecap="round"
                                  stroke-dasharray="65.46, 100"
                                  class="progress-circle-animate"
                                />
                              </svg>
                              
                              <!-- Icono del vehículo centrado -->
                              <div class="absolute inset-0 flex items-center justify-center">
                                <div class="bg-[#181d35] rounded-full p-3 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg">
                                  <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#4ABBBD" viewBox="384 282 32 32">
                                    <g>
                                      <path d="m390.49085,289.18182l0,7.25c-1.34766,0.30469 -2.58203,0.88281 -3.625,1.71875l1.25,1.5625c1.19922,-0.96094 2.71484,-1.53125 4.375,-1.53125c3.87891,0 7,3.12109 7,7l4.5625,0c-0.34766,0.59375 -0.5625,1.26563 -0.5625,2c0,2.19922 1.80078,4 4,4c2.19922,0 4,-1.80078 4,-4c0,-1.02734 -0.41797,-1.94531 -1.0625,-2.65625l2,-4.96875l0.0625,-0.1875l0,-2.1875l-3.78888,-0.02626l-3.42733,0.02626l-3.09629,0l-2.75,-7.34375l-0.25,-0.65625l-8.6875,0zm2,2l5.3125,0l2.75,7.34375l0.25,0.65625l9.59375,0l-1.59375,4l-7.5625,0c-0.91797,-3.99609 -4.48047,-7 -8.75,-7l0,-5zm0,8c-3.30078,0 -6,2.69922 -6,6c0,3.30078 2.69922,6 6,6c3.30078,0 6,-2.69922 6,-6c0,-3.30078 -2.69922,-6 -6,-6zm0,2c2.22266,0 4,1.77734 4,4c0,2.22266 -1.77734,4 -4,4c-2.22266,0 -4,-1.77734 -4,-4c0,-2.22266 1.77734,-4 4,-4zm0,2c-1.10547,0 -2,0.89453 -2,2c0,1.10547 0.89453,2 2,2c1.10547,0 2,-0.89453 2,-2c0,-1.10547 -0.89453,-2 -2,-2zm15,2c1.11719,0 2,0.88281 2,2c0,1.11719 -0.88281,2 -2,2c-1.11719,0 -2,-0.88281 -2,-2c0,-1.11719 0.88281,-2 2,-2z" />
                                      <path d="m407.27288,289.85509l2.95442,-5.12783l0,3.50852l2.95444,0l-2.95444,5.12783l0.00012,-3.50852l-2.95454,0z"/>
                                    </g>
                                  </svg>
                                </div>
                              </div>
                              
                              <!-- Porcentaje de carga superpuesto -->
                              <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2">
                                <span class="text-white text-lg font-bold">65.46%</span>
                              </div>
                            </div>
                          </div>
                          
                          <div class="grid grid-cols-1 md:grid-cols-4 gap-4 w-full my-4">
                          

                            <!-- Fixed Pack -->
                            <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                              <p class="text-[white] text-sm">Fixed Pack</p>
                              <p style="color: var(--turqueza) ; font-size: 14px; "> f-866-zt</p>
                              <p class="text-white text-lg font-bold">80%</p>
                              <div class="w-full bg-[#2f396a] rounded-full h-2 mb-2">
                                <div class="bg-[var(--turqueza)] h-2 rounded-full progress-bar progress-bar-animate" style="width: 80%"></div>
                              </div>
                              <p class="text-[white] text-sm">35.5 kWh</p>
                            </div>

                              <!-- Swappable Pack -->
                              <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                                <p class="text-[white] text-sm">Swappable Pack</p>
                                <p style="color: var(--turqueza) ; font-size: 14px; "> s-866-zt</p>
                                <p class="text-white text-lg font-bold">50%</p>
                                <div class="w-full bg-[#2f396a] rounded-full h-2 mb-2">
                                  <div class="bg-[var(--turqueza)] h-2 rounded-full progress-bar progress-bar-animate" style="width: 50%"></div>
                                </div>
                                <p class="text-[white] text-sm">25.5 kWh</p>
                              </div>

                            <!-- Availability -->
                            <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                              <p class="text-white text-sm">Availability</p>
                              <p class="text-white text-lg font-bold">59 kWh</p>
                              <p class="text-white text-sm">Operational capacity</p>
                            </div>

                            <!-- Minimum Battery Threshold -->
                            <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                              <p class="text-white text-sm">Battery Min</p>
                              <p class="text-white text-lg font-bold" id="threshold-value">20%</p>
                              <div class="w-full bg-[var(--turqueza)]/20 rounded-full h-2 mb-2 relative threshold-slider">
                                <div class="bg-[var(--turqueza)] h-2 rounded-full progress-bar progress-bar-animate" style="width: 20%"></div>
                                <!-- Círculo arrastrable -->
                                <div class="absolute top-1/2 transform -translate-y-1/2 w-5 h-5 bg-[var(--turqueza)] rounded-full cursor-grab shadow-lg threshold-handle" 
                                     style="left: 20%; margin-left: -10px;" 
                                     id="threshold-handle">
                                  <!-- Punto central para mejor agarre -->
                                  <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-2 h-2 bg-white rounded-full opacity-80"></div>
                                </div>
                              </div>
                              <p class="text-white text-sm">Critical level warning</p>
                            </div>
                          </div>
                        </div>

                        <!-- Slide 2: Zetrabot 2 -->
                        <div class="vehicle-slide hidden" id="vehicle-002">
                          <!-- Header con icono del vehículo y gráfico circular -->
                          <div class="flex items-center justify-center mb-10">
                            <div class="relative">
                              <!-- Gráfico circular de carga -->
                              <svg class="w-32 h-32 transform -rotate-90" viewBox="0 0 36 36">
                                <!-- Fondo del círculo -->
                                <path
                                  d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                                  fill="none"
                                  stroke="#2f396a"
                                  stroke-width="2"
                                  stroke-linecap="round"
                                />
                                <!-- Círculo de progreso (22% de Zetrabot 2) -->
                                <path
                                  d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                                  fill="none"
                                  stroke="var(--turqueza)"
                                  stroke-width="2"
                                  stroke-linecap="round"
                                  stroke-dasharray="22, 100"
                                  class="progress-circle-animate-22"
                                />
                              </svg>
                              
                              <!-- Icono del vehículo centrado -->
                              <div class="absolute inset-0 flex items-center justify-center">
                                <div class="bg-[#181d35] rounded-full p-3 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg">
                                  <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#4ABBBD" viewBox="384 282 32 32">
                                    <g>
                                      <path d="m390.49085,289.18182l0,7.25c-1.34766,0.30469 -2.58203,0.88281 -3.625,1.71875l1.25,1.5625c1.19922,-0.96094 2.71484,-1.53125 4.375,-1.53125c3.87891,0 7,3.12109 7,7l4.5625,0c-0.34766,0.59375 -0.5625,1.26563 -0.5625,2c0,2.19922 1.80078,4 4,4c2.19922,0 4,-1.80078 4,-4c0,-1.02734 -0.41797,-1.94531 -1.0625,-2.65625l2,-4.96875l0.0625,-0.1875l0,-2.1875l-3.78888,-0.02626l-3.42733,0.02626l-3.09629,0l-2.75,-7.34375l-0.25,-0.65625l-8.6875,0zm2,2l5.3125,0l2.75,7.34375l0.25,0.65625l9.59375,0l-1.59375,4l-7.5625,0c-0.91797,-3.99609 -4.48047,-7 -8.75,-7l0,-5zm0,8c-3.30078,0 -6,2.69922 -6,6c0,3.30078 2.69922,6 6,6c3.30078,0 6,-2.69922 6,-6c0,-3.30078 -2.69922,-6 -6,-6zm0,2c2.22266,0 4,1.77734 4,4c0,2.22266 -1.77734,4 -4,4c-2.22266,0 -4,-1.77734 -4,-4c0,-2.22266 1.77734,-4 4,-4zm0,2c-1.10547,0 -2,0.89453 -2,2c0,1.10547 0.89453,2 2,2c1.10547,0 2,-0.89453 2,-2c0,-1.10547 -0.89453,-2 -2,-2zm15,2c1.11719,0 2,0.88281 2,2c0,1.11719 -0.88281,2 -2,2c-1.11719,0 -2,-0.88281 -2,-2c0,-1.11719 0.88281,-2 2,-2z" />
                                      <path d="m407.27288,289.85509l2.95442,-5.12783l0,3.50852l2.95444,0l-2.95444,5.12783l0.00012,-3.50852l-2.95454,0z"/>
                                    </g>
                                  </svg>
                                </div>
                              </div>
                              
                              <!-- Porcentaje de carga superpuesto -->
                              <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2">
                                <span class="text-white text-lg font-bold">22%</span>
                              </div>
                            </div>
                          </div>
                          
                          <div class="grid grid-cols-1 md:grid-cols-4 gap-4 w-full my-4">
                            <!-- Swappable Pack -->
                            <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                              <p class="text-[var(--turqueza)] text-sm">Swappable Pack</p>
                              <p class="text-white text-lg font-bold">12%</p>
                              <div class="w-full bg-[#2f396a] rounded-full h-2 mb-2">
                                <div class="bg-[var(--turqueza)] h-2 rounded-full progress-bar progress-bar-animate" style="width: 12%"></div>
                              </div>
                              <p class="text-[var(--turqueza)] text-sm">9.7 kWh available</p>
                            </div>

                            <!-- Fixed Pack -->
                            <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                              <p class="text-[var(--turqueza)] text-sm">Fixed Pack</p>
                              <p class="text-white text-lg font-bold">10%</p>
                              <div class="w-full bg-[#2f396a] rounded-full h-2 mb-2">
                                <div class="bg-[var(--turqueza)] h-2 rounded-full progress-bar progress-bar-animate" style="width: 10%"></div>
                              </div>
                              <p class="text-[var(--turqueza)] text-sm">8.6 kWh available</p>
                            </div>

                            <!-- Availability -->
                            <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                              <p class="text-[var(--turqueza)] text-sm">Availability</p>
                              <p class="text-white text-lg font-bold">17.1 kWh</p>
                              <p class="text-[var(--turqueza)] text-sm">Operational capacity</p>
                            </div>

                            <!-- Minimum Battery Threshold -->
                            <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                              <p class="text-[var(--turqueza)] text-sm">Battery Min</p>
                              <p class="text-white text-lg font-bold" id="threshold-value-2">20%</p>
                              <div class="w-full bg-[var(--turqueza)]/20 rounded-full h-2 mb-2 relative threshold-slider">
                                <div class="bg-[var(--turqueza)] h-2 rounded-full progress-bar progress-bar-animate" style="width: 20%"></div>
                                <!-- Círculo arrastrable -->
                                <div class="absolute top-1/2 transform -translate-y-1/2 w-5 h-5 bg-[var(--turqueza)] rounded-full cursor-grab shadow-lg threshold-handle" 
                                     style="left: 20%; margin-left: -10px;" 
                                     id="threshold-handle-2">
                                  <!-- Punto central para mejor agarre -->
                                  <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-2 h-2 bg-white rounded-full opacity-80"></div>
                                </div>
                              </div>
                              <p class="text-[var(--turqueza)] text-sm">Critical level warning</p>
                            </div>
                          </div>
                        </div>

                        <!-- Slide 3: Zetrabot 3 -->
                        <!-- <div class="vehicle-slide hidden" id="vehicle-003">
                          <div class="flex items-center justify-center mb-10">
                            <div class="relative">
                              <svg class="w-32 h-32 transform -rotate-90" viewBox="0 0 36 36">
                                <path
                                  d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                                  fill="none"
                                  stroke="#2f396a"
                                  stroke-width="2"
                                  stroke-linecap="round"
                                />
                                <path
                                  d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                                  fill="none"
                                  stroke="var(--turqueza)"
                                  stroke-width="2"
                                  stroke-linecap="round"
                                  stroke-dasharray="80, 100"
                                  class="progress-circle-animate-80"
                                />
                              </svg>
                              
                              <div class="absolute inset-0 flex items-center justify-center">
                                <div class="bg-[#181d35] rounded-full p-3 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg">
                                  <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#4ABBBD"  viewBox="384 282 32 32">
                                    <g>
                                      <path d="m390.49085,289.18182l0,7.25c-1.34766,0.30469 -2.58203,0.88281 -3.625,1.71875l1.25,1.5625c1.19922,-0.96094 2.71484,-1.53125 4.375,-1.53125c3.87891,0 7,3.12109 7,7l4.5625,0c-0.34766,0.59375 -0.5625,1.26563 -0.5625,2c0,2.19922 1.80078,4 4,4c2.19922,0 4,-1.80078 4,-4c0,-1.02734 -0.41797,-1.94531 -1.0625,-2.65625l2,-4.96875l0.0625,-0.1875l0,-2.1875l-3.78888,-0.02626l-3.42733,0.02626l-3.09629,0l-2.75,-7.34375l-0.25,-0.65625l-8.6875,0zm2,2l5.3125,0l2.75,7.34375l0.25,0.65625l9.59375,0l-1.59375,4l-7.5625,0c-0.91797,-3.99609 -4.48047,-7 -8.75,-7l0,-5zm0,8c-3.30078,0 -6,2.69922 -6,6c0,3.30078 2.69922,6 6,6c3.30078,0 6,-2.69922 6,-6c0,-3.30078 -2.69922,-6 -6,-6zm0,2c2.22266,0 4,1.77734 4,4c0,2.22266 -1.77734,4 -4,4c-2.22266,0 -4,-1.77734 -4,-4c0,-2.22266 1.77734,-4 4,-4zm0,2c-1.10547,0 -2,0.89453 -2,2c0,1.10547 0.89453,2 2,2c1.10547,0 2,-0.89453 2,-2c0,-1.10547 -0.89453,-2 -2,-2zm15,2c1.11719,0 2,0.88281 2,2c0,1.11719 -0.88281,2 -2,2c-1.11719,0 -2,-0.88281 -2,-2c0,-1.11719 0.88281,-2 2,-2z" />
                                      <path d="m407.27288,289.85509l2.95442,-5.12783l0,3.50852l2.95444,0l-2.95444,5.12783l0.00012,-3.50852l-2.95454,0z"/>
                                    </g>
                                  </svg>
                                </div>
                              </div>
                              
                              <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2">
                                <span class="text-white text-lg font-bold">80%</span>
                              </div>
                            </div>
                          </div>
                          
                          <div class="grid grid-cols-1 md:grid-cols-4 gap-4 w-full my-4">
                            <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                              <p class="text-[var(--turqueza)] text-sm">Swappable Pack</p>
                              <p class="text-white text-lg font-bold">90%</p>
                              <div class="w-full bg-[#2f396a] rounded-full h-2 mb-2">
                                <div class="bg-[var(--turqueza)] h-2 rounded-full progress-bar progress-bar-animate" style="width: 90%"></div>
                              </div>
                              <p class="text-[var(--turqueza)] text-sm">42.5 kWh available</p>
                            </div>

                            <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                              <p class="text-[var(--turqueza)] text-sm">Fixed Pack</p>
                              <p class="text-white text-lg font-bold">100%</p>
                              <div class="w-full bg-[#2f396a] rounded-full h-2 mb-2">
                                <div class="bg-[var(--turqueza)] h-2 rounded-full progress-bar progress-bar-animate" style="width: 44%"></div>
                              </div>
                              <p class="text-[var(--turqueza)] text-sm">44 kWh available</p>
                            </div>

                            <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                              <p class="text-[var(--turqueza)] text-sm">Availability</p>
                              <p class="text-white text-lg font-bold">86.5 kWh</p>
                              <p class="text-[var(--turqueza)] text-sm">Operational capacity</p>
                            </div>

                            <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                              <p class="text-[var(--turqueza)] text-sm">Battery Min</p>
                              <p class="text-white text-lg font-bold" id="threshold-value-3">20%</p>
                              <div class="w-full bg-[var(--turqueza)]/20 rounded-full h-2 mb-2 relative threshold-slider">
                                <div class="bg-[var(--turqueza)] h-2 rounded-full progress-bar progress-bar-animate" style="width: 20%"></div>
                                <div class="absolute top-1/2 transform -translate-y-1/2 w-5 h-5 bg-[var(--turqueza)] rounded-full cursor-grab shadow-lg threshold-handle" 
                                     style="left: 20%; margin-left: -10px;" 
                                     id="threshold-handle-3">
                                  <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-2 h-2 bg-white rounded-full opacity-80"></div>
                                </div>
                              </div>
                              <p class="text-[var(--turqueza)] text-sm">Critical level warning</p>
                            </div>
                          </div>
                        </div> -->

                        <!-- Slide 4: Trailer -->
                        <div class="vehicle-slide hidden" id="vehicle-003">
                          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 w-full">
                            <!-- Swappable Pack -->
                            <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                             <p class="text-[var(--turqueza)] text-sm">Informacion de interes para BS?</p>
                                <!--<p class="text-white text-2xl font-bold">85%</p>
                              <div class="w-full bg-[var(--turqueza)]/20 rounded-full h-3 mb-2">
                                <div class="bg-[var(--turqueza)] h-3 rounded-full progress-bar progress-bar-animate" style="width: 85%"></div>
                              </div>
                              <p class="text-[var(--turqueza)] text-sm">38.7 kWh available</p> -->
                            </div>

                            <!-- Fixed Pack -->
                            <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                             <p class="text-[var(--turqueza)] text-sm">Informacion de interes para BS?</p>
                               <!-- <p class="text-white text-2xl font-bold">95%</p>
                              <div class="w-full bg-[var(--turqueza)]/20 rounded-full h-3 mb-2">
                                <div class="bg-[var(--turqueza)] h-3 rounded-full progress-bar progress-bar-animate" style="width: 95%"></div>
                              </div>
                              <p class="text-white text-sm">41.8 kWh available</p> -->
                            </div>

                            <!-- Availability -->
                            <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                             <p class="text-[var(--turqueza)] text-sm">Informacion de interes para BS?</p>
                                <!--<p class="text-white text-2xl font-bold">80.5 kWh</p>
                              <p class="text-[var(--turqueza)] text-sm">Total operational capacity</p> -->
                            </div>

                            <!-- Minimum Battery Threshold -->
                            <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                               <p class="text-[var(--turqueza)] text-sm">Informacion de interes para BS?</p>
                             <!-- <p class="text-white text-2xl font-bold">15%</p>
                              <p class="text-[var(--turqueza)] text-sm">Optimal performance level</p> -->
                            </div>
                          </div>
                        </div>

                      </div>
                    </div>
                    
                    <!-- Indicadores de slide -->
                <div class="slide-indicators">
                 <div class="slide-indicator active" onclick="goToSlide(0)" style="background-color: var(--turqueza)"></div>
                  <div class="slide-indicator" onclick="goToSlide(1)" style="background-color: var(--turqueza)"></div>
                  <div class="slide-indicator" onclick="goToSlide(2)" style="background-color: var(--turqueza)"></div>
                  <div class="slide-indicator" onclick="goToSlide(3)" style="background-color: var(--turqueza)"></div>
                  </div>
                  </div>
                </div>
              </div>

              <!--  -->

            </div>

            
          </div>
        </div>
       </div>
          
          <!-- ================================================================== -->
          <!-- =                        DASHBOARD view                            = -->
          <!-- =                Main monitoring and status view                   = -->
          <!-- ================================================================== -->
        <div id="dashboard-view" class="view">
              <div class="flex flex-wrap justify-between gap-3 p-4"><p class="text-white font-bold tracking-light text-[32px]  leading-tight min-w-72">Real-Time Energy Status</p></div>
              <!-- <h2 class="text-white text-[22px] leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">Energy Overview</h2> -->
              <div class="flex flex-wrap gap-4 p-4">
                <!-- Columna 1: Datos en bruto -->
                <div class="flex flex-col gap-4 flex-1 min-w-[280px]">
                    <div class="flex flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 bg-[var(--azul-oscuro)] h-full justify-center shadow-lg shadow-[var(--turqueza)]/50/50 transition-shadow duration-300 hover:shadow-xl">
                        <p class="text-white text-base font-medium leading-normal">Total Installed Capacity</p>
                        <p class="text-white tracking-light text-2xl font-bold leading-tight">132 kWh</p>
                    </div>
                    <div class="flex flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 bg-[var(--azul-oscuro)] h-full justify-center shadow-lg shadow-[var(--turqueza)]/50/50 transition-shadow duration-300 hover:shadow-xl">
                        <p class="text-white text-base font-medium leading-normal">Operational Capacity (20-80%)</p>
                        <p class="text-white tracking-light text-2xl font-bold leading-tight">81.6 kWh</p>
                    </div>
                </div>

                <!-- Columna 2: Visualización del Medidor -->
                <div class="flex flex-col items-center justify-center p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 rounded-lg bg-[var(--azul-oscuro)] flex-1 min-w-[280px] shadow-lg shadow-[]/50 transition-shadow duration-300 hover:shadow-xl">
                    <h3 class="text-white text-base font-medium leading-normal mb-2">Current System Energy</h3>
                    <div class="relative w-48 h-24">
                        <svg class="w-full h-full" viewBox="0 0 100 50">
                            <path d="M 10,45 A 40,40 0 0,1 90,45" stroke="#2f396a" stroke-width="10" fill="none" stroke-linecap="round"></path>
                            <path d="M 10,45 A 40,40 0 0,1 90,45" stroke="var(--turqueza)" stroke-width="10" fill="none" stroke-linecap="round" stroke-dasharray="125.66" stroke-dashoffset="28.56" style="transition: stroke-dashoffset 0.5s ease;"></path>
                        </svg>
                        <div class="absolute inset-0 flex flex-col items-center justify-end pb-1" style="pointer-events: none;">
                            <p class="text-white tracking-light text-3xl font-bold leading-tight">77%</p>
                        </div>
                    </div>
                    <div class="text-center mt-2">
                        <p class="text-white text-lg font-medium">102 kWh <span class="text-[var(--turqueza)] text-base">/ 132 kWh</span></p>
                    </div>
                </div>
              </div>
              <h2 class="text-white text-[22px] leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">Fleet Status Overview</h2>
              <div class="px-4 py-3 @container">
                <div class="flex overflow-hidden rounded border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 bg-[var(--azul-oscuro)] shadow-lg shadow-[var(--turqueza)]/50/50 transition-shadow duration-300 hover:shadow-xl">
                  <table class="flex-1">
                    <thead>
                      <tr class="bg-[#181d35]">
                        <th class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 px-4 py-3 text-left text-white w-[400px] text-xs font-medium leading-normal">Vehicle</th>
                        <th class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 px-4 py-3 text-left text-white w-[400px] text-xs font-medium leading-normal">Fixed Pack</th>
                        <th class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 px-4 py-3 text-left text-white w-[400px] text-xs font-medium leading-normal">Swappable Pack</th>
                        <th class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 px-4 py-3 text-left text-white w-60 text-xs font-medium leading-normal">Status</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="border-t border-t-[#4ABBBD]/50">
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 h-[72px] px-4 py-2 w-[400px] text-white text-sm font-normal leading-normal">Zetrabot-001</td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-4">
                            <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                              <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 85%;"></div>
                            </div>
                            <p class="text-white text-base ">85% <span class="text-[var(--turqueza)] text-sm">/ 35.5 kWh</span></p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-4">
                            <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                              <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 60%;"></div>
                            </div>
                            <p class="text-white text-base ">60% <span class="text-[var(--turqueza)] text-sm">/ 27.3 kWh</span></p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 h-[72px] px-4 py-2 w-60 text-white text-base  leading-normal">
                          On duty
                        </td>
                      </tr>
                      <tr class="border-t border-t-[#4ABBBD]/50">
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 h-[72px] px-4 py-2 w-[400px] text-white text-sm font-normal leading-normal">Zetrabot-002</td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-4">
                            <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                              <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 45%;"></div>
                            </div>
                            <p class="text-white text-base ">45% <span class="text-[var(--turqueza)] text-sm">/ 22.4 kWh</span></p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-4">
                            <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                              <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 90%;"></div>
                            </div>
                            <p class="text-white text-base ">90% <span class="text-[var(--turqueza)] text-sm">/ 36.5 kWh</span></p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 h-[72px] px-4 py-2 w-60 text-white text-base  leading-normal">
                          Available
                        </td>
                      </tr>
                      <tr class="border-t border-t-[#4ABBBD]/50">
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 h-[72px] px-4 py-2 w-[400px] text-white text-sm font-normal leading-normal">Zetrabot-003</td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-4">
                            <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                              <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 20%;"></div>
                            </div>
                            <p class="text-white text-base ">20% <span class="text-[var(--turqueza)] text-sm">/ 16.8 kWh</span></p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-4">
                            <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                              <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 30%;"></div>
                            </div>
                            <p class="text-white text-base ">30% <span class="text-[var(--turqueza)] text-sm">/ 24.5 kWh</span></p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 h-[72px] px-4 py-2 w-60 text-white text-base  leading-normal">
                          Charging
                        </td>
                      </tr>
                      <tr class="border-t border-t-[#4ABBBD]/50">
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 h-[72px] px-4 py-2 w-[400px] text-white text-sm font-normal leading-normal">Battery Station</td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-4">
                            <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                              <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 100%;"></div>
                            </div>
                            <p class="text-white text-base ">100% <span class="text-[var(--turqueza)] text-sm">/ 44 kWh</span></p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-4">
                            <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                              <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 100%;"></div>
                            </div>
                            <p class="text-white text-base ">100% <span class="text-[var(--turqueza)] text-sm">/ 44 kWh</span></p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 h-[72px] px-4 py-2 w-60 text-white text-base  leading-normal">
                          Available
                        </td>
                      </tr>
                      <tr class="border-t border-t-[#607afb]">
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 h-[72px] px-4 py-2 w-[400px] text-white text-base font-bold leading-normal">Total</td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-4">
                            <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                              <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 50%;"></div>
                            </div>
                            <p class="text-white text-base font-bold">50% <span class="text-[var(--turqueza)] text-sm">/ 74.7 kWh</span></p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-4">
                            <div class="w-24 overflow-hidden rounded-sm bg-[var(--turqueza)]/20">
                              <div class="h-1 rounded-sm bg-[var(--turqueza)]" style="width: 70%;"></div>
                            </div>
                            <p class="text-white text-base font-bold">70% <span class="text-[var(--turqueza)] text-sm">/ 132.3 kWh</span></p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 h-[72px] px-4 py-2 w-60 text-center text-sm font-normal leading-normal">-</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <style>
                  @container(max-width:120px){.table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120{display: none;}}
                  @container(max-width:240px){.table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240{display: none;}}
                  @container(max-width:360px){.table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360{display: none;}}
                  @container(max-width:480px){.table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-480{display: none;}}
                  @container(max-width:600px){.table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600{display: none;}}
                </style>
              </div>
              <h2 class="text-white text-[22px] leading-tight tracking-[-0.015em] px-4 pb-3 pt-5"> Individual Vehicle Status </h2>
              <div class="flex flex-col gap-4 px-4 py-6">
                <div class="flex w-full flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg shadow-[var(--turqueza)]/50/50 transition-shadow duration-300 hover:shadow-xl">
                  <div class="flex items-center gap-3">
                    <div class="text-white">
                      <svg xmlns="http://www.w3.org/2000/svg" width="28px" height="28px" fill="currentColor" viewBox="384 282 32 32">
                        <g>
                          <path d="m390.49085,289.18182l0,7.25c-1.34766,0.30469 -2.58203,0.88281 -3.625,1.71875l1.25,1.5625c1.19922,-0.96094 2.71484,-1.53125 4.375,-1.53125c3.87891,0 7,3.12109 7,7l4.5625,0c-0.34766,0.59375 -0.5625,1.26563 -0.5625,2c0,2.19922 1.80078,4 4,4c2.19922,0 4,-1.80078 4,-4c0,-1.02734 -0.41797,-1.94531 -1.0625,-2.65625l2,-4.96875l0.0625,-0.1875l0,-2.1875l-3.78888,-0.02626l-3.42733,0.02626l-3.09629,0l-2.75,-7.34375l-0.25,-0.65625l-8.6875,0zm2,2l5.3125,0l2.75,7.34375l0.25,0.65625l9.59375,0l-1.59375,4l-7.5625,0c-0.91797,-3.99609 -4.48047,-7 -8.75,-7l0,-5zm0,8c-3.30078,0 -6,2.69922 -6,6c0,3.30078 2.69922,6 6,6c3.30078,0 6,-2.69922 6,-6c0,-3.30078 -2.69922,-6 -6,-6zm0,2c2.22266,0 4,1.77734 4,4c0,2.22266 -1.77734,4 -4,4c-2.22266,0 -4,-1.77734 -4,-4c0,-2.22266 1.77734,-4 4,-4zm0,2c-1.10547,0 -2,0.89453 -2,2c0,1.10547 0.89453,2 2,2c1.10547,0 2,-0.89453 2,-2c0,-1.10547 -0.89453,-2 -2,-2zm15,2c1.11719,0 2,0.88281 2,2c0,1.11719 -0.88281,2 -2,2c-1.11719,0 -2,-0.88281 -2,-2c0,-1.11719 0.88281,-2 2,-2z" />
                          <path d="m407.27288,289.85509l2.95442,-5.12783l0,3.50852l2.95444,0l-2.95444,5.12783l0.00012,-3.50852l-2.95454,0z"/>
                        </g>
                      </svg>
                    </div>
                    <p class="text-white text-base font-medium leading-normal">Zetrabot 003</p>
                  </div>
                  <div class="grid min-h-[120px] gap-x-4 gap-y-6 grid-cols-[auto_1fr] items-center py-3">
                    <p class="text-[var(--turqueza)] text-[13px] font-bold leading-normal tracking-[0.015em]">Swappable pack </p>
                    <div class="battery-bar threshold-enabled" data-vehicle="zetrabot003">
                      <div class="threshold-line" style="width: 20%;"></div>
                      <div class="progress-bar" style="width: 100%;"></div>
                      <span class="text-white ml-2">100%</span>
                    </div>
                    <p class="text-[var(--turqueza)] text-[13px] font-bold leading-normal tracking-[0.015em]">Fixed pack </p>
                    <div class="battery-bar threshold-enabled" data-vehicle="zetrabot003">
                      <div class="threshold-line" style="width: 20%;"></div>
                      <div class="progress-bar" style="width: 80%;"></div>
                      <span class="text-white ml-2">80%</span>
                    </div>
                    <p class="text-[var(--turqueza)] text-[13px] font-bold leading-normal tracking-[0.015em]">Availability</p>
                    <div class="battery-bar" data-vehicle="zetrabot003">
                      <div class="progress-bar" style="width: 80%;"></div>
                      <span class="text-white ml-2">39.6 kWh</span>
                    </div>
                  </div>
                  <!-- Control de umbral mínimo -->
                  <div class="flex items-center gap-4 mt-4">
                    <p class="text-[var(--turqueza)] text-sm font-medium">Minimum Battery Threshold:</p>
                    <div class="flex-1 max-w-xs">
                      <input 
                        type="range" 
                        id="minThreshold_zetrabot003" 
                        min="0" 
                        max="100" 
                        value="20" 
                        class="w-full h-1 rounded-lg appearance-none cursor-pointer bg-[#21284a]"
                        oninput="updateThreshold('zetrabot003', this.value)"
                      >
                    </div>
                    <span id="thresholdValue_zetrabot003" class="text-white text-sm min-w-[3ch]">20%</span>
                  </div>
                </div>
                <div class="flex w-full flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg shadow-[var(--turqueza)]/50/50 transition-shadow duration-300 hover:shadow-xl">
                  <div class="flex items-center gap-3">
                    <div class="text-white">
                      <svg xmlns="http://www.w3.org/2000/svg" width="28px" height="28px" fill="currentColor" viewBox="384 282 32 32">
                        <g>
                          <path d="m390.49085,289.18182l0,7.25c-1.34766,0.30469 -2.58203,0.88281 -3.625,1.71875l1.25,1.5625c1.19922,-0.96094 2.71484,-1.53125 4.375,-1.53125c3.87891,0 7,3.12109 7,7l4.5625,0c-0.34766,0.59375 -0.5625,1.26563 -0.5625,2c0,2.19922 1.80078,4 4,4c2.19922,0 4,-1.80078 4,-4c0,-1.02734 -0.41797,-1.94531 -1.0625,-2.65625l2,-4.96875l0.0625,-0.1875l0,-2.1875l-3.78888,-0.02626l-3.42733,0.02626l-3.09629,0l-2.75,-7.34375l-0.25,-0.65625l-8.6875,0zm2,2l5.3125,0l2.75,7.34375l0.25,0.65625l9.59375,0l-1.59375,4l-7.5625,0c-0.91797,-3.99609 -4.48047,-7 -8.75,-7l0,-5zm0,8c-3.30078,0 -6,2.69922 -6,6c0,3.30078 2.69922,6 6,6c3.30078,0 6,-2.69922 6,-6c0,-3.30078 -2.69922,-6 -6,-6zm0,2c2.22266,0 4,1.77734 4,4c0,2.22266 -1.77734,4 -4,4c-2.22266,0 -4,-1.77734 -4,-4c0,-2.22266 1.77734,-4 4,-4zm0,2c-1.10547,0 -2,0.89453 -2,2c0,1.10547 0.89453,2 2,2c1.10547,0 2,-0.89453 2,-2c0,-1.10547 -0.89453,-2 -2,-2zm15,2c1.11719,0 2,0.88281 2,2c0,1.11719 -0.88281,2 -2,2c-1.11719,0 -2,-0.88281 -2,-2c0,-1.11719 0.88281,-2 2,-2z"/>
                          <path d="m407.27288,289.85509l2.95442,-5.12783l0,3.50852l2.95444,0l-2.95444,5.12783l0.00012,-3.50852l-2.95454,0z"/>
                        </g>
                      </svg>
                    </div>
                    <p class="text-white text-base font-medium leading-normal">Zetrabot 002</p>
                  </div>
                  <div class="grid min-h-[120px] gap-x-4 gap-y-6 grid-cols-[auto_1fr] items-center py-3">
                    <p class="text-[var(--turqueza)] text-[13px] font-bold leading-normal tracking-[0.015em]">Swappable pack </p>
                    <div class="battery-bar threshold-enabled" data-vehicle="zetrabot002">
                      <div class="threshold-line" style="width: 20%;"></div>
                      <div class="progress-bar" style="width: 100%;"></div>
                      <span class="text-white ml-2">100%</span>
                    </div>
                    <p class="text-[var(--turqueza)] text-[13px] font-bold leading-normal tracking-[0.015em]">Fixed pack </p>
                    <div class="battery-bar threshold-enabled" data-vehicle="zetrabot002">
                      <div class="threshold-line" style="width: 20%;"></div>
                      <div class="progress-bar" style="width: 80%;"></div>
                      <span class="text-white ml-2">80%</span>
                    </div>
                    <p class="text-[var(--turqueza)] text-[13px] font-bold leading-normal tracking-[0.015em]">Availability</p>
                    <div class="battery-bar" data-vehicle="zetrabot002">
                      <div class="progress-bar" style="width: 80%;"></div>
                      <span class="text-white ml-2">39.6 kWh</span>
                    </div>
                  </div>
                  <!-- Control de umbral mínimo -->
                  <div class="flex items-center gap-4 mt-4">
                    <p class="text-[var(--turqueza)] text-sm font-medium">Minimum Battery Threshold:</p>
                    <div class="flex-1 max-w-xs">
                      <input 
                        type="range" 
                        id="minThreshold_zetrabot002" 
                        min="0" 
                        max="100" 
                        value="20" 
                        class="w-full h-2 rounded-lg appearance-none cursor-pointer bg-[#21284a]"
                        oninput="updateThreshold('zetrabot002', this.value)"
                      >
                    </div>
                    <span id="thresholdValue_zetrabot002" class="text-white text-sm min-w-[3ch]">20%</span>
                  </div>
                </div>
                <div class="flex w-full flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg shadow-[var(--turqueza)]/50/50 transition-shadow duration-300 hover:shadow-xl">
                  <div class="flex items-center gap-3">
                    <div class="text-white">
                      <svg xmlns="http://www.w3.org/2000/svg" width="28px" height="28px" fill="currentColor" viewBox="384 282 32 32">
                        <g>
                          <path d="m390.49085,289.18182l0,7.25c-1.34766,0.30469 -2.58203,0.88281 -3.625,1.71875l1.25,1.5625c1.19922,-0.96094 2.71484,-1.53125 4.375,-1.53125c3.87891,0 7,3.12109 7,7l4.5625,0c-0.34766,0.59375 -0.5625,1.26563 -0.5625,2c0,2.19922 1.80078,4 4,4c2.19922,0 4,-1.80078 4,-4c0,-1.02734 -0.41797,-1.94531 -1.0625,-2.65625l2,-4.96875l0.0625,-0.1875l0,-2.1875l-3.78888,-0.02626l-3.42733,0.02626l-3.09629,0l-2.75,-7.34375l-0.25,-0.65625l-8.6875,0zm2,2l5.3125,0l2.75,7.34375l0.25,0.65625l9.59375,0l-1.59375,4l-7.5625,0c-0.91797,-3.99609 -4.48047,-7 -8.75,-7l0,-5zm0,8c-3.30078,0 -6,2.69922 -6,6c0,3.30078 2.69922,6 6,6c3.30078,0 6,-2.69922 6,-6c0,-3.30078 -2.69922,-6 -6,-6zm0,2c2.22266,0 4,1.77734 4,4c0,2.22266 -1.77734,4 -4,4c-2.22266,0 -4,-1.77734 -4,-4c0,-2.22266 1.77734,-4 4,-4zm0,2c-1.10547,0 -2,0.89453 -2,2c0,1.10547 0.89453,2 2,2c1.10547,0 2,-0.89453 2,-2c0,-1.10547 -0.89453,-2 -2,-2zm15,2c1.11719,0 2,0.88281 2,2c0,1.11719 -0.88281,2 -2,2c-1.11719,0 -2,-0.88281 -2,-2c0,-1.11719 0.88281,-2 2,-2z"/>
                          <path d="m407.27288,289.85509l2.95442,-5.12783l0,3.50852l2.95444,0l-2.95444,5.12783l0.00012,-3.50852l-2.95454,0z"/>
                        </g>
                      </svg>
                    </div>
                    <p class="text-white text-base font-medium leading-normal">Zetrabot 001</p>
                  </div>
                  <div class="grid min-h-[120px] gap-x-4 gap-y-6 grid-cols-[auto_1fr] items-center py-3">
                    <p class="text-[var(--turqueza)] text-[13px] font-bold leading-normal tracking-[0.015em]">Swappable pack </p>
                    <div class="battery-bar threshold-enabled" data-vehicle="zetrabot001">
                      <div class="threshold-line" style="width: 10%;"></div>
                      <div class="progress-bar" style="width: 15%;"></div>
                      <span class="text-white ml-2">15%</span>
                    </div>
                    <p class="text-[var(--turqueza)] text-[13px] font-bold leading-normal tracking-[0.015em]">Fixed pack </p>
                    <div class="battery-bar threshold-enabled" data-vehicle="zetrabot001">
                      <div class="threshold-line" style="width: 10%;"></div>
                      <div class="progress-bar" style="width: 80%;"></div>
                      <span class="text-white ml-2">80%</span>
                    </div>
                    <p class="text-[var(--turqueza)] text-[13px] font-bold leading-normal tracking-[0.015em]">Availability</p>
                    <div class="battery-bar" data-vehicle="zetrabot001">
                      <div class="progress-bar" style="width: 40%;"></div>
                      <span class="text-white ml-2">22 kWh</span>
                    </div>
                  </div>
                  <!-- Control de umbral mínimo -->
                  <div class="flex items-center gap-4 mt-4">
                    <p class="text-[var(--turqueza)] text-sm font-medium">Minimum Battery Threshold:</p>
                    <div class="flex-1 max-w-xs">
                      <input 
                        type="range" 
                        id="minThreshold_zetrabot001" 
                        min="0" 
                        max="100" 
                        value="10" 
                        class="w-full h-2 rounded-lg appearance-none cursor-pointer bg-[#21284a]"
                        oninput="updateThreshold('zetrabot001', this.value)"
                      >
                    </div>
                    <span id="thresholdValue_zetrabot001" class="text-white text-sm min-w-[3ch]">10%</span>
                  </div>
                </div>
                <!-- Trailer -->
                <div class="flex w-full flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg shadow-[var(--turqueza)]/50/50 transition-shadow duration-300 hover:shadow-xl">
                  <div class="flex items-center gap-3">
                    <div class="text-white">
                      <svg xmlns="http://www.w3.org/2000/svg" width="28px" height="28px" fill="currentColor" viewBox="0 -64 640 640">
                        <path d="M624,320H544V80a16,16,0,0,0-16-16H16A16,16,0,0,0,0,80V368a16,16,0,0,0,16,16H65.61c7.83-54.21,54-96,110.39-96s102.56,41.79,110.39,96H624a16,16,0,0,0,16-16V336A16,16,0,0,0,624,320ZM96,243.68a176.29,176.29,0,0,0-32,20.71V136a8,8,0,0,1,8-8H88a8,8,0,0,1,8,8Zm96-18.54c-5.31-.49-10.57-1.14-16-1.14s-10.69.65-16,1.14V136a8,8,0,0,1,8-8h16a8,8,0,0,1,8,8Zm96,39.25a176.29,176.29,0,0,0-32-20.71V136a8,8,0,0,1,8-8h16a8,8,0,0,1,8,8ZM384,320H352V136a8,8,0,0,1,8-8h16a8,8,0,0,1,8,8Zm96,0H448V136a8,8,0,0,1,8-8h16a8,8,0,0,1,8,8Zm-304,0a80,80,0,1,0,80,80A80,80,0,0,0,176,320Zm0,112a32,32,0,1,1,32-32A32,32,0,0,1,176,432Z" />
                      </svg>
                    </div>
                    <p class="text-white text-base font-medium leading-normal">Battery Station </p>
                  </div>
                  <div class="grid min-h-[120px] gap-x-4 gap-y-6 grid-cols-[auto_1fr] items-center py-3">
                    <p class="text-[var(--turqueza)] text-[13px] font-bold leading-normal tracking-[0.015em]">Swappable pack</p>
                    <div class="battery-bar threshold-enabled" data-vehicle="trailer001">
                      <div class="threshold-line" style="width: 20%;"></div>
                      <div class="progress-bar" style="width: 80%;"></div>
                      <span class="text-white ml-2">80%</span>
                    </div>
                    <p class="text-[var(--turqueza)] text-[13px] font-bold leading-normal tracking-[0.015em]">Availability</p>
                    <div class="battery-bar" data-vehicle="trailer001">
                      <div class="progress-bar" style="width: 80%;"></div>
                      <span class="text-white ml-2">35.2 kWh</span>
                    </div>
                  </div>
                  <!-- Control de umbral mínimo -->
                  <div class="flex items-center gap-4 mt-4">
                    <p class="text-[var(--turqueza)] text-sm font-medium">Minimum Battery Threshold:</p>
                    <div class="flex-1 max-w-xs">
                      <input 
                        type="range" 
                        id="minThreshold_trailer001" 
                        min="0" 
                        max="100" 
                        value="20" 
                        class="w-full h-2 rounded-lg appearance-none cursor-pointer bg-[#21284a]"
                        oninput="updateThreshold('trailer001', this.value)"
                      >
                    </div>
                    <span id="thresholdValue_trailer001" class="text-white text-sm min-w-[3ch]">20%</span>
                  </div>
                </div>
              </div>
              <!-- <h2 class="text-white text-[22px] leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">My Vehicles - current state of charge ( opcion 2)</h2>
              <p class="text-white px-4 pb-3 pt-5">Esta tabla es solo un ejemplo de visualizacion. No prestar atencion al contenido de esta tabla.</p>
              <div class="px-4 py-3 @container">
                <div class="flex overflow-hidden rounded border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 bg-[var(--azul-oscuro)] shadow-lg shadow-[var(--turqueza)]/50/50 transition-shadow duration-300 hover:shadow-xl">
                  <table class="flex-1">
                    <thead>
                      <tr class="bg-[#181d35]">
                        <th class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 px-4 py-3 text-left text-white w-[400px] text-xs font-medium leading-normal">Vehicle</th>
                        <th class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 px-4 py-3 text-left text-white w-[400px] text-xs font-medium leading-normal">Fixed Pack</th>
                        <th class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 px-4 py-3 text-left text-white w-[400px] text-xs font-medium leading-normal">Swappable Pack</th>
                        <th class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 px-4 py-3 text-left text-white w-60 text-xs font-medium leading-normal">Status</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="border-t border-t-[#4ABBBD]/50">
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 h-[72px] px-4 py-2 w-[400px] text-white text-sm font-normal leading-normal">Zetrabot-001</td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-3">
                            <div class="w-[88px] overflow-hidden rounded-sm bg-[var(--turqueza)]/20"><div class="h-1 rounded-full bg-[var(--turqueza)]" style="width: 96.5909%;"></div></div>
                            <p class="text-white text-xs font-medium leading-normal">85</p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-3">
                            <div class="w-[88px] overflow-hidden rounded-sm bg-[var(--turqueza)]/20"><div class="h-1 rounded-full bg-[var(--turqueza)]" style="width: 68.1818%;"></div></div>
                            <p class="text-white text-xs font-medium leading-normal">60</p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 h-[72px] px-4 py-2 w-60 text-white text-base font-medium leading-normal">
                          Operational
                        </td>
                      </tr>
                      <tr class="border-t border-t-[#4ABBBD]/50">
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 h-[72px] px-4 py-2 w-[400px] text-white text-sm font-normal leading-normal">Zetrabot-002</td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-3">
                            <div class="w-[88px] overflow-hidden rounded-sm bg-[var(--turqueza)]/20"><div class="h-1 rounded-full bg-[var(--turqueza)]" style="width: 51.1364%;"></div></div>
                            <p class="text-white text-xs font-medium leading-normal">45</p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-3">
                            <div class="w-[88px] overflow-hidden rounded-sm bg-[var(--turqueza)]/20"><div class="h-1 rounded-full bg-[var(--turqueza)]" style="width: 100%;"></div></div>
                            <p class="text-white text-xs font-medium leading-normal">90</p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 h-[72px] px-4 py-2 w-60 text-white text-base font-medium leading-normal">
                          Charging
                        </td>
                      </tr>
                      <tr class="border-t border-t-[#4ABBBD]/50">
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120 h-[72px] px-4 py-2 w-[400px] text-white text-sm font-normal leading-normal">Zetrabot-003</td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-3">
                            <div class="w-[88px] overflow-hidden rounded-sm bg-[var(--turqueza)]/20"><div class="h-1 rounded-full bg-[var(--turqueza)]" style="width: 22.7273%;"></div></div>
                            <p class="text-white text-xs font-medium leading-normal">20</p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360 h-[72px] px-4 py-2 w-[400px] text-sm font-normal leading-normal">
                          <div class="flex items-center gap-3">
                            <div class="w-[88px] overflow-hidden rounded-sm bg-[var(--turqueza)]/20"><div class="h-1 rounded-full bg-[var(--turqueza)]" style="width: 34.0909%;"></div></div>
                            <p class="text-white text-xs font-medium leading-normal">30</p>
                          </div>
                        </td>
                        <td class="table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600 h-[72px] px-4 py-2 w-60 text-white text-base font-medium leading-normal">
                          Alert
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <style>
                  @container(max-width:120px){.table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-120{display: none;}}
                  @container(max-width:240px){.table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-240{display: none;}}
                  @container(max-width:360px){.table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-360{display: none;}}
                  @container(max-width:480px){.table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-480{display: none;}}
                  @container(max-width:600px){.table-bf57a060-251e-4bf7-9af3-40165bfeca1d-column-600{display: none;}}
                </style>
              </div> -->
              <h2 class="text-white text-[22px] leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">Alerts</h2>
             
              <div class="flex items-center gap-4 bg-[var(--azul-oscuro)] px-4 min-h-[72px] py-2">
                <div class="text-white flex items-center justify-center rounded bg-[#21284a] shrink-0 size-12" data-icon="WarningCircle" data-size="24px" data-weight="regular">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                    <path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm-8-80V80a8,8,0,0,1,16,0v56a8,8,0,0,1-16,0Zm20,36a12,12,0,1,1-12-12A12,12,0,0,1,140,172Z"></path>
                  </svg>
                </div>
                <div class="flex flex-col justify-center">
                  <p class="text-white text-base font-medium leading-normal line-clamp-1">Zetrabot-002</p>
                  <p class="text-[var(--turqueza)] text-sm font-normal leading-normal line-clamp-2">Abnormal Charging Time</p>
                </div>
              </div>

              <div class="flex items-center gap-4 bg-[var(--azul-oscuro)] px-4 min-h-[72px] py-2">
                <div class="text-white flex items-center justify-center rounded bg-[#21284a] shrink-0 size-12" data-icon="WarningCircle" data-size="24px" data-weight="regular">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                    <path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm-8-80V80a8,8,0,0,1,16,0v56a8,8,0,0,1-16,0Zm20,36a12,12,0,1,1-12-12A12,12,0,0,1,140,172Z"></path>
                  </svg>
                </div>
                <div class="flex flex-col justify-center">
                  <p class="text-white text-base font-medium leading-normal line-clamp-1">Zetrabot-003</p>
                  <p class="text-[var(--turqueza)] text-sm font-normal leading-normal line-clamp-2">Damaged Cells</p>
                </div>
              </div>
              <div class="flex items-center gap-4 bg-[var(--azul-oscuro)] px-4 min-h-[72px] py-2">
                <div class="text-white flex items-center justify-center rounded bg-[#21284a] shrink-0 size-12" data-icon="CheckCircle" data-size="24px" data-weight="fill">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                    <path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm49.5,85.75-58.6,56a8,8,0,0,1-11.06-.07l-29.17-29.16a8,8,0,0,1,11.32-11.32L114.71,150l53.11-50.66a8,8,0,1,1,11,11.63Z"></path>
                  </svg>
                </div>
                <div class="flex flex-col justify-center">
                  <p class="text-white text-base font-medium leading-normal line-clamp-1">Zetrabot-001</p>
                  <p class="text-[var(--turqueza)] text-sm font-normal leading-normal line-clamp-2">All systems operational</p>
                </div>
              </div>
        </div>
    </div>

            <!-- ================================================================== -->
            <!-- =                        VEHICLES VIEW                           = -->
            <!-- ================================================================== -->
            <div id="vehicles-view" class="view hidden">
              <div class="flex flex-wrap justify-between gap-3 p-4">
                <p class="text-white font-bold text-[32px] leading-tight min-w-72" >Vehicles List</p>
              </div>
              <h2 class="text-white text-[22px] leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">Fleet Overview</h2>
              <div class="flex flex-wrap gap-4 p-4">
                <div class="flex min-w-[172px] flex-1 flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                  <p class="text-white text-base font-medium leading-normal">Total Vehicles</p>
                  <p class="text-white tracking-light text-2xl font-bold leading-tight">3</p>
                </div>
                
                <div class="flex min-w-[172px] flex-1 flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                  <p class="text-white text-base font-medium leading-normal">Active Vehicles</p>
                  <p class="text-white tracking-light text-2xl font-bold leading-tight">1</p>
                </div>
                <div class="flex min-w-[172px] flex-1 flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                    <p class="text-white text-base font-medium leading-normal">Available </p>
                    <p class="text-white tracking-light text-2xl font-bold leading-tight">1</p>
                  </div>
                <div class="flex min-w-[172px] flex-1 flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                  <p class="text-white text-base font-medium leading-normal">Charging</p>
                  <p class="text-white tracking-light text-2xl font-bold leading-tight">1</p>
                </div>
                <div class="flex min-w-[172px] flex-1 flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                    <p class="text-white text-base font-medium leading-normal">Out of Service</p>
                    <p class="text-white tracking-light text-2xl font-bold leading-tight">0</p>
                  </div>
                  <div class="flex min-w-[172px] flex-1 flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                    <p class="text-white text-base font-medium leading-normal">Battery Station</p>
                    <p class="text-white tracking-light text-2xl font-bold leading-tight">1</p>
                  </div>
               
              </div>
              <div class="px-4 py-3">
                <div class="flex overflow-hidden rounded border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 bg-[var(--azul-oscuro)] shadow-lg shadow-[var(--turqueza)]/50/50 transition-shadow duration-300 hover:shadow-xl">
                  <table class="flex-1">
                    <thead>
                      <tr class="bg-[#181d35]">
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Vehicle ID</th>
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Battery Level</th>
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Status</th>
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Location</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="border-t border-t-[#4ABBBD]/50">
                        <td class="px-4 py-3 text-white text-sm">Zetrabot-001</td>
                        <td class="px-4 py-3 text-white text-sm">65%</td>
                        <td class="px-4 py-3 text-green-400 text-sm">On duty</td>
                        <td class="px-4 py-3 text-white text-sm">Paddock 3</td>
                      </tr>
                      <tr class="border-t border-t-[#4ABBBD]/50">
                        <td class="px-4 py-3 text-white text-sm">Zetrabot-003</td>
                        <td class="px-4 py-3 text-white text-sm">80%</td>
                        <td class="px-4 py-3 text-green-400 text-sm">Available</td>
                        <td class="px-4 py-3 text-white text-sm">Paddock 3</td>
                      </tr>
                      <tr class="border-t border-t-[#4ABBBD]/50">
                        <td class="px-4 py-3 text-white text-sm">Zetrabot-002</td>
                        <td class="px-4 py-3 text-white text-sm">22%</td>
                        <td class="px-4 py-3 text-yellow-400 text-sm">Charging</td>
                        <td class="px-4 py-3 text-white text-sm">Warehouse</td>
                      </tr>
                      <tr class="border-t border-t-[#4ABBBD]/50">
                        <td class="px-4 py-3 text-white text-sm">Battery station</td>
                        <td class="px-4 py-3 text-white text-sm">80%</td>
                        <td class="px-4 py-3 text-green-400 text-sm">Available</td>
                        <td class="px-4 py-3 text-white text-sm">Warehouse</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <!-- ================================================================== -->
            <!-- =                  2)   Battery as a service VIEW                = -->
            <!-- ================================================================== -->
            <!-- <div id="reservation-view" class="view hidden w-full">
              <div class="flex flex-wrap justify-between gap-3 p-4">
                <p class="text-white tracking-light text-[32px] font-bold leading-tight min-w-72">Battery as a Service</p>
              </div>
              <h2 class="text-white text-[22px] leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">Reservation Management</h2>
              <div class="flex flex-wrap gap-4 p-4">
                <div class="flex min-w-[158px] flex-1 flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                  <p class="text-white text-base font-medium leading-normal">Active Reservations</p>
                  <p class="text-white tracking-light text-2xl font-bold leading-tight">0</p>
                </div>
                <div class="flex min-w-[158px] flex-1 flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                  <p class="text-white text-base font-medium leading-normal">Pending Reservations</p>
                  <p class="text-white tracking-light text-2xl font-bold leading-tight">1</p>
                </div>
              </div>
              <div class="p-4">
                <div class="bg-[#181d35] rounded p-6">
                  <h3 class="text-white text-lg mb-4">Make a Reservation</h3>
                  <div class="grid grid-cols-1 gap-4">
                    <div>
                      <label class="block text-white text-sm font-medium mb-2">Vehicle</label>
                      <select id="reservationVehicle" class="w-full p-2 rounded bg-[var(--turqueza)]/20 text-white border border-[#4a5578]">
                        <option value="" disabled selected>Select vehicle</option>
                        <option value="zetrabot1">Zetrabot-001</option>
                        <option value="zetrabot2">Zetrabot-002</option>
                        <option value="zetrabot3">Zetrabot-003</option>
                      </select>
                    </div>
                    <div>
                        <label class="block text-white text-sm font-medium mb-2">Number of packs</label>
                        <select id="reservationPacks" class="w-full p-2 rounded bg-[var(--turqueza)]/20 text-white border border-[#4a5578]">
                          <option value="" disabled selected>select the amount of packs</option>
                          <option value="1">1</option>
                          <option value="2">2</option>
                          <option value="3">3</option>
                          <option value="4">4</option>
                        </select>
                      </div>
                    <div>
                      <label class="block text-white text-sm font-medium mb-2">Start Time</label>
                      <input id="reservationStart" type="datetime-local" class="w-full p-2 rounded bg-[var(--turqueza)]/20 text-white border border-[#4a5578]">
                    </div>
                    <div>
                        <label class="block text-white text-sm font-medium mb-2">End Time</label>
                        <input id="reservationEnd" type="datetime-local" class="w-full p-2 rounded bg-[var(--turqueza)]/20 text-white border border-[#4a5578]">
                      </div>
                  </div>
                  <button onclick="requestReservation()" class="mt-4 bg-[var(--turqueza)] text-white px-6 py-2 rounded hover:bg-[#4f6bdb] transition-colors">
                    Request Reservation 
                  </button>
                </div>
              </div>

              <div class="px-4 py-3">
                <h3 class="text-white text-lg mb-4">Reservations List</h3>
                <div class="flex overflow-hidden rounded border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 bg-[var(--azul-oscuro)] shadow-lg shadow-[var(--turqueza)]/50/50 transition-shadow duration-300 hover:shadow-xl">
                  <table class="flex-1">
                    <thead>
                      <tr class="bg-[#181d35]">
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Pack Id</th>
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Start Time</th>
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">End Time</th>
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Consumo</th>
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Status</th>
                      </tr>
                    </thead>
                    <tbody id="reservationList">
                    </tbody>
                  </table>
                </div>
              </div>
            </div> -->

              <!-- ================================================================== -->
            <!-- =                     3) Consumption History VIEW                  = -->
            <!-- ================================================================== -->
            <div id="history-view" class="view hidden w-full">
              <div class="flex flex-wrap justify-between gap-3 p-4">
                <p class="text-white tracking-light text-[32px] font-bold leading-tight min-w-72">Consumption History</p>
              </div>
              
              <!-- Summary Cards -->
              <div class="flex flex-wrap gap-4 p-4">
                <div class="flex min-w-[158px] flex-1 flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                  <p class="text-white text-base font-medium leading-normal">Total Energy Used (30 days)</p>
                  <p class="text-white tracking-light text-2xl font-bold leading-tight">2,450 kWh</p>
                </div>
                <div class="flex min-w-[158px] flex-1 flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                  <p class="text-white text-base font-medium leading-normal">Average Daily Usage</p>
                  <p class="text-white tracking-light text-2xl font-bold leading-tight">81.6 kWh</p>
                </div>
                <div class="flex min-w-[158px] flex-1 flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                  <p class="text-white text-base font-medium leading-normal">Average Price </p>
                  <p class="text-white tracking-light text-2xl font-bold leading-tight">2.5 U$S/kWh</p>
                </div>
              </div>

              <!-- Consumption by Vehicle -->
              <h2 class="text-white text-[22px] leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">Charging station consumption by Time-of-day rates</h2>
              <div class="px-4 py-3">
                <div class="flex overflow-hidden rounded border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 bg-[var(--azul-oscuro)] shadow-lg shadow-[var(--turqueza)]/50/50 transition-shadow duration-300 hover:shadow-xl">
                  <table class="flex-1">
                    <thead>
                      <tr class="bg-[#181d35]">
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Time-of-day rate</th>
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Total consumption</th>
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Avg. Monthly</th>
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Trend</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="border-t border-t-[#4ABBBD]/50">
                        <td class="px-4 py-3 text-white text-sm">Peak</td>
                        <td class="px-4 py-3 text-white text-sm">20 %</td>
                        <td class="px-4 py-3 text-white text-sm">280 kWh</td>
                        <td class="px-4 py-3 text-green-400 text-sm">↑ 5%</td>
                      </tr>
                      <tr class="border-t border-t-[#4ABBBD]/50">
                        <td class="px-4 py-3 text-white text-sm">Shoulder</td>
                        <td class="px-4 py-3 text-white text-sm">12 %</td>
                        <td class="px-4 py-3 text-white text-sm">294 kWh</td>
                        <td class="px-4 py-3 text-red-400 text-sm">↓ 2%</td>
                      </tr>
                      <tr class="border-t border-t-[#4ABBBD]/50">
                        <td class="px-4 py-3 text-white text-sm">Off-peak</td>
                        <td class="px-4 py-3 text-white text-sm">68 %</td>
                        <td class="px-4 py-3 text-white text-sm">1680 kWh</td>
                        <td class="px-4 py-3 text-green-400 text-sm">↑ 3%</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Monthly Comparison -->
              <h2 class="text-white text-[22px] leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">Monthly Comparison</h2>
              <div class="flex flex-wrap gap-4 p-4">
                <div class="flex w-full flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                  <div class="flex justify-between items-center mb-4">
                    <p class="text-white text-base font-medium leading-normal">Energy Cost (U$S)</p>
                    <div class="flex gap-4">
                      <span class="text-[var(--turqueza)] text-sm">Current: 2.500 U$S</span>
                      <span class="text-[var(--turqueza)] text-sm">Previous: 2.200 U$S</span>
                    </div>  
                  </div>
                  <div class="grid grid-cols-2 gap-4">
                    <div class="flex flex-col gap-2">
                      <div class="h-4 bg-[#21284a] rounded-full overflow-hidden">
                        <div class="h-full bg-[var(--turqueza)]" style="width: 75%;"></div>
                      </div>
                    <p class="text-[var(--turqueza)] text-sm">estimated for July</p>
                    </div>
                    <div class="flex flex-col gap-2">
                      <div class="h-4 bg-[#21284a] rounded-full overflow-hidden">
                        <div class="h-full bg-[var(--turqueza)]" style="width: 85%;"></div>
                      </div>
                      <p class="text-[var(--turqueza)] text-sm">Last month</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="flex flex-wrap gap-4 p-4">
                <div class="flex w-full flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                  <div class="flex justify-between items-center mb-4">
                    <p class="text-white text-base font-medium leading-normal">Energy Price (U$S/kWh)</p>
                    <div class="flex gap-4">
                      <span class="text-[var(--turqueza)] text-sm">Current: 2.5 U$S/kWh</span>
                      <span class="text-[var(--turqueza)] text-sm">Previous: 2.2 U$S/kWh</span>
                    </div>  
                  </div>
                  <div class="grid grid-cols-2 gap-4">
                    <div class="flex flex-col gap-2">
                      <div class="h-4 bg-[#21284a] rounded-full overflow-hidden">
                        <div class="h-full bg-[var(--turqueza)]" style="width: 75%;"></div>
                      </div>
                    <p class="text-[var(--turqueza)] text-sm">estimated for July</p>
                    </div>
                    <div class="flex flex-col gap-2">
                      <div class="h-4 bg-[#21284a] rounded-full overflow-hidden">
                        <div class="h-full bg-[var(--turqueza)]" style="width: 85%;"></div>
                      </div>
                      <p class="text-[var(--turqueza)] text-sm">Last month</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="flex flex-wrap gap-4 p-4">
                <div class="flex w-full flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                  <div class="flex justify-between items-center mb-4">
                    <p class="text-white text-base font-medium leading-normal">Energy Consumption (kWh)</p>
                    <div class="flex gap-4">
                      <span class="text-[var(--turqueza)] text-sm">Current: 2,450 kWh</span>
                      <span class="text-[var(--turqueza)] text-sm">Previous: 2,280 kWh</span>
                    </div>  
                  </div>
                  <div class="grid grid-cols-2 gap-4">
                    <div class="flex flex-col gap-2">
                      <div class="h-4 bg-[#21284a] rounded-full overflow-hidden">
                        <div class="h-full bg-[var(--turqueza)]" style="width: 75%;"></div>
                      </div>
                    <p class="text-[var(--turqueza)] text-sm"> estimated for July</p>
                    </div>
                    <div class="flex flex-col gap-2">
                      <div class="h-4 bg-[#21284a] rounded-full overflow-hidden">
                        <div class="h-full bg-[var(--turqueza)]" style="width: 85%;"></div>
                      </div>
                      <p class="text-[var(--turqueza)] text-sm">Last month</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- ================================================================== -->
            <!-- ======                      BATTERY VIEW                     ===== -->
            <!-- ================================================================== -->

            <div id="battery-view" class="view hidden w-full">
              <div class="flex flex-wrap justify-between gap-3 p-4">
                <p class="text-white tracking-light text-[32px] font-bold leading-tight min-w-72">Battery System Health</p>
                <button 
                  onclick="openBatteryListModal()" 
                  class="bg-[var(--turqueza)] hover:bg-[#4a5fd8] text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg flex items-center gap-2"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                    <path d="M200,56H32A24,24,0,0,0,8,80v96a24,24,0,0,0,24,24H200a24,24,0,0,0,24-24V80A24,24,0,0,0,200,56Zm8,120a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8H200a8,8,0,0,1,8,8Zm48-80v64a8,8,0,0,1-16,0V96a8,8,0,0,1,16,0ZM138.81,123.79a8,8,0,0,1,.35,7.79l-16,32a8,8,0,0,1-14.32-7.16L119.06,136H100a8,8,0,0,1-7.16-11.58l16-32a8,8,0,1,1,14.32,7.16L112.94,120H132A8,8,0,0,1,138.81,123.79Z"></path>
                  </svg>
                  Battery List
                </button>
              </div>
              <!-- <h2 class="text-white text-[22px] leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">Batteries Analytics</h2> -->
              <div class="flex flex-wrap gap-4 p-4">
                <div class="flex min-w-[158px] flex-1 flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                  <p class="text-white text-base font-medium leading-normal">Average health Level</p>
                  <p class="text-white tracking-light text-2xl font-bold leading-tight">87%</p>
                </div>
                <div class="flex min-w-[158px] flex-1 flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                  <p class="text-white text-base font-medium leading-normal">Damaged cells</p>
                  <p class="text-white tracking-light text-2xl font-bold leading-tight">115</p>
                </div>
              </div>
              <div class="p-4">
               

                <!-- ------------------------------------------------------- -->


                <div class="flex w-full flex-col gap-2 rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg shadow-[var(--turqueza)]/50/50 transition-shadow duration-300 hover:shadow-xl">
                  <div class="flex items-center gap-3">
                    <div class="text-white">
                      <svg xmlns="http://www.w3.org/2000/svg" width="28px" height="28px" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M17 7H4V17H17V7M17 5C18.1046 5 19 5.89543 19 7V17C19 18.1046 18.1046 19 17 19H4C2.89543 19 2 18.1046 2 17V7C2 5.89543 2.89543 5 4 5H17M20 9H22V15H20V9M14 10V14H7V10H14Z"/>
                      </svg>
                    </div>
                    <p class="text-white text-base font-medium leading-normal">State of Health</p>
                  </div>
                  <div class="grid min-h-[120px] gap-x-4 gap-y-6 grid-cols-[auto_1fr] items-center py-3">
                    <p class="text-white text-[15px]  leading-normal tracking-[0.015em]"> Optimal  <span class="text-[var(--turqueza)]"> > 80% </span> </p>
                    <div class="battery-bar threshold-enabled" data-vehicle="zetrabot001">
                      <!-- <div class="threshold-line" style="width: 10%;"></div> -->
                      <div class="progress-bar bg-green-200/40" style="width: 8%; border-radius: 10px; margin-right: 2px; "></div>
                      <div class="progress-bar bg-green-200/40" style="width: 8%; border-radius: 10px; margin-right: 2px;"></div>
                      <div class="progress-bar bg-green-200/40" style="width: 8%; border-radius: 10px; margin-right: 2px;"></div>
                      <div class="progress-bar bg-green-200/40" style="width: 8%; border-radius: 10px; margin-right: 2px;"></div>
                      <div class="progress-bar bg-green-200/40" style="width: 8%; border-radius: 10px; margin-right: 2px;"></div>
                      <div class="progress-bar bg-green-200/40" style="width: 8%; border-radius: 10px; margin-right: 2px;"></div>
                      <div class="progress-bar bg-green-200/40" style="width: 8%; border-radius: 10px; margin-right: 2px;"></div>
                      <div class="progress-bar bg-green-200/40" style="width: 8%; border-radius: 10px; margin-right: 2px;"></div>
                      <div class="progress-bar bg-green-200/40" style="width: 8%; border-radius: 10px; margin-right: 2px;"></div>
                      <div class="progress-bar bg-green-200/40" style="width: 8%; border-radius: 10px; margin-right: 2px;"></div>

                      <span class="text-white/80 ml-2">10 Units</span>
                    </div>
                    <p class="text-white text-[15px]  leading-normal tracking-[0.015em]"> Acceptable  <span class="text-[var(--turqueza)]"> 60-80% </span> </p>
                    <div class="battery-bar threshold-enabled" data-vehicle="zetrabot001">
                      <!-- <div class="threshold-line" style="width: 8%;"></div> -->
                      <div class="progress-bar bg-yellow-100/70" style="width: 8%; border-radius: 10px; margin-right: 2px;"></div>
                      <div class="progress-bar bg-yellow-100/70" style="width: 8%; border-radius: 10px; margin-right: 2px;"></div>


                      <span class="text-white/80 ml-2">2 Units</span>
                    </div>
                    <p class="text-white text-[15px]  leading-normal tracking-[0.015em]"> Degraded<span class="text-[var(--turqueza)]"> < 60% </span> </p>
                    <div class="battery-bar" data-vehicle="zetrabot001">
                      <div class="progress-bar bg-red-200/70" style="width: 8%; border-radius: 10px; margin-right: 2px; "></div>
                      
                      <span class="text-white/80 ml-2">1 Unit</span>
                    </div>
                  </div>
                
                </div>

                <!-- ------------------------------------------------------- -->
                <!-- <div>
                  <div class="max-w-md mx-auto bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                      🔋 Battery Health Monitor (SoH)
                    </h2>
                
                    <div class="flex justify-between items-center bg-green-100 text-green-800 rounded-md p-3 mb-2">
                      <div>
                        <p class="text-sm font-semibold">Optimal</p>
                        <p class="text-xs">> 80%</p>
                      </div>
                      <p class="text-lg font-bold">10 Batteries</p>
                    </div>
                
                    <div class="flex justify-between items-center bg-yellow-100 text-yellow-800 rounded-md p-3 mb-2">
                      <div>
                        <p class="text-sm font-semibold">Acceptable</p>
                        <p class="text-xs">60% - 80%</p>
                      </div>
                      <p class="text-lg font-bold">2 Batteries</p>
                    </div>
                
                    <div class="flex justify-between items-center bg-red-100 text-red-800 rounded-md p-3 mb-4">
                      <div>
                        <p class="text-sm font-semibold">Degraded</p>
                        <p class="text-xs">&lt; 60%</p>
                      </div>
                      <p class="text-lg font-bold">1 Battery</p>
                    </div>
                
                    <div class="text-center text-sm text-gray-500 mt-4 italic">
                      [Aquí puede ir un gráfico tipo pastel con proporciones: 🟢 77% | 🟠 15% | 🔴 8%]
                    </div>
                  </div>
                </div> -->
              </div>
              <!-- Battery Slider Container -->
              <div class="mt-8 px-4">
                <!-- Header del slider -->
                <div class="flex items-center justify-between mb-6">
                  <h3 class="text-white text-xl font-semibold">Battery Health Monitor</h3>
                            <div class="flex items-center gap-4">
                    <span class="text-[var(--turqueza)] text-sm">Battery</span>
                    <span class="text-white text-lg font-bold" id="batteryCounter">ZT-145</span>
                    <span class="text-[var(--turqueza)] text-sm">of 13</span>
                              </div>
                            </div>

                <!-- Controles de navegación -->
                <div class="flex items-center justify-center gap-4 mb-6">
                  <button id="prevBatteryBtn" class="bg-[var(--turqueza)]/20 hover:bg-[#1a2040] text-white rounded-full w-10 h-10 flex items-center justify-center transition-all duration-200 hover:scale-110">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                      <path d="M168.49,199.51a12,12,0,0,1-17,17l-80-80a12,12,0,0,1,0-17l80-80a12,12,0,0,1,17,17L97,128Z"></path>
                    </svg>
                  </button>
                  
                  <button id="nextBatteryBtn" class="bg-[var(--turqueza)]/20 hover:bg-[#1a2040] text-white rounded-full w-10 h-10 flex items-center justify-center transition-all duration-200 hover:scale-110">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                      <path d="M88.49,56.49a12,12,0,0,1,17,0l80,80a12,12,0,0,1,0,17l-80,80a12,12,0,0,1-17-17L159,128Z"></path>
                    </svg>
                  </button>
                  </div>

                <!-- Slides de baterías -->
                <div class="relative overflow-hidden">
                  <!-- Slide 1: ZT-145 (Poor) -->
                  <div class="battery-slide active" id="battery-001">
                    <div class="flex items-center justify-center mb-10">
                      <div class="relative">
                        <!-- Gráfico circular de salud -->
                        <svg class="w-32 h-32 transform -rotate-90" viewBox="0 0 36 36">
                          <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#2f396a" stroke-width="2" stroke-linecap="round"/>
                          <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="var(--turqueza)" stroke-width="2" stroke-linecap="round" stroke-dasharray="45, 100" class="progress-circle-animate"/>
                        </svg>
                        
                        <!-- Icono de batería centrado -->
                        <div class="absolute inset-0 flex items-center justify-center">
                          <div class="bg-[#181d35] rounded-full p-3 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#ff6b6b" viewBox="0 0 256 256">
                              <path d="M200,56H32A24,24,0,0,0,8,80v96a24,24,0,0,0,24,24H200a24,24,0,0,0,24-24V80A24,24,0,0,0,200,56Zm8,120a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V80a8,8,0,0,1,16,0V152.77l61.17-61.18a8,8,0,0,1,11.31,0L148.1,127.2,215.32,60A8,8,0,0,1,226.63,71.32l-73.54,73.54a8,8,0,0,1-11.31,0L106.17,109.25,40,175.42V200H224A8,8,0,0,1,232,208Z"></path>
                            </svg>
                </div>
              </div>
                        
                        <!-- Porcentaje de salud superpuesto -->
                        <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2">
                          <span class="text-white text-lg font-bold">45%</span>
                              </div>
                            </div>
                              </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 w-full my-4">
                      <!-- Battery ID -->
                      <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                        <p class="text-[var(--turqueza)] text-sm">Battery ID</p>
                        <p class="text-white text-lg font-bold">ZT-145</p>
                        <p class="text-[var(--turqueza)] text-sm">Unique identifier</p>
                            </div>

                      <!-- Nominal Capacity -->
                      <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                        <p class="text-[var(--turqueza)] text-sm">Nominal Capacity</p>
                        <p class="text-white text-lg font-bold">60 kWh</p>
                        <p class="text-[var(--turqueza)] text-sm">Design capacity</p>
                  </div>

                      <!-- Current Capacity -->
                      <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                        <p class="text-[var(--turqueza)] text-sm">Current Capacity</p>
                        <p class="text-white text-lg font-bold">27 kWh</p>
                        <div class="w-full bg-[var(--turqueza)]/20 rounded-full h-2 mb-2">
                          <div class="bg-[#ff6b6b] h-2 rounded-full progress-bar progress-bar-animate" style="width: 45%"></div>
                </div>
                        <p class="text-[var(--turqueza)] text-sm">45% remaining</p>
              </div>

                      <!-- Battery Type -->
                      <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                        <p class="text-[var(--turqueza)] text-sm">Type</p>
                        <p class="text-white text-lg font-bold">Swappable</p>
                        <p class="text-[var(--turqueza)] text-sm">Removable pack</p>
                              </div>
                            </div>

                    <!-- Estado de salud -->
                    <div class="text-center mt-6">
                      <div class="inline-flex items-center gap-2 bg-red-500/20 border border-red-500/40 rounded-full px-4 py-2">
                        <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                        <span class="text-red-400 font-semibold">Poor Health</span>
                              </div>
                            </div>
                              </div>

                  <!-- Slide 2: ZT-145 (Fixed) -->
                  <div class="battery-slide hidden" id="battery-002">
                    <div class="flex items-center justify-center mb-10">
                      <div class="relative">
                        <svg class="w-32 h-32 transform -rotate-90" viewBox="0 0 36 36">
                          <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#2f396a" stroke-width="2" stroke-linecap="round"/>
                          <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#ffba21" stroke-width="2" stroke-linecap="round" stroke-dasharray="70, 100" class="progress-circle-animate"/>
                        </svg>
                        
                        <div class="absolute inset-0 flex items-center justify-center">
                          <div class="bg-[#181d35] rounded-full p-3 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#ffba21" viewBox="0 0 256 256">
                              <path d="M200,56H32A24,24,0,0,0,8,80v96a24,24,0,0,0,24,24H200a24,24,0,0,0,24-24V80A24,24,0,0,0,200,56Zm8,120a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V80a8,8,0,0,1,16,0V152.77l61.17-61.18a8,8,0,0,1,11.31,0L148.1,127.2,215.32,60A8,8,0,0,1,226.63,71.32l-73.54,73.54a8,8,0,0,1,11.31,0L106.17,109.25,40,175.42V200H224A8,8,0,0,1,232,208Z"></path>
                            </svg>
                            </div>
                              </div>
                        
                        <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2">
                          <span class="text-white text-lg font-bold">70%</span>
                            </div>
                              </div>
                            </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 w-full my-4">
                      <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                        <p class="text-[var(--turqueza)] text-sm">Battery ID</p>
                        <p class="text-white text-lg font-bold">ZT-145</p>
                        <p class="text-[var(--turqueza)] text-sm">Fixed version</p>
                              </div>

                      <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                        <p class="text-[var(--turqueza)] text-sm">Nominal Capacity</p>
                        <p class="text-white text-lg font-bold">60 kWh</p>
                        <p class="text-[var(--turqueza)] text-sm">Design capacity</p>
                            </div>

                      <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                        <p class="text-[var(--turqueza)] text-sm">Current Capacity</p>
                        <p class="text-white text-lg font-bold">42 kWh</p>
                        <div class="w-full bg-[var(--turqueza)]/20 rounded-full h-2 mb-2">
                          <div class="bg-[#ffba21] h-2 rounded-full progress-bar progress-bar-animate" style="width: 70%"></div>
                              </div>
                        <p class="text-[var(--turqueza)] text-sm">70% remaining</p>
                            </div>

                      <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                        <p class="text-[var(--turqueza)] text-sm">Type</p>
                        <p class="text-white text-lg font-bold">Fixed</p>
                        <p class="text-[var(--turqueza)] text-sm">Integrated pack</p>
                              </div>
                            </div>

                    <div class="text-center mt-6">
                      <div class="inline-flex items-center gap-2 bg-yellow-500/20 border border-yellow-500/40 rounded-full px-4 py-2">
                        <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                        <span class="text-yellow-400 font-semibold">Fair Health</span>
                              </div>
                            </div>
                  </div>

                  <!-- Slide 3: ZT-167 (Swappable) -->
                  <div class="battery-slide hidden" id="battery-003">
                    <div class="flex items-center justify-center mb-10">
                      <div class="relative">
                        <svg class="w-32 h-32 transform -rotate-90" viewBox="0 0 36 36">
                          <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#2f396a" stroke-width="2" stroke-linecap="round"/>
                          <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#ffba21" stroke-width="2" stroke-linecap="round" stroke-dasharray="75, 100" class="progress-circle-animate"/>
                        </svg>
                        
                        <div class="absolute inset-0 flex items-center justify-center">
                          <div class="bg-[#181d35] rounded-full p-3 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#ffba21" viewBox="0 0 256 256">
                              <path d="M200,56H32A24,24,0,0,0,8,80v96a24,24,0,0,0,24,24H200a24,24,0,0,0,24-24V80A24,24,0,0,0,200,56Zm8,120a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V80a8,8,0,0,1,16,0V152.77l61.17-61.18a8,8,0,0,1,11.31,0L148.1,127.2,215.32,60A8,8,0,0,1,226.63,71.32l-73.54,73.54a8,8,0,0,1,11.31,0L106.17,109.25,40,175.42V200H224A8,8,0,0,1,232,208Z"></path>
                            </svg>
                          </div>
                        </div>
                        
                        <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2">
                          <span class="text-white text-lg font-bold">75%</span>
                        </div>
                      </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 w-full my-4">
                      <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                        <p class="text-[var(--turqueza)] text-sm">Battery ID</p>
                        <p class="text-white text-lg font-bold">ZT-167</p>
                        <p class="text-[var(--turqueza)] text-sm">Swappable pack</p>
                      </div>

                      <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                        <p class="text-[var(--turqueza)] text-sm">Nominal Capacity</p>
                        <p class="text-white text-lg font-bold">60 kWh</p>
                        <p class="text-[var(--turqueza)] text-sm">Design capacity</p>
                      </div>

                      <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                        <p class="text-[var(--turqueza)] text-sm">Current Capacity</p>
                        <p class="text-white text-lg font-bold">45 kWh</p>
                        <div class="w-full bg-[var(--turqueza)]/20 rounded-full h-2 mb-2">
                          <div class="bg-[#ffba21] h-2 rounded-full progress-bar progress-bar-animate" style="width: 75%"></div>
                        </div>
                        <p class="text-[var(--turqueza)] text-sm">75% remaining</p>
                      </div>

                      <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                        <p class="text-[var(--turqueza)] text-sm">Type</p>
                        <p class="text-white text-lg font-bold">Swappable</p>
                        <p class="text-[var(--turqueza)] text-sm">Removable pack</p>
                      </div>
                    </div>

                    <div class="text-center mt-6">
                      <div class="inline-flex items-center gap-2 bg-yellow-500/20 border border-yellow-500/40 rounded-full px-4 py-2">
                        <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                        <span class="text-yellow-400 font-semibold">Fair Health</span>
                      </div>
                    </div>
                  </div>

                  <!-- Indicadores de slide -->
                  <div class="flex justify-center gap-2 mt-6">
                    <div class="w-3 h-3 bg-[var(--turqueza)] rounded-full slide-indicator active" data-slide="0"></div>
                    <div class="w-3 h-3 bg-[var(--turqueza)]/20 rounded-full slide-indicator" data-slide="1"></div>
                    <div class="w-3 h-3 bg-[var(--turqueza)]/20 rounded-full slide-indicator" data-slide="2"></div>
                  </div>
                </div>
              </div>
            </div>

            <!-- ================================================================== -->
            <!-- =                     Battery List VIEW                             = -->
            <!-- ================================================================== -->
            <div id="batteryListModal" class="modal-backdrop fixed inset-0 z-50 hidden flex items-center justify-center">
                <div class="modal-content bg-[var(--azul-oscuro)] border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 rounded-lg shadow-2xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                  <!-- Header del modal -->
                  <div class="flex items-center justify-between p-6 border-b border-[var(--turqueza)] border-opacity-50">
                    <h3 class="text-white text-xl font-semibold">Battery Health Monitor</h3>
                    <button 
                      onclick="closeBatteryListModal()" 
                      class="text-[var(--turqueza)] hover:text-white transition-colors duration-200"
                    >
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
                        <path d="M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"></path>
                      </svg>
                    </button>
                  </div>

                  <!-- Contenido del modal -->
                  <div class="p-6">
                    <!-- Header del slider -->
                    <div class="flex items-center justify-between mb-6">
                      <h3 class="text-white text-xl font-semibold">Battery Health Monitor</h3>
                            <div class="flex items-center gap-4">
                        <span class="text-[var(--turqueza)] text-sm">Battery</span>
                        <span class="text-white text-lg font-bold" id="modalBatteryCounter">ZT-145</span>
                        <span class="text-[var(--turqueza)] text-sm">of 13</span>
                              </div>
                            </div>

                    <!-- Controles de navegación -->
                    <div class="flex items-center justify-center gap-4 mb-6">
                      <button id="modalPrevBatteryBtn" class="bg-[var(--turqueza)]/20 hover:bg-[#1a2040] text-white rounded-full w-10 h-10 flex items-center justify-center transition-all duration-200 hover:scale-110">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                          <path d="M168.49,199.51a12,12,0,0,1-17,17l-80-80a12,12,0,0,1,0-17l80-80a12,12,0,0,1,17,17L97,128Z"></path>
                        </svg>
                      </button>
                      
                      <button id="modalNextBatteryBtn" class="bg-[var(--turqueza)]/20 hover:bg-[#1a2040] text-white rounded-full w-10 h-10 flex items-center justify-center transition-all duration-200 hover:scale-110">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                          <path d="M88.49,56.49a12,12,0,0,1,17,0l80,80a12,12,0,0,1,0,17l-80,80a12,12,0,0,1-17-17L159,128Z"></path>
                        </svg>
                      </button>
                  </div>

                    <!-- Slides de baterías -->
                    <div class="relative overflow-hidden">
                      <!-- Slide 1: ZT-145 (Poor) -->
                      <div class="modal-battery-slide active" id="modal-battery-001">
                        <div class="flex items-center justify-center mb-10">
                          <div class="relative">
                            <svg class="w-32 h-32 transform -rotate-90" viewBox="0 0 36 36">
                              <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#2f396a" stroke-width="2" stroke-linecap="round"/>
                              <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="var(--turqueza)" stroke-width="2" stroke-linecap="round" stroke-dasharray="45, 100" class="progress-circle-animate"/>
                            </svg>
                            
                            <div class="absolute inset-0 flex items-center justify-center">
                              <div class="bg-[#181d35] rounded-full p-3 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#ff6b6b" viewBox="0 0 256 256">
                                  <path d="M200,56H32A24,24,0,0,0,8,80v96a24,24,0,0,0,24,24H200a24,24,0,0,0,24-24V80A24,24,0,0,0,200,56Zm8,120a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8H200a8,8,0,0,1,8,8Zm48-80v64a8,8,0,0,1-16,0V96a8,8,0,0,1,16,0ZM138.81,123.79a8,8,0,0,1,.35,7.79l-16,32a8,8,0,0,1-14.32-7.16L119.06,136H100a8,8,0,0,1-7.16-11.58l16-32a8,8,0,1,1,14.32,7.16L112.94,120H132A8,8,0,0,1,138.81,123.79Z"></path>
                                </svg>
                              </div>
                            </div>
                            
                            <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2">
                              <span class="text-white text-lg font-bold">45%</span>
                            </div>
                          </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 w-full my-4">
                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Battery ID</p>
                            <p class="text-white text-lg font-bold">ZT-145</p>
                            <p class="text-[var(--turqueza)] text-sm">Unique identifier</p>
                          </div>

                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Nominal Capacity</p>
                            <p class="text-white text-lg font-bold">60 kWh</p>
                            <p class="text-[var(--turqueza)] text-sm">Design capacity</p>
                          </div>

                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Current Capacity</p>
                            <p class="text-white text-lg font-bold">27 kWh</p>
                            <div class="w-full bg-[var(--turqueza)]/20 rounded-full h-2 mb-2">
                              <div class="bg-[#ff6b6b] h-2 rounded-full progress-bar progress-bar-animate" style="width: 45%"></div>
                            </div>
                            <p class="text-[var(--turqueza)] text-sm">45% remaining</p>
                          </div>

                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Type</p>
                            <p class="text-white text-lg font-bold">Swappable</p>
                            <p class="text-[var(--turqueza)] text-sm">Removable pack</p>
                          </div>
                        </div>

                        <div class="text-center mt-6">
                          <div class="inline-flex items-center gap-2 bg-red-500/20 border border-red-500/40 rounded-full px-4 py-2">
                            <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                            <span class="text-red-400 font-semibold">Poor Health</span>
                          </div>
                        </div>
                      </div>

                      <!-- Slide 2: ZT-145 (Fixed) -->
                      <div class="modal-battery-slide hidden" id="modal-battery-002">
                        <div class="flex items-center justify-center mb-10">
                          <div class="relative">
                            <svg class="w-32 h-32 transform -rotate-90" viewBox="0 0 36 36">
                              <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#2f396a" stroke-width="2" stroke-linecap="round"/>
                              <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#ffba21" stroke-width="2" stroke-linecap="round" stroke-dasharray="70, 100" class="progress-circle-animate"/>
                            </svg>
                            
                            <div class="absolute inset-0 flex items-center justify-center">
                              <div class="bg-[#181d35] rounded-full p-3 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#ffba21" viewBox="0 0 256 256">
                                  <path d="M200,56H32A24,24,0,0,0,8,80v96a24,24,0,0,0,24,24H200a24,24,0,0,0,24-24V80A24,24,0,0,0,200,56Zm8,120a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8H200a8,8,0,0,1,8,8Zm48-80v64a8,8,0,0,1-16,0V96a8,8,0,0,1,16,0ZM138.81,123.79a8,8,0,0,1,.35,7.79l-16,32a8,8,0,0,1-14.32-7.16L119.06,136H100a8,8,0,0,1-7.16-11.58l16-32a8,8,0,1,1,14.32,7.16L112.94,120H132A8,8,0,0,1,138.81,123.79Z"></path>
                                </svg>
                              </div>
                            </div>
                            
                            <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2">
                              <span class="text-white text-lg font-bold">70%</span>
                            </div>
                          </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 w-full my-4">
                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Battery ID</p>
                            <p class="text-white text-lg font-bold">ZT-145</p>
                            <p class="text-[var(--turqueza)] text-sm">Fixed version</p>
                          </div>

                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Nominal Capacity</p>
                            <p class="text-white text-lg font-bold">60 kWh</p>
                            <p class="text-[var(--turqueza)] text-sm">Design capacity</p>
                          </div>

                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Current Capacity</p>
                            <p class="text-white text-lg font-bold">42 kWh</p>
                            <div class="w-full bg-[var(--turqueza)]/20 rounded-full h-2 mb-2">
                              <div class="bg-[#ffba21] h-2 rounded-full progress-bar progress-bar-animate" style="width: 70%"></div>
                            </div>
                            <p class="text-[var(--turqueza)] text-sm">70% remaining</p>
                          </div>

                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Type</p>
                            <p class="text-white text-lg font-bold">Fixed</p>
                            <p class="text-[var(--turqueza)] text-sm">Integrated pack</p>
                          </div>
                        </div>

                        <div class="text-center mt-6">
                          <div class="inline-flex items-center gap-2 bg-yellow-500/20 border border-yellow-500/40 rounded-full px-4 py-2">
                            <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                            <span class="text-yellow-400 font-semibold">Fair Health</span>
                          </div>
                        </div>
                      </div>

                      <!-- Slide 3: ZT-167 (Swappable) -->
                      <div class="modal-battery-slide hidden" id="modal-battery-003">
                        <div class="flex items-center justify-center mb-10">
                          <div class="relative">
                            <svg class="w-32 h-32 transform -rotate-90" viewBox="0 0 36 36">
                              <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#2f396a" stroke-width="2" stroke-linecap="round"/>
                              <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#ffba21" stroke-width="2" stroke-linecap="round" stroke-dasharray="75, 100" class="progress-circle-animate"/>
                            </svg>
                            
                            <div class="absolute inset-0 flex items-center justify-center">
                              <div class="bg-[#181d35] rounded-full p-3 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#ffba21" viewBox="0 0 256 256">
                                  <path d="M200,56H32A24,24,0,0,0,8,80v96a24,24,0,0,0,24,24H200a24,24,0,0,0,24-24V80A24,24,0,0,0,200,56Zm8,120a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8H200a8,8,0,0,1,8,8Zm48-80v64a8,8,0,0,1-16,0V96a8,8,0,0,1,16,0ZM138.81,123.79a8,8,0,0,1,.35,7.79l-16,32a8,8,0,0,1-14.32-7.16L119.06,136H100a8,8,0,0,1-7.16-11.58l16-32a8,8,0,1,1,14.32,7.16L112.94,120H132A8,8,0,0,1,138.81,123.79Z"></path>
                                </svg>
                              </div>
                            </div>
                            
                            <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2">
                              <span class="text-white text-lg font-bold">75%</span>
                            </div>
                          </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 w-full my-4">
                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Battery ID</p>
                            <p class="text-white text-lg font-bold">ZT-167</p>
                            <p class="text-[var(--turqueza)] text-sm">Swappable pack</p>
                          </div>

                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Nominal Capacity</p>
                            <p class="text-white text-lg font-bold">60 kWh</p>
                            <p class="text-[var(--turqueza)] text-sm">Design capacity</p>
                          </div>

                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Current Capacity</p>
                            <p class="text-white text-lg font-bold">45 kWh</p>
                            <div class="w-full bg-[var(--turqueza)]/20 rounded-full h-2 mb-2">
                              <div class="bg-[#ffba21] h-2 rounded-full progress-bar progress-bar-animate" style="width: 75%"></div>
                            </div>
                            <p class="text-[var(--turqueza)] text-sm">75% remaining</p>
                          </div>

                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Type</p>
                            <p class="text-white text-lg font-bold">Swappable</p>
                            <p class="text-[var(--turqueza)] text-sm">Removable pack</p>
                          </div>
                        </div>

                        <div class="text-center mt-6">
                          <div class="inline-flex items-center gap-2 bg-yellow-500/20 border border-yellow-500/40 rounded-full px-4 py-2">
                            <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                            <span class="text-yellow-400 font-semibold">Fair Health</span>
                          </div>
                        </div>
                      </div>

                      <!-- Slide 4: ZT-201 (Good) -->
                      <div class="modal-battery-slide hidden" id="modal-battery-004">
                        <div class="flex items-center justify-center mb-10">
                          <div class="relative">
                            <svg class="w-32 h-32 transform -rotate-90" viewBox="0 0 36 36">
                              <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#2f396a" stroke-width="2" stroke-linecap="round"/>
                              <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#4ade80" stroke-width="2" stroke-linecap="round" stroke-dasharray="83, 100" class="progress-circle-animate"/>
                            </svg>
                            
                            <div class="absolute inset-0 flex items-center justify-center">
                              <div class="bg-[#181d35] rounded-full p-3 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#4ade80" viewBox="0 0 256 256">
                                  <path d="M200,56H32A24,24,0,0,0,8,80v96a24,24,0,0,0,24,24H200a24,24,0,0,0,24-24V80A24,24,0,0,0,200,56Zm8,120a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8H200a8,8,0,0,1,8,8Zm48-80v64a8,8,0,0,1-16,0V96a8,8,0,0,1,16,0ZM138.81,123.79a8,8,0,0,1,.35,7.79l-16,32a8,8,0,0,1-14.32-7.16L119.06,136H100a8,8,0,0,1-7.16-11.58l16-32a8,8,0,1,1,14.32,7.16L112.94,120H132A8,8,0,0,1,138.81,123.79Z"></path>
                                </svg>
                              </div>
                            </div>
                            
                            <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2">
                              <span class="text-white text-lg font-bold">83%</span>
                            </div>
                          </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 w-full my-4">
                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Battery ID</p>
                            <p class="text-white text-lg font-bold">ZT-201</p>
                            <p class="text-[var(--turqueza)] text-sm">Swappable pack</p>
                          </div>

                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Nominal Capacity</p>
                            <p class="text-white text-lg font-bold">60 kWh</p>
                            <p class="text-[var(--turqueza)] text-sm">Design capacity</p>
                          </div>

                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Current Capacity</p>
                            <p class="text-white text-lg font-bold">49.8 kWh</p>
                            <div class="w-full bg-[var(--turqueza)]/20 rounded-full h-2 mb-2">
                              <div class="bg-[#4ade80] h-2 rounded-full progress-bar progress-bar-animate" style="width: 83%"></div>
                            </div>
                            <p class="text-[var(--turqueza)] text-sm">83% remaining</p>
                          </div>

                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Type</p>
                            <p class="text-white text-lg font-bold">Swappable</p>
                            <p class="text-[var(--turqueza)] text-sm">Removable pack</p>
                          </div>
                        </div>

                        <div class="text-center mt-6">
                          <div class="inline-flex items-center gap-2 bg-green-500/20 border border-green-500/40 rounded-full px-4 py-2">
                            <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                            <span class="text-green-400 font-semibold">Good Health</span>
                          </div>
                        </div>
                      </div>

                      <!-- Slide 5: ZT-156 (Good) -->
                      <div class="modal-battery-slide hidden" id="modal-battery-005">
                        <div class="flex items-center justify-center mb-10">
                          <div class="relative">
                            <svg class="w-32 h-32 transform -rotate-90" viewBox="0 0 36 36">
                              <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#2f396a" stroke-width="2" stroke-linecap="round"/>
                              <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#4ade80" stroke-width="2" stroke-linecap="round" stroke-dasharray="84, 100" class="progress-circle-animate"/>
                            </svg>
                            
                            <div class="absolute inset-0 flex items-center justify-center">
                              <div class="bg-[#181d35] rounded-full p-3 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 shadow-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#4ade80" viewBox="0 0 256 256">
                                  <path d="M200,56H32A24,24,0,0,0,8,80v96a24,24,0,0,0,24,24H200a24,24,0,0,0,24-24V80A24,24,0,0,0,200,56Zm8,120a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8H200a8,8,0,0,1,8,8Zm48-80v64a8,8,0,0,1-16,0V96a8,8,0,0,1,16,0ZM138.81,123.79a8,8,0,0,1,.35,7.79l-16,32a8,8,0,0,1-14.32-7.16L119.06,136H100a8,8,0,0,1-7.16-11.58l16-32a8,8,0,1,1,14.32,7.16L112.94,120H132A8,8,0,0,1,138.81,123.79Z"></path>
                                </svg>
                              </div>
                            </div>
                            
                            <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2">
                              <span class="text-white text-lg font-bold">84%</span>
                            </div>
                          </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 w-full my-4">
                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Battery ID</p>
                            <p class="text-white text-lg font-bold">ZT-156</p>
                            <p class="text-[var(--turqueza)] text-sm">Swappable pack</p>
                          </div>

                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Nominal Capacity</p>
                            <p class="text-white text-lg font-bold">60 kWh</p>
                            <p class="text-[var(--turqueza)] text-sm">Design capacity</p>
                          </div>

                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Current Capacity</p>
                            <p class="text-white text-lg font-bold">50.4 kWh</p>
                            <div class="w-full bg-[var(--turqueza)]/20 rounded-full h-2 mb-2">
                              <div class="bg-[#4ade80] h-2 rounded-full progress-bar progress-bar-animate" style="width: 84%"></div>
                            </div>
                            <p class="text-[var(--turqueza)] text-sm">84% remaining</p>
                          </div>

                          <div class="bg-[#181d35] p-4 rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 text-center">
                            <p class="text-[var(--turqueza)] text-sm">Type</p>
                            <p class="text-white text-lg font-bold">Swappable</p>
                            <p class="text-[var(--turqueza)] text-sm">Removable pack</p>
                          </div>
                        </div>

                        <div class="text-center mt-6">
                          <div class="inline-flex items-center gap-2 bg-green-500/20 border border-green-500/40 rounded-full px-4 py-2">
                            <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                            <span class="text-green-400 font-semibold">Good Health</span>
                          </div>
                        </div>
                      </div>

                      <!-- Indicadores de slide -->
                      <div class="flex justify-center gap-2 mt-6">
                        <div class="w-3 h-3 bg-[var(--turqueza)] rounded-full modal-slide-indicator active" data-slide="0"></div>
                        <div class="w-3 h-3 bg-[var(--turqueza)]/20 rounded-full modal-slide-indicator" data-slide="1"></div>
                        <div class="w-3 h-3 bg-[var(--turqueza)]/20 rounded-full modal-slide-indicator" data-slide="2"></div>
                        <div class="w-3 h-3 bg-[var(--turqueza)]/20 rounded-full modal-slide-indicator" data-slide="3"></div>
                        <div class="w-3 h-3 bg-[var(--turqueza)]/20 rounded-full modal-slide-indicator" data-slide="4"></div>
                      </div>
                    </div>
                </div>
              </div>
            </div>

<!-------------------------------             2a seccion sidebar  ( inferior)            ------------------------------->

            <!-- ================================================================== -->
            <!-- =                        WORK VIEW                                 = -->
            <!-- ================================================================== -->
            <div id="work-view" class="view hidden">
              <div class="flex flex-wrap justify-between gap-3 p-4">
                <p class="text-white tracking-light text-[32px] font-bold leading-tight min-w-72 p-6">Energy Master</p>
              </div>
              
              <!-- Lista de trabajos -->
              <div class="px-4 py-5">
               <div class="p-6">
                <h3 class="text-white text-lg mb-4">Work List</h3>
                <div class="flex overflow-hidden rounded border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 bg-[var(--azul-oscuro)] shadow-lg shadow-[var(--turqueza)]/50/50 transition-shadow duration-300 hover:shadow-xl">
                  <table class="flex-1">
                    <thead>
                      <tr class="">
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Work Name</th>
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Vehicle</th>
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Paddock</th>
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Tool</th>
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Estimated Consumption</th>
                        <th class="px-4 py-3 text-left text-white text-sm font-medium">Status</th>
                      </tr>
                    </thead>
                    <tbody id="workList">
                      <!-- Ejemplo predefinido de trabajo de fertilización pendiente -->
                      <tr class="border-t border-[var(--turqueza)] border-opacity-50">
                        <td class="px-4 py-3 text-white">Mowing-Paddock 4</td>
                        <td class="px-4 py-3 text-white">Zetrabot-1</td>
                        <td class="px-4 py-3 text-white">Paddock 4</td>
                        <td class="px-4 py-3 text-white">Mower</td>
                        <td class="px-4 py-3 text-white">12.5 kWh</td>
                        <td class="px-4 py-3">
                          <span class="px-2 py-1 text-xs font-medium rounded-full bg-[var(--turqueza)] text-white">
                            Pending
                          </span>
                        </td>
                      </tr>
                      <tr class="border-t border-[var(--turqueza)] border-opacity-50">
                        <td class="px-4 py-3 text-white">Spraying-Paddock 7</td>
                        <td class="px-4 py-3 text-white">Zetrabot-2</td>
                        <td class="px-4 py-3 text-white">Paddock 7</td>
                        <td class="px-4 py-3 text-white">Sprayer</td>
                        <td class="px-4 py-3 text-white">38.2 kWh</td>
                        <td class="px-4 py-3">
                          <span class="px-2 py-1 text-xs font-medium rounded-full bg-[var(--turqueza)] text-white">
                            Pending
                          </span>
                        </td>
                      </tr>
                     
                      <!-- Ejemplo predefinido de trabajo de fertilización completado -->
                      <tr class="border-t border-[var(--turqueza)] border-opacity-50">
                        <td class="px-4 py-3 text-white">Spraying-Paddock 3</td>
                        <td class="px-4 py-3 text-white">Zetrabot-1</td>
                        <td class="px-4 py-3 text-white">Paddock 3</td>
                        <td class="px-4 py-3 text-white">Sprayer</td>
                        <td class="px-4 py-3 text-white">42.5 kWh</td>
                        <td class="px-4 py-3">
                          <span class="px-2 py-1 text-xs font-medium rounded-full bg-[var(--turqueza)]/20 text-[var(--turqueza)]">
                            Completed
                          </span>
                        </td>
                      </tr>
                      <!-- Los trabajos se agregarán aquí dinámicamente -->
                    </tbody>
                  </table>
                  </div>
                </div>
              </div>

            <!-- Resultados del consumo -->
            <div id="consumptionResults" class="mt-6 rounded p-6 hidden">
              <div class="p-6">
                <h3 class="text-white text-lg mb-4">Consumption Results</h3>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                  <div class="flex flex-col gap-2 rounded p-4 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                    <p class="text-white text-base font-medium">Transport to Paddock</p>
                    <p id="transportToCost" class="text-white text-2xl font-bold">-- kWh</p>
                  </div>
                  <div class="flex flex-col gap-2 rounded p-4 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                    <p class="text-white text-base font-medium">Transport from Paddock</p>
                    <p id="transportFromCost" class="text-white text-2xl font-bold">-- kWh</p>
                  </div>
                  <div class="flex flex-col gap-2 rounded p-4 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                    <p class="text-white text-base font-medium">Effective Work (per hour)</p>
                    <p id="effectiveWorkCostPerHour" class="text-white text-2xl font-bold">-- kWh</p>
                  </div>
                  <div class="flex flex-col gap-2 rounded p-4 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50">
                    <p class="text-white text-base font-medium">Effective Work (total hours)</p>
                    <p id="effectiveWorkCostTotal" class="text-white text-2xl font-bold">-- kWh</p>
                  </div>
                </div>
              </div>
            </div>

              <div class="p-4">
                <div class="p-6">
                <div class=" rounded p-6 border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70">
                  <h3 class="text-white text-lg mb-4">Create New Work/Mission</h3>
                  <div class="grid grid-cols-1 gap-4">
                    <!-- Nombre del trabajo -->
                    <div>
                      <label class="block text-white text-sm font-medium mb-2">Work Name</label>
                      <input type="text" id="workName" class="w-full p-2 rounded bg-transparent text-[var(--turqueza)] border border-[#4a5578]" placeholder="Enter work name">
                    </div>

                    <!-- Selección de vehículo -->
                    <div>
                      <label class="block text-white text-sm font-medium mb-2">Vehicle</label>
                      <select id="vehicle" class="w-full p-2 rounded bg-transparent text-[var(--turqueza)] border border-[#4a5578]">
                        <option value="" disabled selected class="bg-transparent text-[var(--turqueza)]">Select vehicle</option>
                        <option value="zetrabot1" class="bg-transparent text-[var(--azul-oscuro)]">Zetrabot-001</option>
                        <option value="zetrabot2" class="bg-transparent text-[var(--azul-oscuro)]">Zetrabot-002</option>
                        <option value="zetrabot3" class="bg-transparent text-[var(--azul-oscuro)]">Zetrabot-003</option>
                      </select>
                    </div>

                    <!-- Selección de parcela -->
                    <div>
                      <label class="block text-white text-sm font-medium mb-2">Paddock</label>
                      <select id="paddock" class="w-full p-2 rounded bg-transparent text-[var(--turqueza)] border border-[#4a5578]">
                        <option value="" disabled selected class="bg-transparent text-[var(--turqueza)]">Select paddock</option>
                        <option value="paddock1" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 1</option>
                        <option value="paddock2" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 2</option>
                        <option value="paddock3" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 3</option>
                        <option value="paddock4" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 4</option>
                        <option value="paddock5" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 5</option>
                        <option value="paddock6" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 6</option>
                        <option value="paddock7" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 7</option>
                        <option value="paddock8" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 8</option>
                        <option value="paddock9" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 9</option>
                        <option value="paddock10" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 10</option>
                        <option value="paddock11" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 11</option>
                        <option value="paddock12" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 12</option>
                      </select>
                    </div>

                    <!-- Apero/Herramienta -->
                    <div>
                      <label class="block text-white text-sm font-medium mb-2">Tool/Equipment</label>
                      <select id="tool" class="w-full p-2 rounded bg-transparent text-[var(--turqueza)] border border-[#4a5578]">
                        <option value="" disabled selected class="bg-transparent text-[var(--turqueza)]">Select tool</option>
                        <option value="sprayer" class="bg-transparent text-[var(--azul-oscuro)]">Sprayer</option>
                        <option value="seeder" class="bg-transparent text-[var(--azul-oscuro)]">Seeder</option>
                        <option value="harvester" class="bg-transparent text-[var(--azul-oscuro)]">Harvester</option>
                        <option value="plow" class="bg-transparent text-[var(--azul-oscuro)]">Plow</option>
                        <option value="mower" class="bg-transparent text-[var(--azul-oscuro)]">Mower</option>
                        <!-- <option value="trailer">Trailer</option> -->


                      </select>
                    </div>

                    <!-- Traslado hacia la paddock -->
                    <div>
                      <label class="block text-white text-sm font-medium mb-2">Transport to Paddock - From:</label>
                      <select id="transportFrom" class="w-full p-2 rounded bg-transparent text-[var(--turqueza)] border border-[#4a5578]">
                        <option value="" disabled selected class="bg-transparent text-[var(--turqueza)]">Select origin</option>
                        <option value="warehouse" class="bg-transparent text-[var(--azul-oscuro)]">Warehouse</option>
                        <option value="paddock1" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 1</option>
                        <option value="paddock2" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 2</option>
                        <option value="paddock3" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 3</option>
                        <option value="paddock4" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 4</option>
                        <option value="paddock5" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 5</option>
                        <option value="paddock6" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 6</option>
                        <option value="paddock7" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 7</option>
                        <option value="paddock8" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 8</option>
                        <option value="paddock9" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 9</option>
                        <option value="paddock10" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 10</option>
                        <option value="paddock11" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 11</option>
                        <option value="paddock12" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 12</option>
                      </select>
                    </div>

                    <!-- Traslado desde la paddock -->
                    <div>
                      <label class="block text-white text-sm font-medium mb-2">Transport from Paddock - To:</label>
                      <select id="transportTo" class="w-full p-2 rounded bg-transparent text-[var(--turqueza)] border border-[#4a5578]">
                        <option value="" disabled selected class="bg-transparent text-[var(--turqueza)]">Select destination</option>
                        <option value="warehouse" class="bg-transparent text-[var(--azul-oscuro)]">Warehouse</option>
                        <option value="paddock1" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 1</option>
                        <option value="paddock2" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 2</option>
                        <option value="paddock3" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 3</option>
                        <option value="paddock4" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 4</option>
                        <option value="paddock5" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 5</option>
                        <option value="paddock6" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 6</option>
                        <option value="paddock7" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 7</option>
                        <option value="paddock8" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 8</option>
                        <option value="paddock9" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 9</option>
                        <option value="paddock10" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 10</option>
                        <option value="paddock11" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 11</option>
                        <option value="paddock12" class="bg-transparent text-[var(--azul-oscuro)]">Paddock 12</option>
                      </select>
                    </div>

                    <!-- Horas estimadas de trabajo -->
                    <div>
                      <label class="block text-white text-sm font-medium mb-2">Estimated hours of work</label>
                      <input type="number" id="estimatedHours" min="0.5" step="0.5" class="w-full p-2 rounded bg-transparent text-[var(--turqueza)] border border-[#4a5578]" placeholder="Enter estimated hours">
                    </div>

                    <!-- Botón de crear trabajo -->
                    <button onclick="calculateWorkConsumption()" class="mt-4 bg-[var(--turqueza)] text-white px-6 py-2 rounded hover:bg-[#4f6bdb] transition-colors">
                      Create Work
                    </button>
                  </div>
                  </div>
                </div>
              </div>

          <!-- Modal: Consumption Results -->
          <div id="consumption-modal" class="hidden fixed inset-0 z-[100] items-center justify-center">
            <div class="absolute inset-0 bg-black/60 backdrop-blur-sm"></div>
            <div id="consumption-modal-content" class="relative w-[min(920px,92vw)] rounded-lg border border-[#4ABBBD]/50 bg-[#181d35] shadow-2xl transition-all duration-300 ease-out transform opacity-0 scale-95">
              <div class="flex items-center justify-between px-5 py-4 border-b border-[#4ABBBD]/30">
                <h3 class="text-white text-xl font-semibold">Consumption Results</h3>
                <button onclick="closeConsumptionModal()" class="text-white/80 hover:text-white text-2xl leading-none">&times;</button>
              </div>
              <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                  <div class="flex flex-col gap-2 rounded p-4 border border-[#4ABBBD]/50">
                    <p class="text-white text-sm font-medium">To Paddock</p>
                    <p id="modalTransportToCost" class="text-[var(--turqueza)] text-2xl font-bold">-- kWh</p>
                  </div>
                  <div class="flex flex-col gap-2 rounded p-4 border border-[#4ABBBD]/50">
                    <p class="text-white text-sm font-medium">From Paddock</p>
                    <p id="modalTransportFromCost" class="text-[var(--turqueza)] text-2xl font-bold">-- kWh</p>
                  </div>
                  <div class="flex flex-col gap-2 rounded p-4 border border-[#4ABBBD]/50">
                    <p class="text-white text-sm font-medium">Consumption /hour</p>
                    <p id="modalEffectiveWorkPerHour" class="text-[var(--turqueza)] text-2xl font-bold">-- kWh</p>
                  </div>
                  <div class="flex flex-col gap-2 rounded p-4 border border-[#4ABBBD]/50">
                    <p class="text-white text-sm font-medium">Total Consumption </p>
                    <p id="modalEffectiveWorkTotal" class="text-[var(--turqueza)] text-2xl font-bold">-- kWh</p>
                  </div>
                </div>
                <div class="mt-6 flex items-center justify-between rounded border border-[#4ABBBD]/50 p-4">
                  <span class="text-white text-base">Total Energy Consumption</span>
                  <span id="modalTotalConsumption" class="text-[var(--turqueza)] text-3xl font-bold">-- kWh</span>
                </div>
                <div class="mt-6 flex justify-end">
                  <button onclick="closeConsumptionModal()" class="bg-[var(--turqueza)] text-white px-5 py-2 rounded">Close</button>
                </div>
              </div>
            </div>
          </div>
          </div>
            
             <!-- ================================================================== -->
            <!-- =                     MISSIONS VIEW                               = -->
            <!-- ================================================================== -->
            <div id="missions-view" class="view hidden">
              <div class="flex flex-wrap justify-between gap-3 p-4">
                <p class="text-white tracking-light text-[32px] font-bold leading-tight min-w-72">Missions & Tasks</p>
              </div>
              
              <div class="p-4 space-y-6">
                <!-- Mapa de Misiones con Rutas Destacadas -->
                <div class="p-6">
                  
                                    <!-- Contenedor del mapa reducido (limpio, sin controles ni branding) -->
                  <div class="flex justify-center">
                    <div id="missionsMap" class="w-[30%] h-80 rounded-lg border border-white/90 bg-[var(--azul-oscuro)] relative shadow-xl shadow-white/70 transition-shadow duration-300 hover:shadow-2xl z-10">
                      <!-- El mapa se cargará aquí sin controles de navegación ni watermark -->
                      <div class="absolute inset-0 flex items-center justify-center">
                        <div class="text-center text-[var(--turqueza)]">
                          <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" viewBox="0 0 256 256" class="mx-auto mb-2">
                            <path d="M128,64a40,40,0,1,0,40,40A40,40,0,0,0,128,64Zm0,64a24,24,0,1,1,24-24A24,24,0,0,1,128,128Zm0-112A88.1,88.1,0,0,0,40,128c0,31.8,18.68,65.61,42.52,95.55a256.38,256.38,0,0,0,42.12,37.65,6,6,0,0,0,6.72,0,256.38,256.38,0,0,0,42.12-37.65C197.32,193.61,216,159.8,216,128A88.1,88.1,0,0,0,128,16Zm0,206a72.61,72.61,0,0,1-33.36-8.69C66,207.52,56,180.43,56,128a72,72,0,0,1,144,0c0,52.43-10,79.52-38.64,85.31A72.61,72.61,0,0,1,128,222Z"></path>
                          </svg>
                          <p class="text-sm">Map loading...</p>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Leyenda de Rutas -->
                  <div class="mt-4 flex flex-wrap gap-4 text-sm">
                    <div class="flex items-center gap-2">
                      <div class="w-4 h-1 bg-[var(--turqueza)]/20 rounded-full"></div>
                      <span class="text-[var(--turqueza)]">Finca Boundary</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <div class="w-4 h-1 bg-[#ffffff] rounded-full"></div>
                      <span class="text-[var(--turqueza)]">Snake Line Route</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <div class="w-4 h-1 bg-[#ffffff] rounded-full"></div>
                      <span class="text-[var(--turqueza)]">Paddock 3 Boundary</span>
                    </div>
                  </div>
                </div>

                <!-- Información de la Snake Line -->
                <div class="grid grid-cols-1 gap-6">
                  <div class="bg-[#181d35] rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 p-6">
                    <div class="flex items-start justify-between mb-4">
                      <h4 class="text-white text-lg font-semibold">Snake Line Navigation Route</h4>
                      <span class="bg-[#ffff00]/20 text-[#ffff00] px-3 py-1 rounded-full text-xs font-medium">Active</span>
                    </div>
                    <div class="space-y-3 text-sm">
                      <div class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#607afb" viewBox="0 0 256 256">
                          <path d="M128,64a40,40,0,1,0,40,40A40,40,0,0,0,128,64Zm0,64a24,24,0,1,1,24-24A24,24,0,0,1,128,128Zm0-112A88.1,88.1,0,0,0,40,128c0,31.8,18.68,65.61,42.52,95.55a256.38,256.38,0,0,0,42.12,37.65,6,6,0,0,0,6.72,0,256.38,256.38,0,0,0,42.12-37.65C197.32,193.61,216,159.8,216,128A88.1,88.1,0,0,0,128,16Zm0,206a72.61,72.61,0,0,1-33.36-8.69C66,207.52,56,180.43,56,128a72,72,0,0,1,144,0c0,52.43-10,79.52-38.64,85.31A72.61,72.61,0,0,1,128,222Z"></path>
                        </svg>
                        <span class="text-[var(--turqueza)]">Route Type:</span>
                        <span class="text-white">Navigation Path</span>
                      </div>
                      <div class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#607afb" viewBox="0 0 256 256">
                          <path d="M200,56H32A24,24,0,0,0,8,80v96a24,24,0,0,0,24,24H200a24,24,0,0,0,24-24V80A24,24,0,0,0,200,56Zm8,120a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8H200a8,8,0,0,1,8,8Zm48-80v64a8,8,0,0,1-16,0V96a8,8,0,0,1,16,0ZM138.81,123.79a8,8,0,0,1,.35,7.79l-16,32a8,8,0,0,1-14.32-7.16L119.06,136H100a8,8,0,0,1-7.16-11.58l16-32a8,8,0,0,1,14.32,7.16L112.94,120H132A8,8,0,0,1,138.81,123.79Z"></path>
                        </svg>
                        <span class="text-[var(--turqueza)]">Status:</span>
                        <span class="text-white">Active Navigation</span>
                      </div>
                      <div class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#607afb" viewBox="0 0 256 256">
                          <path d="M128,56a8,8,0,0,1,8,8v40h40a8,8,0,0,1,0,16H136v40a8,8,0,0,1-16,0V120H80a8,8,0,0,1,0-16h40V64A8,8,0,0,1,128,56Z"></path>
                        </svg>
                        <span class="text-[var(--turqueza)]">Waypoints:</span>
                        <span class="text-white">45 coordenadas</span>
                      </div>
                      <div class="w-full bg-[var(--turqueza)]/20 rounded-full h-2">
                        <div class="bg-[#ffff00] h-2 rounded-full" style="width: 100%"></div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Estadísticas de Misiones -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                  <div class="bg-[#181d35] rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 p-4 text-center">
                    <div class="text-[#4ade80] text-2xl font-bold">3</div>
                    <div class="text-[var(--turqueza)] text-sm">Active Missions</div>
                  </div>
                  <div class="bg-[#181d35] rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 p-4 text-center">
                    <div class="text-[#ffba21] text-2xl font-bold">2</div>
                    <div class="text-[var(--turqueza)] text-sm">In Progress</div>
                  </div>
                  <div class="bg-[#181d35] rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 p-4 text-center">
                    <div class="text-[#607afb] text-2xl font-bold">8</div>
                    <div class="text-[var(--turqueza)] text-sm">Completed Today</div>
                  </div>
                  <div class="bg-[#181d35] rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 p-4 text-center">
                    <div class="text-[#ff6b6b] text-2xl font-bold">1</div>
                    <div class="text-[var(--turqueza)] text-sm">Pending</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- ================================================================== -->
            <!-- =                     SETTINGS VIEW                                = -->
            <!-- ================================================================== -->
            <div id="settings-view" class="view hidden">
              <div class="flex flex-wrap justify-between gap-3 p-4">
                <p class="text-white tracking-light text-[32px] font-bold leading-tight min-w-72">Settings</p>
              </div>
              
              <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                  <!-- General Settings -->
                  <div class="bg-[#181d35] rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 p-6">
                    <h3 class="text-white text-lg font-semibold mb-4">General Settings</h3>
                    <div class="space-y-4">
                      <div class="flex items-center justify-between">
                        <span class="text-white text-sm">Dark Mode</span>
                        <div class="relative">
                          <input type="checkbox" class="sr-only" id="dark-mode">
                          <label for="dark-mode" class="block w-12 h-6 bg-[#2f396a] rounded-full cursor-pointer">
                            <span class="block w-5 h-5 bg-white rounded-full transform transition-transform duration-200 ease-in-out"></span>
                          </label>
                        </div>
                      </div>
                      <div class="flex items-center justify-between">
                        <span class="text-white text-sm">Notifications</span>
                        <div class="relative">
                          <input type="checkbox" class="sr-only" id="notifications">
                          <label for="notifications" class="block w-12 h-6 bg-[var(--turqueza)] rounded-full cursor-pointer">
                            <span class="block w-5 h-5 bg-white rounded-full transform translate-x-6 transition-transform duration-200 ease-in-out"></span>
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Energy Settings -->
                  <div class="bg-[#181d35] rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 p-6">
                    <h3 class="text-white text-lg font-semibold mb-4">Energy Settings</h3>
                    <div class="space-y-4">
                      <div>
                        <label class="block text-white text-sm mb-2">Default Battery Threshold</label>
                        <input type="range" min="5" max="95" value="20" class="w-full h-2 bg-[#2f396a] rounded-lg appearance-none cursor-pointer">
                        <div class="flex justify-between text-xs text-gray-400 mt-1">
                          <span>5%</span>
                          <span>95%</span>
                        </div>
                      </div>
                      <div>
                        <label class="block text-white text-sm mb-2">Auto-refresh Interval</label>
                        <select class="w-full p-2 bg-[#2f396a] text-white rounded border border-[#4a5578]">
                          <option value="5">5 seconds</option>
                          <option value="10" selected>10 seconds</option>
                          <option value="30">30 seconds</option>
                          <option value="60">1 minute</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <!-- Map Settings -->
                  <div class="bg-[#181d35] rounded-lg border border-[#4ABBBD]/50 hover:border-[#4ABBBD]/70 transition-all duration-300 border-opacity-50 p-6">
                    <h3 class="text-white text-lg font-semibold mb-4">Map Settings</h3>
                    <div class="space-y-4">
                      <div>
                        <label class="block text-white text-sm mb-2">Map Style</label>
                        <select class="w-full p-2 bg-[#2f396a] text-white rounded border border-[#4a5578]">
                          <option value="satellite">Satellite</option>
                          <option value="terrain" selected>Terrain</option>
                          <option value="street">Street</option>
                        </select>
                      </div>
                      <div class="flex items-center justify-between">
                        <span class="text-white text-sm">Show Grid</span>
                        <div class="relative">
                          <input type="checkbox" class="sr-only" id="show-grid">
                          <label for="show-grid" class="block w-12 h-6 bg-[#2f396a] rounded-full cursor-pointer">
                            <span class="block w-5 h-5 bg-white rounded-full transform transition-transform duration-200 ease-in-out"></span>
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="p-4">
                <div class="bg-[#181d35] rounded p-6 mb-6">
                  <h3 class="text-white text-lg mb-4"> Tiempo real </h3>

                  <p class="text-[var(--turqueza)]">mapa de la finca  , localizacion de vehiculos dentro de la finca . Ultima posicion de los vehiculos . etc ?? </p>
                  <p class="text-[var(--turqueza)]">misiones activas , rutas de las misiones , etc ?? </p>
                  
                </div>
                <div class="bg-[#181d35] rounded p-6 mb-6">
                  <h3 class="text-white text-lg mb-4">Salud / capacidad de las baterias</h3>
                  <p class="text-[var(--turqueza)]">Como lo mido, que medidas son las mas importantes </p>
                  <p class="text-[var(--turqueza)]"> # celdas dañadas, # voltaje, # otro ??  </p>
                  <p class="text-[var(--turqueza)]"> # SoH= Capacidad nominal / Capacidad actual (Ah o Wh) × 100%</p>
                     <p class="text-[var(--turqueza)]"> #  Diferencia de voltaje entre celdas</p>
                </div>

                <div class="bg-[#181d35] rounded p-6 mb-6">
                  <h3 class="text-white text-lg mb-4">Emisiones / ahorro de emisiones de CO2</h3>
                  <p class="text-[var(--turqueza)]">Nos interesa mostrar esto? que indicadores nos interesa mostrar?</p>
                </div>

                <div class="bg-[#181d35] rounded p-6 mb-6">
                  <h3 class="text-white text-lg mb-4">Generacion de energia en la finca</h3>
                  <p class="text-[var(--turqueza)]">Incluimos ejemplos de generacion de energia / Paneles solares? </p>
                </div>

                <div class="bg-[#181d35] rounded p-6">
                  <h3 class="text-white text-lg mb-4">Pulir enfoque para trabajar con los rangos</h3>
                  <p class="text-[var(--turqueza)]">0-100% y 20-80% ... pareciera que los indicadores se hacen repetitivos/duplicados, o estamos bien encaminados?</p>
                </div>
              </div>
            </div>

           

<!-- ===================================================================================================================== -->

<!-- ============                                        JavaScript                                            =============== -->
            
<!-- ===================================================================================================================== -->

    <script>
      // ✅ SCRIPT DE PRUEBA - Verificar que JavaScript funcione
      console.log('Script cargado correctamente');
      
      // ✅ SOLUCIÓN: Estado inicial correcto
      let currentView = null;

      // ✅ FUNCIÓN DE PRUEBA - Verificar que las funciones se definan
      function testFunction() {
        console.log('Función de prueba funcionando');
        return true;
      }
      
      // ✅ SOLUCIÓN: Función mejorada para cambiar vistas
      function navigateTo(viewName) {
        console.log('navigateTo called with:', viewName);
        
        // Ocultar TODAS las vistas primero
        document.querySelectorAll('.view').forEach(view => {
          view.classList.add('hidden');
          console.log('Hiding view:', view.id);
        });
        
        // Mostrar solo la vista seleccionada
        const targetView = document.getElementById(viewName + '-view');
        // Mover la vista dentro de #main-content si aún no lo está
        const mainContent = document.getElementById('main-content');
        if (targetView && mainContent && !mainContent.contains(targetView)) {
          try {
            mainContent.appendChild(targetView);
            console.log('Moved view into #main-content:', targetView.id);
          } catch (err) {
            console.error('Error moving view into #main-content:', err);
          }
        }
        if (targetView) {
          targetView.classList.remove('hidden');
          console.log('Showing view:', targetView.id);
        } else {
          console.error('Target view not found:', viewName + '-view');
        }
        
        // --- SOLUCIÓN PARA EL REDIMENSIONAMIENTO DE MAPAS ---
        // Al mostrar una vista que contiene un mapa, es necesario llamar a .resize()
        // para que el mapa se ajuste al tamaño de su contenedor, que ahora es visible.
        // Se usa un retardo para dar tiempo al navegador a renderizar el contenedor.
        if (viewName === 'live-monitoring' && window.map) {
          setTimeout(() => { if(window.map) window.map.resize(); }, 1);
        }
        if (viewName === 'live-monitoring-2' && window.map3Instance) {
            setTimeout(() => { if(window.map3Instance) window.map3Instance.resize(); }, 1);
        }
        
        // Actualizar estado
        currentView = viewName;
        console.log('Current view set to:', currentView);
        
        // Actualizar URL
        history.pushState({view: viewName}, '', `#${viewName}`);
        
        // Actualizar navegación activa
        updateActiveNav(viewName);
        
        // Inicializar mapa de misiones si es necesario
        if (viewName === 'missions') {
          setTimeout(() => {
            initializeMissionsMap();
          }, 100);
        }
      }

//================       Función para inicializar el mapa de misiones con rutas destacadas     =========================//

      function initializeMissionsMap() {
        console.log('initializeMissionsMap called');
        
        // Configurar el token de acceso de Mapbox
        mapboxgl.accessToken = 'pk.eyJ1Ijoic2ViYXN0aWFucHJhZG8iLCJhIjoiY21ibTQ4NHNlMGdzMzJsczU0a2s3MjFlbCJ9.h3TjjeSIyavEQjqlu8oAKw';
        
        const missionsMapContainer = document.getElementById('missionsMap');
        if (!missionsMapContainer) {
          console.error('missionsMap container not found');
          return;
        }

        console.log('missionsMap container found, clearing...');
        // Limpiar el contenedor
        missionsMapContainer.innerHTML = '';

        try {
          console.log('Creating mapboxgl.Map...');
          // Crear un mapa simplificado para misiones
          const missionsMap = new mapboxgl.Map({
            container: 'missionsMap',
            style: 'mapbox://styles/mapbox/satellite-v9',
            projection: 'globe',
            zoom: 16,
            center: [-2.468, 42.835], // Centro aproximado de Paddock 3
            pitch: 0,
            interactive: true,
            attributionControl: false,
            logoPosition: 'bottom-left'
          });

          // Controles de navegación removidos para un mapa más limpio
          // missionsMap.addControl(new mapboxgl.NavigationControl(), 'top-right');

        // Cuando el mapa se carga, agregar la snake line
        missionsMap.on('style.load', () => {

          // Agregar fuente para la snake line (línea amarilla)
          missionsMap.addSource('snake-line', {
            'type': 'geojson',
            'data': {
              'type': 'Feature',
              'properties': {},
              'geometry': {
                'type': 'LineString',
                'coordinates': [[-2.471166051338031,42.83623951331677],[-2.4677344013283573,42.83644768469631],[-2.467592459600752,42.8364538073732],[-2.467525663493575,42.83639870325791],[-2.4675841100861646,42.836355844468216],[-2.4676926537608495,42.836331353717725],[-2.4707485756671588,42.8361537954859],[-2.4708654688550666,42.83613542736376],[-2.470923915448992,42.836098691103075],[-2.470923915448992,42.836049709388504],[-2.470873818368318,42.83600072763517],[-2.4707485756671588,42.83601297307737],[-2.467525663493575,42.8362088998191],[-2.4674254693321416,42.83623339061813],[-2.4673336246839312,42.83623339061813],[-2.4672417800370567,42.8362088998191],[-2.4671666344166567,42.836166040897325],[-2.4671582849034337,42.83611705923616],[-2.4671916829563827,42.83606807753617],[-2.467291877117816,42.836049709388504],[-2.467375372251439,42.83604358667159],[-2.4674588673850906,42.83606195482105],[-2.4675507120332725,42.836074200250664],[-2.470531488319182,42.8359088867428],[-2.47060663393961,42.835878273081846],[-2.4706233329660563,42.835829291192596],[-2.47060663393961,42.83576806377613],[-2.4705565368588793,42.835731327297566],[-2.4704730417252847,42.835731327297566],[-2.470389546591605,42.835749695539334],[-2.470322750484428,42.835786432007495],[-2.4672417800370567,42.835957868568954],[-2.4671499353902107,42.83598235946752],[-2.4670497412287773,42.83599460491334],[-2.466957896581931,42.83599460491334],[-2.4668827509601385,42.835963991294875],[-2.4668243043662414,42.835902764011905],[-2.466807605339767,42.83584153666831],[-2.466874401446944,42.835786432007495],[-2.4669996441480464,42.835780309264464],[-2.4670914887962283,42.8357925547499],[-2.4671582849034337,42.83583541393074],[-2.470155760215846,42.835663977029554],[-2.4702476048640563,42.835633363246785],[-2.470272653403697,42.835578258400375],[-2.470264303890474,42.83551703073522],[-2.4702142068097714,42.835474171334084],[-2.4701474107025945,42.83544968023415],[-2.4700555660556915,42.835474171334084],[-2.4700138184882405,42.83552315350482],[-2.469955371894315,42.83554764457563],[-2.467408770305667,42.83567622253801]]
              }
            }
          });

          // Agregar fuente para Paddock 3 (donde está la snake line)
          missionsMap.addSource('paddock-3', {
            'type': 'geojson',
            'data': {
              'type': 'Feature',
              'properties': {},
              'geometry': {
                'type': 'LineString',
                'coordinates': [[-2.4671253282082546,42.833255959737755],[-2.4670661697778655,42.833225294450585],[-2.4670242756506866,42.83324531407479],[-2.466935927769157,42.83331613289215],[-2.4664864331816716,42.83367479900167],[-2.46640775964093,42.83374779360966],[-2.466337959026191,42.8338012293481],[-2.4663091409267395,42.83381822083024],[-2.4662843435553157,42.83381851443903],[-2.466238139178216,42.83381710265871],[-2.4661541722547042,42.8337990679764],[-2.466130703766339,42.83379039108331],[-2.4661089986175,42.83380114194736],[-2.4660839371635745,42.83382410542447],[-2.4656367499776763,42.83419010817531],[-2.4652074770928323,42.83452917151328],[-2.46507465659181,42.8346320436502],[-2.465051290295861,42.834654007334166],[-2.465049296971358,42.834667462898636],[-2.465054782895862,42.834682648815715],[-2.465074196578513,42.83469780973829],[-2.465208925299521,42.83475959653808],[-2.46526507078579,42.8347878943855],[-2.4653750021353744,42.834849974698585],[-2.465559163770905,42.83496448391966],[-2.4656906043620097,42.83505890967646],[-2.4660073069510133,42.83529175682847],[-2.466179434672597,42.835427957716746],[-2.466285988687332,42.835514232287835],[-2.466392542702039,42.835600506738444],[-2.4665286920170217,42.83572195462406],[-2.466590020048727,42.835777887797775],[-2.466776845482997,42.83592646491567],[-2.466847251803074,42.835977043422616],[-2.4670023099746174,42.836093919903476],[-2.467193835242284,42.836233147507926],[-2.4673640307979667,42.836366120600246],[-2.4674421302564724,42.83643189627796],[-2.467512180666887,42.83648487679682],[-2.467575642174495,42.83652639389612],[-2.467614281232443,42.83654527198533],[-2.4676466872952005,42.83655028427552],[-2.467679093358612,42.83655529656528],[-2.467719867869448,42.836559760109964],[-2.4677533416597157,42.836557565130704],[-2.46778389516129,42.836552706741315],[-2.4678699778708904,42.83653095056786],[-2.4679541670868446,42.83651340208817],[-2.4681114841452256,42.836500870549884],[-2.4682801964823113,42.83649328932273],[-2.468634534880408,42.83646815490562],[-2.4688579447139034,42.83645603741124],[-2.4692121734863974,42.836433986835374],[-2.4695095419739914,42.83641313113171],[-2.4696879189488925,42.83639985175077],[-2.469898453682873,42.83638506209908],[-2.4701874580062793,42.83636927638787],[-2.4702082806950614,42.836370126652554],[-2.4702278467304666,42.836357132208065],[-2.470234809878889,42.836339899767154],[-2.4702318473421485,42.83632268513074],[-2.4702291215651258,42.83630387233674],[-2.470229782693295,42.8362843563326],[-2.470259411006216,42.836271985900886],[-2.4703839305797084,42.8362591520914],[-2.470572278908771,42.83624267708743],[-2.4706548829492716,42.83623524705635],[-2.4707063270744913,42.83625147193271],[-2.4707309609014807,42.8362855956707],[-2.4707454799816873,42.83631962616047],[-2.4707775658376274,42.83632685119278],[-2.4710377641785835,42.8363146842659],[-2.4713179351725594,42.83629284022246],[-2.471330749310698,42.83629079993946],[-2.471347707152453,42.836273180090984],[-2.471337600780169,42.83625081096817],[-2.471130733049061,42.83610539963255],[-2.4705760993536816,42.83570460849043],[-2.470037323847052,42.83532051223153],[-2.469354515526131,42.834839951429814],[-2.468586840445944,42.83429075250972],[-2.4671253282082546,42.833255959737755]]
              }
            }
          });



          // Agregar capa para la snake line (línea blanca y fina)
          missionsMap.addLayer({
            'id': 'snake-line-layer',
            'type': 'line',
            'source': 'snake-line',
            'layout': {
              'line-join': 'round',
              'line-cap': 'round'
            },
            'paint': {
              'line-color': '#ffffff',
              'line-width': 1.5,
              'line-opacity': 0.9
            }
          });

          // Agregar capa para Paddock 3 (borde de la parcela)
          missionsMap.addLayer({
            'id': 'paddock-3-boundary',
            'type': 'line',
            'source': 'paddock-3',
            'layout': {
              'line-join': 'round',
              'line-cap': 'round'
            },
            'paint': {
              'line-color': '#ffffff',
              'line-width': 1.5,
              'line-opacity': 0.9
            }
          });



          // Agregar popup para la snake line
          missionsMap.on('click', 'snake-line-layer', (e) => {
            const popup = new mapboxgl.Popup()
              .setLngLat(e.lngLat)
              .setHTML(`
                <div class="p-2">
                  <h4 class="font-semibold text-gray-800">Snake Line Route</h4>
                  <p class="text-sm text-gray-600">Type: Navigation Path</p>
                  <p class="text-sm text-gray-600">Status: Active</p>
                  <p class="text-sm text-gray-600">Waypoints: 45 coordenadas</p>
                </div>
              `)
              .addTo(missionsMap);
          });

          // Cambiar cursor al hacer hover sobre la snake line
          missionsMap.on('mouseenter', 'snake-line-layer', () => {
            missionsMap.getCanvas().style.cursor = 'pointer';
          });

          missionsMap.on('mouseleave', 'snake-line-layer', () => {
            missionsMap.getCanvas().style.cursor = '';
          });

          // Cambiar cursor al hacer hover sobre Paddock 3
          missionsMap.on('mouseenter', 'paddock-3-boundary', () => {
            missionsMap.getCanvas().style.cursor = 'pointer';
          });

          missionsMap.on('mouseleave', 'paddock-3-boundary', () => {
            missionsMap.getCanvas().style.cursor = '';
          });

          // Agregar popup para Paddock 3
          missionsMap.on('click', 'paddock-3-boundary', (e) => {
            const popup = new mapboxgl.Popup()
              .setLngLat(e.lngLat)
              .setHTML(`
                <div class="p-2">
                  <h4 class="font-semibold text-gray-800">Paddock 3</h4>
                  <p class="text-sm text-gray-600">Type: Field Boundary</p>
                  <p class="text-sm text-gray-600">Contains: Snake Line Route</p>
                  <p class="text-sm text-gray-600">Status: Active Field</p>
                </div>
              `)
              .addTo(missionsMap);
          });

          // Centrar el mapa en el centro de Paddock 3
          missionsMap.easeTo({
            center: [-2.468, 42.835],
            zoom: 16,
            duration: 2000
          });
        });

        // Guardar referencia global del mapa
        window.missionsMapInstance = missionsMap;
        } catch (error) {
          console.error('Error creating missions map:', error);
          // Mostrar mensaje de error en el contenedor
          const missionsMapContainer = document.getElementById('missionsMap');
          if (missionsMapContainer) {
            missionsMapContainer.innerHTML = `
              <div class="absolute inset-0 flex items-center justify-center">
                <div class="text-center text-[#ff6b6b]">
                  <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" viewBox="0 0 256 256" class="mx-auto mb-2">
                    <path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm64-88a64.71,64.71,0,0,1-3.34,21.34l-5.65-5.65A40,40,0,0,0,128,88V40.48A87.83,87.83,0,0,1,192,128ZM40,128A87.83,87.83,0,0,1,88,40.48V88a40,40,0,0,0,52.31,38.66l-5.65,5.65A64.71,64.71,0,0,1,40,128Z"></path>
                  </svg>
                  <p class="text-sm">Error loading map: ${error.message}</p>
                </div>
              </div>
            `;
          }
        }
      }

      // ✅ SOLUCIÓN: Función mejorada para actualizar navegación
      function updateActiveNav(activeView) {
        // Remover clase active de todos los elementos
        document.querySelectorAll('.nav-item').forEach(item => {
          item.classList.remove('active');
        });
        
        // Agregar clase active al elemento correcto
        const activeItem = document.querySelector(`[data-view="${activeView}"]`);
        if (activeItem) {
          activeItem.classList.add('active');
        }
      }

      // ✅ SOLUCIÓN: Inicialización correcta
      window.addEventListener('DOMContentLoaded', () => {
        // Verificar si hay una vista en la URL
        const hash = window.location.hash.substring(1);
        const initialView = hash || 'live-monitoring-2';
        
        // Navegar a la vista inicial
        navigateTo(initialView);
        
        // Debug: verificar estado inicial
        console.log('DOMContentLoaded - Initial view:', initialView);
        setTimeout(() => {
          debugViews();
        }, 100);
      });

      // ✅ SOLUCIÓN: Manejar navegación del navegador
      window.addEventListener('popstate', (event) => {
        const hash = window.location.hash.substring(1);
        const view = hash || 'live-monitoring-2';
        navigateTo(view);
      });

      // ✅ DEBUGGING: Función para verificar estado
      function debugViews() {
        console.log('Current view:', currentView);
        console.log('Visible views:', 
          Array.from(document.querySelectorAll('.view')).map(v => ({
            id: v.id,
            hidden: v.classList.contains('hidden')
          }))
        );
        
        // Verificar si hay algún modal abierto que pueda estar interfiriendo
        const openModals = document.querySelectorAll('.modal-backdrop:not(.hidden)');
        console.log('Open modals:', openModals.length);
        
        // Verificar el estado del sidebar
        const sidebar = document.querySelector('.sidebar');
        if (sidebar) {
          console.log('Sidebar collapsed:', sidebar.classList.contains('collapsed'));
        }
      }

      // Función de prueba para forzar la navegación
      function forceNavigateTo(viewName) {
        console.log('Force navigating to:', viewName);
        
        // Ocultar TODAS las vistas primero
        document.querySelectorAll('.view').forEach(view => {
          view.classList.add('hidden');
          console.log('Hiding view:', view.id);
        });
        
        // Mostrar solo la vista seleccionada
        const targetView = document.getElementById(viewName + '-view');
        if (targetView) {
          targetView.classList.remove('hidden');
          console.log('Showing view:', targetView.id);
          
          // Debug visual: verificar estilos computados
          const computedStyle = window.getComputedStyle(targetView);
          console.log('Computed styles for', targetView.id, ':', {
            display: computedStyle.display,
            opacity: computedStyle.opacity,
            visibility: computedStyle.visibility,
            zIndex: computedStyle.zIndex,
            position: computedStyle.position
          });
          
          // Forzar visibilidad con estilos inline
          targetView.style.display = 'block';
          targetView.style.opacity = '1';
          targetView.style.visibility = 'visible';
          targetView.style.zIndex = '10';
        } else {
          console.error('Target view not found:', viewName + '-view');
        }
        
        // Actualizar estado
        currentView = viewName;
        console.log('Current view updated to:', currentView);
      }

      // Nuevo código para el sidebar expandible
      function toggleSidebar() {
        const sidebar = document.querySelector('.sidebar');
        const body = document.querySelector('body');
        
        sidebar.classList.toggle('collapsed');
        body.classList.toggle('sidebar-colapsado');

        // --- SOLUCIÓN PARA REDIMENSIONAMIENTO DEL MAPA AL CAMBIAR SIDEBAR ---
        setTimeout(() => {
          if (currentView === 'live-monitoring' && window.map) {
            window.map.resize();
          }
          if (currentView === 'live-monitoring-2' && window.map3Instance) {
            window.map3Instance.resize();
          }
        }, 500); // Coincide con la duración de la transición del CSS
      }

      // Función para contraer el sidebar automáticamente
      function collapseSidebar() {
        console.log('╔═══════════════════════════════════════════════════════╗');
        console.log('║  🔽 collapseSidebar() INICIADA                        ║');
        console.log('╚═══════════════════════════════════════════════════════╝');
        console.log('   → Timestamp:', new Date().toISOString());
        
        const sidebar = document.querySelector('.sidebar');
        const body = document.querySelector('body');
        
        console.log('📌 [SIDEBAR] Encontrado:', sidebar ? 'SÍ' : 'NO');
        console.log('📌 [BODY] Encontrado:', body ? 'SÍ' : 'NO');
        
        if (sidebar) {
          const yaEstabaColapsado = sidebar.classList.contains('collapsed');
          console.log('   → ¿Ya estaba collapsed?', yaEstabaColapsado);
          
          if (!yaEstabaColapsado) {
            console.log('   → Agregando clase "collapsed" al sidebar');
            sidebar.classList.add('collapsed');
            
            console.log('   → Agregando clase "sidebar-colapsado" al body');
            body.classList.add('sidebar-colapsado');
            
            // Verificar el currentView
            console.log('🗺️  [MAPA] currentView:', currentView);
            console.log('   → ¿Es live-monitoring-2?', currentView === 'live-monitoring-2');
            console.log('   → ¿Existe map3Instance?', window.map3Instance ? 'SÍ' : 'NO');
            
            // Redimensionar el mapa después de la transición
            console.log('⏱️  [TIMER] Programando resize del mapa en 500ms');
            setTimeout(() => {
              console.log('╔═══════════════════════════════════════════════════════╗');
              console.log('║  🗺️  EJECUTANDO RESIZE DEL MAPA (después de 500ms)   ║');
              console.log('╚═══════════════════════════════════════════════════════╝');
              console.log('   → Timestamp:', new Date().toISOString());
              
              if (currentView === 'live-monitoring' && window.map) {
                console.log('   → Llamando a map.resize()');
                window.map.resize();
                console.log('   → Resize completado');
              }
              if (currentView === 'live-monitoring-2' && window.map3Instance) {
                console.log('   → Llamando a map3Instance.resize()');
                window.map3Instance.resize();
                console.log('   → Resize completado');
              }
            }, 500);
          } else {
            console.log('   → Sidebar ya estaba collapsed, no se hace nada');
          }
        }
        
        console.log('🏁 [FIN] collapseSidebar() completada');
      }

      // Funciones para el modal del mapa
      function openMapModal() {
        const modal = document.getElementById('mapModal');
        if (modal) {
          modal.classList.remove('hidden');
          modal.classList.add('flex');
          // Prevenir scroll del body cuando el modal está abierto
          document.body.style.overflow = 'hidden';
          // Contraer el sidebar automáticamente
          collapseSidebar();
        }
      }

      function closeMapModal() {
        const modal = document.getElementById('mapModal');
        if (modal) {
          modal.classList.add('hidden');
          modal.classList.remove('flex');
          // Restaurar scroll del body
          document.body.style.overflow = 'auto';
        }
      }

      // Funciones para el modal de Energy Status
      function openEnergyStatusModal() {
        console.log('⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡');
        console.log('⚡ openEnergyStatusModal() LLAMADA');
        console.log('⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡');
        console.log('   → Timestamp:', new Date().toISOString());
        
        const modal = document.getElementById('energyStatusModal');
        console.log('📦 [MODAL] Elemento encontrado:', modal ? 'SÍ' : 'NO');
        
        if (modal) {
          // Verificar clases ANTES de modificar
          console.log('📋 [MODAL] Clases ANTES:', modal.className);
          console.log('   → ¿Está hidden?', modal.classList.contains('hidden'));
          console.log('   → ¿Está flex?', modal.classList.contains('flex'));
          
          modal.classList.remove('hidden');
          modal.classList.add('flex');
          
          // Verificar clases DESPUÉS de modificar
          console.log('📋 [MODAL] Clases DESPUÉS:', modal.className);
          console.log('   → ¿Está hidden?', modal.classList.contains('hidden'));
          console.log('   → ¿Está flex?', modal.classList.contains('flex'));
          
          // Prevenir scroll del body cuando el modal está abierto
          document.body.style.overflow = 'hidden';
          console.log('🚫 [BODY] Scroll bloqueado');
          
          // Contraer el sidebar automáticamente
          console.log('🔽 [ACCION] Llamando a collapseSidebar()');
          collapseSidebar();
          
          // Ejecutar la animación de contador solo cuando se abre el modal
          console.log('⏱️  [TIMER] Programando updateEnergySummary en 100ms');
          setTimeout(() => {
            console.log('✅ [EJECUTANDO] updateEnergySummary(true)');
            updateEnergySummary(true); // true = con animación
          }, 100); // Pequeño delay para asegurar que el modal esté visible
        }
        
        console.log('🏁 [FIN] openEnergyStatusModal completada');
        console.log('⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡⚡');
      }

      function closeEnergyStatusModal() {
        const modal = document.getElementById('energyStatusModal');
        if (modal) {
          modal.classList.add('hidden');
          modal.classList.remove('flex');
          // Restaurar scroll del body
          document.body.style.overflow = 'auto';
        }
      }

      // Funciones para el modal de Vehicle List
     //--------------------------------------------------------------------------------------------

     function openVehicleStatusModal(vehicleIndex = null) {
      const modal = document.getElementById('vehicleListModal');
       if (!modal) return;
  
      modal.classList.remove('hidden');
      modal.classList.add('flex');
      document.body.style.overflow = 'hidden';
  
  // Inicializar después de 100ms
  setTimeout(() => {
    if (vehicleIndex !== null) {
      initializeVehicleSliderWithVehicle(vehicleIndex);
    } else {
      initializeVehicleSlider();
    }
  }, 100);
  
  collapseSidebar();
}

//      function openVehicleStatusModal(vehicleIndex = null) {
//       console.log('═══════════════════════════════════════════════════════');
//       console.log('🚀 [INICIO] openVehicleStatusModal llamada');
//       console.log('   → vehicleIndex:', vehicleIndex);
  
//       const modal = document.getElementById('vehicleListModal');
//       console.log('📦 [MODAL] Elemento encontrado:', modal ? 'SÍ' : 'NO');
  
//       if (!modal) {
//       console.log('❌ [ERROR] Modal no encontrado');
//       return;
//      }
  
//       console.log('📋 [MODAL] Clases ANTES:', modal.className);
  
//   // Paso 1: Remover hidden y agregar flex
//       modal.classList.remove('hidden');
//       modal.classList.add('flex');
//       console.log('✅ [PASO 1] Clases modificadas');
  
//   // Paso 2: Forzar opacidad inicial a 0 CON !important
//      modal.style.setProperty('opacity', '0', 'important');
//      modal.style.setProperty('transform', 'scale(0.95)', 'important');
//       console.log('✅ [PASO 2] Opacidad inicial a 0 con !important');
  
//   // Paso 3: Esperar un frame
//     console.log('⏳ [PASO 3] Esperando requestAnimationFrame...');
//     requestAnimationFrame(() => {
//     console.log('🎬 [FRAME] requestAnimationFrame ejecutado');
    
//     // Paso 4: Animar a opacidad 1 CON !important
//     modal.style.setProperty('transition', 'opacity 0.3s ease-out, transform 0.3s ease-out', 'important');
//     modal.style.setProperty('opacity', '1', 'important');
//     modal.style.setProperty('transform', 'scale(1)', 'important');
    
//     console.log('✅ [PASO 4] Animación iniciada con !important');
//     console.log('   → modal.style.opacity:', modal.style.opacity);
//     console.log('   → modal.style.transform:', modal.style.transform);
    
//     // Verificar después de la animación
//     setTimeout(() => {
//       const computedStyles = window.getComputedStyle(modal);
//       console.log('🎨 [VERIFICACIÓN] Estilos después de 350ms:');
//       console.log('   → opacity computada:', computedStyles.opacity);
//       console.log('   → display computado:', computedStyles.display);
//       console.log('   → transform computado:', computedStyles.transform);
//       console.log('   → visibility computada:', computedStyles.visibility);
//       console.log('   → z-index computado:', computedStyles.zIndex);
      
//       // Verificar si el modal es visible en el viewport
//       const rect = modal.getBoundingClientRect();
//       console.log('🎨 [VERIFICACIÓN] Posición del modal:');
//       console.log('   → top:', rect.top);
//       console.log('   → left:', rect.left);
//       console.log('   → width:', rect.width);
//       console.log('   → height:', rect.height);
      
//       // Verificar si hay contenido dentro del modal
//       const modalContent = modal.querySelector('.modal-content');
//       console.log('🎨 [VERIFICACIÓN] Contenido del modal:');
//       console.log('   → modal-content encontrado:', modalContent ? 'SÍ' : 'NO');
//       if (modalContent) {
//         const contentRect = modalContent.getBoundingClientRect();
//         console.log('   → contenido width:', contentRect.width);
//         console.log('   → contenido height:', contentRect.height);
//       }
//     }, 350);
//   });
  
//   document.body.style.overflow = 'hidden';
//   console.log('🚫 [BODY] Scroll bloqueado');
  
//   // Ocultar slides
//   console.log('🎬 [SLIDES] Ocultando slides...');
//   for (let i = 1; i <= 4; i++) {
//     const slide = document.getElementById(`vehicle-00${i}`);
//     if (slide) {
//       slide.classList.remove('active', 'prev', 'next');
//       slide.classList.add('hidden');
//     }
//   }
  
//   const pruebaSlide = document.getElementById('vehicle-prueba');
//   if (pruebaSlide) {
//     pruebaSlide.classList.remove('active', 'prev', 'next');
//     pruebaSlide.classList.add('hidden');
//   }
  
//   const generalSlide = document.getElementById('vehicle-general');
//   if (generalSlide) {
//     generalSlide.classList.remove('active', 'prev', 'next');
//     generalSlide.classList.add('hidden');
//   }
  
//   // Inicializar slider
//   if (vehicleIndex !== null) {
//     console.log('⏱️  [TIMER] Programando initializeVehicleSliderWithVehicle');
//     setTimeout(() => {
//       console.log('✅ [EJECUTANDO] initializeVehicleSliderWithVehicle');
//       initializeVehicleSliderWithVehicle(vehicleIndex);
//     }, 50);
//   } else {
//     console.log('⏱️  [TIMER] Programando initializeVehicleSlider');
//     setTimeout(() => {
//       console.log('✅ [EJECUTANDO] initializeVehicleSlider');
//       initializeVehicleSlider();
//     }, 50);
//   }
  
//   console.log('🔽 [ACCIÓN] Llamando a collapseSidebar()');
//   collapseSidebar();
  
//   console.log('🏁 [FIN] openVehicleStatusModal completada');
//   console.log('═══════════════════════════════════════════════════════');
// }

     //----------------------------------------------------------------------------------------------------
     


      function closeVehicleListModal() {
        const modal = document.getElementById('vehicleListModal');
        if (modal) {
          console.log('🔒 [CLOSE] Cerrando modal de vehículos');
          
          // Animar a opacity 0
          modal.style.transition = 'opacity 0.3s ease-out, transform 0.3s ease-out';
          modal.style.opacity = '0';
          modal.style.transform = 'scale(0.95)';
          
          // Después de la animación, ocultar completamente
          setTimeout(() => {
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            // Limpiar estilos inline
            modal.style.opacity = '';
            modal.style.transform = '';
            modal.style.transition = '';
            console.log('✅ [CLOSE] Modal ocultado completamente');
          }, 300);
          
          // Restaurar scroll
          document.body.style.overflow = '';
        }
      }

      // Variables para el slider de vehículos
      let currentVehicleIndex = 0;
      const totalVehicles = 4;
      const vehicleNames = [ 'General', 'Zetrabot 1', 'Zetrabot 2', 'Battery Station'];

      // Función para mostrar un vehículo específico con transiciones suaves
      function showVehicle(index) {
        console.log('🎬 [SHOW] showVehicle llamada con índice:', index);
        // Ocultar todos los slides con transición suave
        for (let i = 1; i <= 4; i++) {
          const slide = document.getElementById(`vehicle-00${i}`);
          if (slide) {
            slide.classList.remove('active', 'prev', 'next');
            slide.classList.add('hidden');
          }
        }
        
        // Ocultar el slide de prueba
        const pruebaSlide = document.getElementById('vehicle-prueba');
        if (pruebaSlide) {
          pruebaSlide.classList.remove('active', 'prev', 'next');
          pruebaSlide.classList.add('hidden');
        }
        
        // Ocultar el slide general
        const generalSlide = document.getElementById('vehicle-general');
        console.log('🎬 [SHOW] Slide general encontrado:', generalSlide ? 'SÍ' : 'NO');
        if (generalSlide) {
          console.log('🎬 [SHOW] Clases ANTES de ocultar:', generalSlide.className);
          generalSlide.classList.remove('active', 'prev', 'next');
          generalSlide.classList.add('hidden');
          console.log('🎬 [SHOW] Clases DESPUÉS de ocultar:', generalSlide.className);
        }

        // Transición inmediata para evitar flash
        setTimeout(() => {
          // Mostrar el slide actual
          let currentSlide;
          if (index === 0) {
            // Slide General (índice 0)
            currentSlide = document.getElementById('vehicle-general');
          } else {
            // Slides de vehículos normales (índices 1-4)
            currentSlide = document.getElementById(`vehicle-00${index}`);
          }
          
          if (currentSlide) {
            console.log('🎬 [SHOW] Slide actual encontrado:', currentSlide.id);
            console.log('🎬 [SHOW] Clases ANTES de mostrar:', currentSlide.className);
            currentSlide.classList.remove('hidden', 'prev', 'next');
            currentSlide.classList.add('active');
            console.log('🎬 [SHOW] Clases DESPUÉS de mostrar:', currentSlide.className);
          } else {
            console.log('🎬 [SHOW] ERROR: No se encontró el slide actual');
          }

          // Actualizar el contador con transición suave
          const counter = document.getElementById('vehicleCounter');
          if (counter) {
            counter.style.transition = 'all 0.5s ease';
            counter.textContent = vehicleNames[index];
          }

          // Actualizar el título del modal dinámicamente
          const modalTitle = document.getElementById('vehicleModalTitle');
          if (modalTitle) {
            modalTitle.style.transition = 'all 0.5s ease';
            if (index === 0) {
              modalTitle.textContent = 'General';
            } else if (index === 5) {
              modalTitle.textContent = 'Prueba';
            } else {
              modalTitle.textContent = `${vehicleNames[index]}`;
            }
          }

          // Actualizar estado de los botones
          updateNavigationButtons();
          
          // Actualizar indicadores de slide
          updateSlideIndicators();
          
          // Ajustar la altura del contenedor al slide activo
          adjustContainerHeight(currentSlide);
          
          // Animar las barras de progreso después de que el slide se muestre
          setTimeout(() => {
            const progressBars = currentSlide.querySelectorAll('.progress-bar-animate');
            progressBars.forEach((bar, barIndex) => {
              // Resetear la animación
              bar.style.animation = 'none';
              bar.offsetHeight; // Trigger reflow
              // Aplicar la animación con delay escalonado
              bar.style.animation = `progressBarSlideIn 1.2s ease-out ${0.5 + (barIndex * 0.1)}s both`;
            });
            
            // Animar el círculo de progreso si existe
            const progressCircle = currentSlide.querySelector('.progress-circle-animate');
            if (progressCircle) {
              progressCircle.style.animation = 'none';
              progressCircle.offsetHeight; // Trigger reflow
              progressCircle.style.animation = 'progressCircleDraw 2s ease-out 1s both';
            }
          }, 200);
        }, 25); // Reducido de 100ms a 25ms para respuesta más inmediata
      }

      // Función para ajustar la altura del contenedor al slide activo
      function adjustContainerHeight(activeSlide) {
        if (activeSlide) {
          const container = document.querySelector('.vehicle-slider-container');
          if (container) {
            // Obtener la altura del slide activo
            const slideHeight = activeSlide.scrollHeight;
            // Ajustar la altura del contenedor con una transición suave
            container.style.transition = 'height 0.3s ease';
            container.style.height = slideHeight + 'px';
          }
        }
      }

      // Función para ir al siguiente vehículo
      function nextVehicle() {
        currentVehicleIndex = (currentVehicleIndex + 1) % totalVehicles;
        showVehicle(currentVehicleIndex);
      }

      // Función para ir al vehículo anterior
      function previousVehicle() {
        currentVehicleIndex = (currentVehicleIndex - 1 + totalVehicles) % totalVehicles;
        showVehicle(currentVehicleIndex);
      }

      // Función para actualizar el estado de los botones de navegación
      function updateNavigationButtons() {
        const prevBtn = document.getElementById('prevVehicleBtn');
        const nextBtn = document.getElementById('nextVehicleBtn');
        
        if (prevBtn && nextBtn) {
          // Los botones siempre están habilitados para navegación circular
          prevBtn.disabled = false;
          nextBtn.disabled = false;
        }
      }

      // Función para inicializar el slider cuando se abre el modal
      function initializeVehicleSlider() {
        console.log('🎬 [INIT] initializeVehicleSlider iniciada');
        currentVehicleIndex = 0;
        showVehicle(0);
        updateSlideIndicators();
        
        // Asegurar que el slide general esté visible inicialmente
        const generalSlide = document.getElementById('vehicle-general');
        console.log('🎬 [INIT] Slide general encontrado:', generalSlide ? 'SÍ' : 'NO');
        if (generalSlide) {
          console.log('🎬 [INIT] Clases ANTES:', generalSlide.className);
          generalSlide.classList.remove('hidden');
          generalSlide.classList.add('active');
          console.log('🎬 [INIT] Clases DESPUÉS:', generalSlide.className);
        }
        
        // Ajustar altura inicial después de un pequeño delay
        setTimeout(() => {
          const activeSlide = document.querySelector('.vehicle-slide.active');
          if (activeSlide) {
            adjustContainerHeight(activeSlide);
            
            // Animar las barras de progreso en la inicialización
            setTimeout(() => {
              const progressBars = activeSlide.querySelectorAll('.progress-bar-animate');
              progressBars.forEach((bar, barIndex) => {
                // Resetear la animación
                bar.style.animation = 'none';
                bar.offsetHeight; // Trigger reflow
                // Aplicar la animación con delay escalonado
                bar.style.animation = `progressBarSlideIn 1.2s ease-out ${0.5 + (barIndex * 0.1)}s both`;
              });
              
              // Animar el círculo de progreso si existe
              const progressCircle = activeSlide.querySelector('.progress-circle-animate');
              if (progressCircle) {
                progressCircle.style.animation = 'none';
                progressCircle.offsetHeight; // Trigger reflow
                progressCircle.style.animation = 'progressCircleDraw 2s ease-out 1.2s both';
              }
            }, 300);
          }
        }, 200);
        
        // Inicializar el slider interactivo del threshold
        initializeThresholdSlider();
        initializeThresholdSlider2();
        initializeThresholdSlider3();

         // AGREGAR ESTO AL FINAL:
         console.log('🔍 VERIFICACIÓN FINAL initializeVehicleSlider:');
         console.log('   generalSlide.classList:', generalSlide ? generalSlide.className : 'NO ENCONTRADO');
         console.log('   generalSlide height:', generalSlide ? window.getComputedStyle(generalSlide).height : 'N/A');

      }

      // Función para inicializar el slider directamente con un vehículo específico
      function initializeVehicleSliderWithVehicle(vehicleIndex) {
        currentVehicleIndex = vehicleIndex;
        
        // Ocultar todos los slides primero
        for (let i = 1; i <= 4; i++) {
          const slide = document.getElementById(`vehicle-00${i}`);
          if (slide) {
            slide.classList.remove('active', 'prev', 'next');
            slide.classList.add('hidden');
          }
        }
        
        // Ocultar el slide de prueba
        const pruebaSlide = document.getElementById('vehicle-prueba');
        if (pruebaSlide) {
          pruebaSlide.classList.remove('active', 'prev', 'next');
          pruebaSlide.classList.add('hidden');
        }
        
        // Ocultar el slide general
        const generalSlide = document.getElementById('vehicle-general');
        if (generalSlide) {
          generalSlide.classList.remove('active', 'prev', 'next');
          generalSlide.classList.add('hidden');
        }
        
        // Mostrar directamente el vehículo especificado
        showVehicle(vehicleIndex);
        updateSlideIndicators();
        
        // Ajustar altura inicial después de un pequeño delay
        setTimeout(() => {
          const activeSlide = document.querySelector('.vehicle-slide.active');
          if (activeSlide) {
            adjustContainerHeight(activeSlide);
            
            // Animar las barras de progreso en la inicialización
            setTimeout(() => {
              const progressBars = activeSlide.querySelectorAll('.progress-bar-animate');
              progressBars.forEach((bar, barIndex) => {
                // Resetear la animación
                bar.style.animation = 'none';
                bar.offsetHeight; // Trigger reflow
                // Aplicar la animación con delay escalonado
                bar.style.animation = `progressBarSlideIn 1.2s ease-out ${0.5 + (barIndex * 0.1)}s both`;
              });
              
              // Animar el círculo de progreso si existe
              const progressCircle = activeSlide.querySelector('.progress-circle-animate');
              if (progressCircle) {
                progressCircle.style.animation = 'none';
                progressCircle.offsetHeight; // Trigger reflow
                progressCircle.style.animation = 'progressCircleDraw 2s ease-out 1.2s both';
              }
            }, 300);
          }
        }, 200);
        
        // Inicializar el slider interactivo del threshold
        initializeThresholdSlider();
        initializeThresholdSlider2();
        initializeThresholdSlider3();
      }

      // Función para inicializar el slider interactivo del threshold
      function initializeThresholdSlider() {
        const thresholdHandle = document.getElementById('threshold-handle');
        const thresholdValue = document.getElementById('threshold-value');
        const thresholdSlider = document.querySelector('.threshold-slider');
        const thresholdBar = thresholdSlider?.querySelector('.bg-\\[var\\(--turqueza\\)\\]');
        
        if (!thresholdHandle || !thresholdValue || !thresholdBar || !thresholdSlider) {
          console.log('Elementos del threshold slider no encontrados');
          return;
        }
        
        let isDragging = false;
        let currentPercentage = 20;
        
        console.log('Threshold slider inicializado');
        
        // Función para actualizar el valor del threshold
        function updateThresholdValue(percentage) {
          const clampedPercentage = Math.max(5, Math.min(95, percentage));
          currentPercentage = clampedPercentage;
          
          thresholdValue.textContent = Math.round(clampedPercentage) + '%';
          thresholdBar.style.width = clampedPercentage + '%';
          thresholdHandle.style.left = clampedPercentage + '%';
          
          // Guardar el valor en localStorage para persistencia
          localStorage.setItem('batteryThreshold', clampedPercentage);
          
          console.log('Threshold actualizado a:', clampedPercentage + '%');
        }
        
        // Función para obtener el porcentaje basado en la posición X
        function getPercentageFromX(clientX) {
          const rect = thresholdSlider.getBoundingClientRect();
          const x = clientX - rect.left;
          const percentage = (x / rect.width) * 100;
          return percentage;
        }
        
        // Eventos del mouse
        thresholdHandle.addEventListener('mousedown', (e) => {
          isDragging = true;
          thresholdSlider.classList.add('dragging');
          document.body.style.userSelect = 'none';
          document.body.style.cursor = 'grabbing';
          
          console.log('Inicio de arrastre');
          e.preventDefault();
          e.stopPropagation();
        });
        
        // Evento en el contenedor para permitir clic directo
        thresholdSlider.addEventListener('mousedown', (e) => {
          if (e.target === thresholdHandle) return;
          
          const percentage = getPercentageFromX(e.clientX);
          updateThresholdValue(percentage);
          
          // Simular arrastre desde esta posición
          isDragging = true;
          thresholdSlider.classList.add('dragging');
          document.body.style.userSelect = 'none';
          document.body.style.cursor = 'grabbing';
        });
        
        document.addEventListener('mousemove', (e) => {
          if (!isDragging) return;
          
          const percentage = getPercentageFromX(e.clientX);
          updateThresholdValue(percentage);
          
          e.preventDefault();
        });
        
        document.addEventListener('mouseup', (e) => {
          if (isDragging) {
            isDragging = false;
            thresholdSlider.classList.remove('dragging');
            document.body.style.userSelect = '';
            document.body.style.cursor = '';
            
            console.log('Fin de arrastre');
          }
        });
        
        // Eventos táctiles para dispositivos móviles
        thresholdHandle.addEventListener('touchstart', (e) => {
          isDragging = true;
          thresholdSlider.classList.add('dragging');
          
          console.log('Inicio de touch');
          e.preventDefault();
        });
        
        thresholdSlider.addEventListener('touchstart', (e) => {
          if (e.target === thresholdHandle) return;
          
          const touch = e.touches[0];
          const percentage = getPercentageFromX(touch.clientX);
          updateThresholdValue(percentage);
          
          isDragging = true;
          thresholdSlider.classList.add('dragging');
        });
        
        document.addEventListener('touchmove', (e) => {
          if (!isDragging) return;
          
          const touch = e.touches[0];
          const percentage = getPercentageFromX(touch.clientX);
          updateThresholdValue(percentage);
          
          e.preventDefault();
        });
        
        document.addEventListener('touchend', (e) => {
          if (isDragging) {
            isDragging = false;
            thresholdSlider.classList.remove('dragging');
            
            console.log('Fin de touch');
          }
        });
        
        // Cargar valor guardado o usar el valor por defecto
        const savedThreshold = localStorage.getItem('batteryThreshold');
        if (savedThreshold) {
          updateThresholdValue(parseFloat(savedThreshold));
        } else {
          updateThresholdValue(20); // Valor por defecto
        }
        
        // Agregar indicador visual de que es arrastrable
        thresholdHandle.title = 'Arrastra para cambiar el umbral crítico';
        thresholdHandle.style.cursor = 'grab';
      }

      // Función para inicializar el slider interactivo del threshold para Zetrabot 2
      function initializeThresholdSlider2() {
        const thresholdHandle = document.getElementById('threshold-handle-2');
        const thresholdValue = document.getElementById('threshold-value-2');
        const thresholdSlider = document.querySelectorAll('.threshold-slider')[1]; // Segundo slider
        const thresholdBar = thresholdSlider?.querySelector('.bg-\\[var\\(--turqueza\\)\\]');
        
        if (!thresholdHandle || !thresholdValue || !thresholdBar || !thresholdSlider) {
          console.log('Elementos del threshold slider 2 no encontrados');
          return;
        }
        
        let isDragging = false;
        let currentPercentage = 20;
        
        console.log('Threshold slider 2 inicializado');
        
        // Función para actualizar el valor del threshold
        function updateThresholdValue(percentage) {
          const clampedPercentage = Math.max(5, Math.min(95, percentage));
          currentPercentage = clampedPercentage;
          
          thresholdValue.textContent = Math.round(clampedPercentage) + '%';
          thresholdBar.style.width = clampedPercentage + '%';
          thresholdHandle.style.left = clampedPercentage + '%';
          
          // Guardar el valor en localStorage para persistencia
          localStorage.setItem('batteryThreshold2', clampedPercentage);
          
          console.log('Threshold 2 actualizado a:', clampedPercentage + '%');
        }
        
        // Función para obtener el porcentaje basado en la posición X
        function getPercentageFromX(clientX) {
          const rect = thresholdSlider.getBoundingClientRect();
          const x = clientX - rect.left;
          const percentage = (x / rect.width) * 100;
          return percentage;
        }
        
        // Eventos del mouse
        thresholdHandle.addEventListener('mousedown', (e) => {
          isDragging = true;
          thresholdSlider.classList.add('dragging');
          document.body.style.userSelect = 'none';
          document.body.style.cursor = 'grabbing';
          
          console.log('Inicio de arrastre slider 2');
          e.preventDefault();
          e.stopPropagation();
        });
        
        // Evento en el contenedor para permitir clic directo
        thresholdSlider.addEventListener('mousedown', (e) => {
          if (e.target === thresholdHandle) return;
          
          const percentage = getPercentageFromX(e.clientX);
          updateThresholdValue(percentage);
          
          // Simular arrastre desde esta posición
          isDragging = true;
          thresholdSlider.classList.add('dragging');
          document.body.style.userSelect = 'none';
          document.body.style.cursor = 'grabbing';
        });
        
        document.addEventListener('mousemove', (e) => {
          if (!isDragging) return;
          
          const percentage = getPercentageFromX(e.clientX);
          updateThresholdValue(percentage);
          
          e.preventDefault();
        });
        
        document.addEventListener('mouseup', (e) => {
          if (isDragging) {
            isDragging = false;
            thresholdSlider.classList.remove('dragging');
            document.body.style.userSelect = '';
            document.body.style.cursor = '';
            
            console.log('Fin de arrastre slider 2');
          }
        });
        
        // Eventos táctiles para dispositivos móviles
        thresholdHandle.addEventListener('touchstart', (e) => {
          isDragging = true;
          thresholdSlider.classList.add('dragging');
          
          console.log('Inicio de touch slider 2');
          e.preventDefault();
        });
        
        thresholdSlider.addEventListener('touchstart', (e) => {
          if (e.target === thresholdHandle) return;
          
          const touch = e.touches[0];
          const percentage = getPercentageFromX(touch.clientX);
          updateThresholdValue(percentage);
          
          isDragging = true;
          thresholdSlider.classList.add('dragging');
        });
        
        document.addEventListener('touchmove', (e) => {
          if (!isDragging) return;
          
          const touch = e.touches[0];
          const percentage = getPercentageFromX(touch.clientX);
          updateThresholdValue(percentage);
          
          e.preventDefault();
        });
        
        document.addEventListener('touchend', (e) => {
          if (isDragging) {
            isDragging = false;
            thresholdSlider.classList.remove('dragging');
            
            console.log('Fin de touch slider 2');
          }
        });
        
        // Cargar valor guardado o usar el valor por defecto
        const savedThreshold = localStorage.getItem('batteryThreshold2');
        if (savedThreshold) {
          updateThresholdValue(parseFloat(savedThreshold));
        } else {
          updateThresholdValue(20); // Valor por defecto
        }
        
        // Agregar indicador visual de que es arrastrable
        thresholdHandle.title = 'Arrastra para cambiar el umbral crítico';
        thresholdHandle.style.cursor = 'grab';
      }

      // Función para inicializar el slider interactivo del threshold para Zetrabot 3
      function initializeThresholdSlider3() {
        const thresholdHandle = document.getElementById('threshold-handle-3');
        const thresholdValue = document.getElementById('threshold-value-3');
        const thresholdSlider = document.querySelectorAll('.threshold-slider')[2]; // Tercer slider
        const thresholdBar = thresholdSlider?.querySelector('.bg-\\[var\\(--turqueza\\)\\]');
        
        if (!thresholdHandle || !thresholdValue || !thresholdBar || !thresholdSlider) {
          console.log('Elementos del threshold slider 3 no encontrados');
          return;
        }
        
        let isDragging = false;
        let currentPercentage = 20;
        
        console.log('Threshold slider 3 inicializado');
        
        // Función para actualizar el valor del threshold
        function updateThresholdValue(percentage) {
          const clampedPercentage = Math.max(5, Math.min(95, percentage));
          currentPercentage = clampedPercentage;
          
          thresholdValue.textContent = Math.round(clampedPercentage) + '%';
          thresholdBar.style.width = clampedPercentage + '%';
          thresholdHandle.style.left = clampedPercentage + '%';
          
          // Guardar el valor en localStorage para persistencia
          localStorage.setItem('batteryThreshold3', clampedPercentage);
          
          console.log('Threshold 3 actualizado a:', clampedPercentage + '%');
        }
        
        // Función para obtener el porcentaje basado en la posición X
        function getPercentageFromX(clientX) {
          const rect = thresholdSlider.getBoundingClientRect();
          const x = clientX - rect.left;
          const percentage = (x / rect.width) * 100;
          return percentage;
        }
        
        // Eventos del mouse
        thresholdHandle.addEventListener('mousedown', (e) => {
          isDragging = true;
          thresholdSlider.classList.add('dragging');
          document.body.style.userSelect = 'none';
          document.body.style.cursor = 'grabbing';
          
          console.log('Inicio de arrastre slider 3');
          e.preventDefault();
          e.stopPropagation();
        });
        
        // Evento en el contenedor para permitir clic directo
        thresholdSlider.addEventListener('mousedown', (e) => {
          if (e.target === thresholdHandle) return;
          
          const percentage = getPercentageFromX(e.clientX);
          updateThresholdValue(percentage);
          
          // Simular arrastre desde esta posición
          isDragging = true;
          thresholdSlider.classList.add('dragging');
          document.body.style.userSelect = 'none';
          document.body.style.cursor = 'grabbing';
        });
        
        document.addEventListener('mousemove', (e) => {
          if (!isDragging) return;
          
          const percentage = getPercentageFromX(e.clientX);
          updateThresholdValue(percentage);
          
          e.preventDefault();
        });
        
        document.addEventListener('mouseup', (e) => {
          if (isDragging) {
            isDragging = false;
            thresholdSlider.classList.remove('dragging');
            document.body.style.userSelect = '';
            document.body.style.cursor = '';
            
            console.log('Fin de arrastre slider 3');
          }
        });
        
        // Eventos táctiles para dispositivos móviles
        thresholdHandle.addEventListener('touchstart', (e) => {
          isDragging = true;
          thresholdSlider.classList.add('dragging');
          
          console.log('Inicio de touch slider 3');
          e.preventDefault();
        });
        
        thresholdSlider.addEventListener('touchstart', (e) => {
          if (e.target === thresholdHandle) return;
          
          const touch = e.touches[0];
          const percentage = getPercentageFromX(touch.clientX);
          updateThresholdValue(percentage);
          
          isDragging = true;
          thresholdSlider.classList.add('dragging');
        });
        
        document.addEventListener('touchmove', (e) => {
          if (!isDragging) return;
          
          const touch = e.touches[0];
          const percentage = getPercentageFromX(touch.clientX);
          updateThresholdValue(percentage);
          
          e.preventDefault();
        });
        
        document.addEventListener('touchend', (e) => {
          if (isDragging) {
            isDragging = false;
            thresholdSlider.classList.remove('dragging');
            
            console.log('Fin de touch slider 3');
          }
        });
        
        // Cargar valor guardado o usar el valor por defecto
        const savedThreshold = localStorage.getItem('batteryThreshold3');
        if (savedThreshold) {
          updateThresholdValue(parseFloat(savedThreshold));
        } else {
          updateThresholdValue(20); // Valor por defecto
        }
        
        // Agregar indicador visual de que es arrastrable
        thresholdHandle.title = 'Arrastra para cambiar el umbral crítico';
        thresholdHandle.style.cursor = 'grab';
      }

      // Función para ir a un slide específico
      function goToSlide(index) {
        currentVehicleIndex = index;
        showVehicle(index);
        updateSlideIndicators();
      }

      // Función para actualizar los indicadores de slide
      function updateSlideIndicators() {
        const indicators = document.querySelectorAll('.slide-indicator');
        indicators.forEach((indicator, index) => {
          if (index === currentVehicleIndex) {
            indicator.classList.add('active');
          } else {
            indicator.classList.remove('active');
          }
        });
      }

      // Función para diagnosticar por qué las vistas no son visibles
      function diagnoseViewVisibility() {
        const currentViewElement = document.getElementById(currentView + '-view');
        if (!currentViewElement) {
          console.error('Current view element not found:', currentView + '-view');
          return;
        }

        console.log('=== DIAGNÓSTICO DE VISIBILIDAD ===');
        console.log('Elemento actual:', currentViewElement);
        
        // Verificar estilos del elemento
        const computedStyle = window.getComputedStyle(currentViewElement);
        console.log('Estilos del elemento:', {
          display: computedStyle.display,
          opacity: computedStyle.opacity,
          visibility: computedStyle.visibility,
          zIndex: computedStyle.zIndex,
          position: computedStyle.position,
          width: computedStyle.width,
          height: computedStyle.height,
          overflow: computedStyle.overflow
        });

        // Verificar estilos inline
        console.log('Estilos inline:', {
          display: currentViewElement.style.display,
          opacity: currentViewElement.style.opacity,
          visibility: currentViewElement.style.visibility
        });

        // Verificar clases CSS
        console.log('Clases CSS:', currentViewElement.className);
        console.log('Tiene clase hidden:', currentViewElement.classList.contains('hidden'));

        // Verificar contenedores padres
        let parent = currentViewElement.parentElement;
        let level = 1;
        while (parent && level <= 5) {
          const parentStyle = window.getComputedStyle(parent);
          console.log(`Contenedor padre nivel ${level}:`, {
            tag: parent.tagName,
            id: parent.id,
            class: parent.className,
            display: parentStyle.display,
            opacity: parentStyle.opacity,
            visibility: parentStyle.visibility,
            overflow: parentStyle.overflow,
            height: parentStyle.height,
            position: parentStyle.position
          });
          parent = parent.parentElement;
          level++;
        }

        // Verificar si hay algún modal interfiriendo
        const openModals = document.querySelectorAll('.modal-backdrop:not(.hidden)');
        console.log('Modales abiertos que podrían interferir:', openModals.length);
        openModals.forEach((modal, index) => {
          const modalStyle = window.getComputedStyle(modal);
          console.log(`Modal ${index}:`, {
            zIndex: modalStyle.zIndex,
            position: modalStyle.position,
            display: modalStyle.display
          });
        });
      }

      // Función para diagnosticar el problema de ancho en las vistas
      function diagnoseViewWidth() {
        console.log('=== DIAGNÓSTICO DE ANCHO DE VISTAS ===');
        
        // Verificar todas las vistas
        const views = ['battery', 'reservation', 'history'];
        views.forEach(viewName => {
          const viewElement = document.getElementById(viewName + '-view');
          if (viewElement) {
            const computedStyle = window.getComputedStyle(viewElement);
            console.log(`${viewName}-view:`, {
              width: computedStyle.width,
              maxWidth: computedStyle.maxWidth,
              minWidth: computedStyle.minWidth,
              display: computedStyle.display,
              position: computedStyle.position
            });
            
            // Verificar contenedor padre
            const parent = viewElement.parentElement;
            if (parent) {
              const parentStyle = window.getComputedStyle(parent);
              console.log(`${viewName}-view parent:`, {
                tag: parent.tagName,
                id: parent.id,
                class: parent.className,
                width: parentStyle.width,
                maxWidth: parentStyle.maxWidth,
                minWidth: parentStyle.minWidth,
                display: parentStyle.display
              });
            }
          }
        });
      }

      // Cerrar modales al hacer click fuera de ellos
      document.addEventListener('click', function(event) {
        const mapModal = document.getElementById('mapModal');
        const energyModal = document.getElementById('energyStatusModal');
        const vehicleModal = document.getElementById('vehicleListModal');
        
        if (mapModal && !mapModal.classList.contains('hidden')) {
          if (event.target === mapModal) {
            closeMapModal();
          }
        }
        
        if (energyModal && !energyModal.classList.contains('hidden')) {
          if (event.target === energyModal) {
            closeEnergyStatusModal();
          }
        }
        
        if (vehicleModal && !vehicleModal.classList.contains('hidden')) {
          if (event.target === vehicleModal) {
            closeVehicleListModal();
          }
        }
      });

      // Cerrar modales con la tecla Escape
      document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
          closeMapModal();
          closeEnergyStatusModal();
          closeVehicleListModal();
        }
      });

      // Funciones para el Work Organizer
      let lastWork = null; // Cambiamos workList por lastWork

      function calculateWorkConsumption() {
        // Obtener valores del formulario
        const workName = document.getElementById('workName').value;
        const vehicle = document.getElementById('vehicle').value;
        const paddock = document.getElementById('paddock').value;
        const tool = document.getElementById('tool').value;
        const transportFrom = document.getElementById('transportFrom').value;
        const transportTo = document.getElementById('transportTo').value;
        const estimatedHours = parseFloat(document.getElementById('estimatedHours').value);

        // Validar que todos los campos estén completos
        if (!workName || !vehicle || !paddock || !tool || !transportFrom || !transportTo || !estimatedHours) {
          showNotification('Please complete all fields', 'error');
          return;
        }

        // Validar que las horas estimadas sean válidas
        if (estimatedHours <= 0) {
          showNotification('Estimated hours must be greater than 0', 'error');
          return;
        }

        // Simular cálculos de consumo
        const transportToCost = calculateTransportCost(transportFrom, paddock);
        const transportFromCost = calculateTransportCost(paddock, transportTo);
        const effectiveWorkCostPerHour = calculateEffectiveWorkCost(tool);
        const effectiveWorkCostTotal = effectiveWorkCostPerHour * estimatedHours;
        const totalConsumption = transportToCost + transportFromCost + effectiveWorkCostTotal;

        // Mostrar resultados en el modal
        const modalTransportTo = document.getElementById('modalTransportToCost');
        const modalTransportFrom = document.getElementById('modalTransportFromCost');
        const modalPerHour = document.getElementById('modalEffectiveWorkPerHour');
        const modalTotalHours = document.getElementById('modalEffectiveWorkTotal');
        const modalTotal = document.getElementById('modalTotalConsumption');

        if (modalTransportTo) modalTransportTo.textContent = transportToCost.toFixed(2) + ' kWh';
        if (modalTransportFrom) modalTransportFrom.textContent = transportFromCost.toFixed(2) + ' kWh';
        if (modalPerHour) modalPerHour.textContent = effectiveWorkCostPerHour.toFixed(2) + ' kWh';
        if (modalTotalHours) modalTotalHours.textContent = effectiveWorkCostTotal.toFixed(2) + ' kWh';
        if (modalTotal) modalTotal.textContent = totalConsumption.toFixed(2) + ' kWh';

        openConsumptionModal();

        // Guardar solo el trabajo más reciente
        lastWork = {
          name: workName,
          vehicle: vehicle,
          paddock: paddock,
          tool: tool,
          totalConsumption: totalConsumption.toFixed(2),
          details: {
            toPaddock: transportToCost.toFixed(2),
            fromPaddock: transportFromCost.toFixed(2),
            perHour: effectiveWorkCostPerHour.toFixed(2),
            totalHours: effectiveWorkCostTotal.toFixed(2)
          },
          status: 'Pending'
        };

        updateWorkList();

        // Mostrar notificación de éxito
        showNotification('Work mission created successfully');

        // Limpiar el formulario
        document.getElementById('workName').value = '';
        document.getElementById('vehicle').value = '';
        document.getElementById('paddock').value = '';
        document.getElementById('tool').value = '';
        document.getElementById('transportFrom').value = '';
        document.getElementById('transportTo').value = '';
        document.getElementById('estimatedHours').value = '';
      }

      // Modal helpers for Consumption Results
      function openConsumptionModal() {
        const modal = document.getElementById('consumption-modal');
        const content = document.getElementById('consumption-modal-content');
        if (!modal || !content) return;
        modal.classList.remove('hidden');
        modal.classList.add('flex');
        document.body.classList.add('overflow-hidden');
        // animación de entrada
        requestAnimationFrame(() => {
          content.classList.remove('opacity-0','scale-95');
          content.classList.add('opacity-100','scale-100');
        });
      }

      function closeConsumptionModal() {
        const modal = document.getElementById('consumption-modal');
        const content = document.getElementById('consumption-modal-content');
        if (!modal || !content) return;
        // animación de salida
        content.classList.remove('opacity-100','scale-100');
        content.classList.add('opacity-0','scale-95');
        setTimeout(() => {
          modal.classList.remove('flex');
          modal.classList.add('hidden');
          document.body.classList.remove('overflow-hidden');
        }, 250);
      }

      // Cerrar por click fuera y Escape
      document.addEventListener('click', (e) => {
        const modal = document.getElementById('consumption-modal');
        const content = document.getElementById('consumption-modal-content');
        if (modal && !modal.classList.contains('hidden')) {
          if (e.target === modal) {
            closeConsumptionModal();
          }
        }
      });

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeConsumptionModal();
      });

      function openConsumptionModalWithData(toPaddock, fromPaddock, perHour, totalHours, total) {
        const modalTransportTo = document.getElementById('modalTransportToCost');
        const modalTransportFrom = document.getElementById('modalTransportFromCost');
        const modalPerHour = document.getElementById('modalEffectiveWorkPerHour');
        const modalTotalHours = document.getElementById('modalEffectiveWorkTotal');
        const modalTotal = document.getElementById('modalTotalConsumption');

        if (modalTransportTo) modalTransportTo.textContent = `${toPaddock} kWh`;
        if (modalTransportFrom) modalTransportFrom.textContent = `${fromPaddock} kWh`;
        if (modalPerHour) modalPerHour.textContent = `${perHour} kWh`;
        if (modalTotalHours) modalTotalHours.textContent = `${totalHours} kWh`;
        if (modalTotal) modalTotal.textContent = `${total} kWh`;

        openConsumptionModal();
      }

      function calculateTransportCost(from, to) {
        // Simulación simple de cálculo de consumo en transporte
        // En una implementación real, esto debería considerar distancias reales y consumo del vehículo
        return Math.random() * (5 - 2) + 2; // Retorna un valor entre 2 y 5 kWh
      }

      function calculateEffectiveWorkCost(tool) {
        // Simulación de consumo por hora según la herramienta
        const consumptionRates = {
          'sprayer': 8,
          'seeder': 10,
          'harvester': 15,
          'plow': 12
        };
        return consumptionRates[tool] || 10;
      }

      function updateWorkList() {
        const workListElement = document.getElementById('workList');
        const existingWorks = workListElement.innerHTML;

        // Solo crear fila para el trabajo más reciente si existe
        let newWorkRow = '';
        if (lastWork) {
          newWorkRow = `
            <tr class="border-t border-[var(--turqueza)] border-opacity-50">
              <td class="px-4 py-3 text-white">${lastWork.name}</td>
              <td class="px-4 py-3 text-white">${lastWork.vehicle}</td>
              <td class="px-4 py-3 text-white">${lastWork.paddock}</td>
              <td class="px-4 py-3 text-white">${lastWork.tool}</td>
              <td class="px-4 py-3 text-white">
                <div class="flex items-center gap-2">
                  <span>${lastWork.totalConsumption} kWh</span>
                  <button class=" ms-3 p-1 rounded  text-[var(--turqueza)] hover:bg-[var(--turqueza)]/10 transition-colors" title="View breakdown" onclick="openConsumptionModalWithData('${lastWork.details.toPaddock}','${lastWork.details.fromPaddock}','${lastWork.details.perHour}','${lastWork.details.totalHours}','${lastWork.totalConsumption}')">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-4 h-4" fill="currentColor">
                      <rect width="256" height="256" fill="none"/>
                      <polyline points="160 48 208 48 208 96" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
                      <line x1="144" y1="112" x2="208" y2="48" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
                      <polyline points="96 208 48 208 48 160" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
                      <line x1="112" y1="144" x2="48" y2="208" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
                    </svg>
                  </button>
                </div>
              </td>
              <td class="px-4 py-3">
                <span class="px-2 py-1 text-xs font-medium rounded-full bg-[var(--turqueza)] text-white">
                  ${lastWork.status}
                </span>
              </td>
            </tr>
          `;
        }

        // Insertar el nuevo trabajo al inicio, manteniendo los ejemplos predefinidos
        workListElement.innerHTML = newWorkRow + existingWorks;
      }

      // Funciones para Extra Packs Hiring
      let currentReservationType = 'pack';

      function toggleReservationType(type) {
        currentReservationType = type;
        
        // Actualizar estilos de los botones
        const packBtn = document.getElementById('packToggle');
        const stationBtn = document.getElementById('stationToggle');
        const vehicleSection = document.getElementById('vehicleSection');
        const quantityLabel = document.getElementById('quantityLabel');
        
        if (type === 'pack') {
          packBtn.classList.add('bg-[var(--turqueza)]', 'text-white');
          packBtn.classList.remove('text-[var(--turqueza)]');
          stationBtn.classList.remove('bg-[var(--turqueza)]', 'text-white');
          stationBtn.classList.add('text-[var(--turqueza)]');
          
          vehicleSection.style.display = 'block';
          quantityLabel.textContent = 'Number of packs';
        } else {
          stationBtn.classList.add('bg-[var(--turqueza)]', 'text-white');
          stationBtn.classList.remove('text-[var(--turqueza)]');
          packBtn.classList.remove('bg-[var(--turqueza)]', 'text-white');
          packBtn.classList.add('text-[var(--turqueza)]');
          
          vehicleSection.style.display = 'none';
          quantityLabel.textContent = 'Number of Battery Stations';
        }
      }
  // 
      let reservationList = [
       {
          packId: 'swap-886-zt',
          startTime: '05/11/2025',
          endTime: '25/12/2025',
          consumoKvh: '180.50',
          status: 'In progress'
        },
        {
          packId: 'zetrabot1-Pack(1)',
          startTime: '20/11/2025',
          endTime: '10/12/2025',
          consumoKvh: '',
          status: 'Confirmed'
        },
        {
          packId: 'zetrabot2-Pack(1)',
          startTime: '27/11/2025 ',
          endTime: '10/12/2025 ',
          consumoKvh: '',
          status: 'Pending'
        },
        {
          packId: 'swap-545-zt',
          startTime: '20/10/2025',
          endTime: '05/11/2025',
          consumoKvh: '180.50',
          status: 'Finished'
        },
        {
          packId: 'swap-334-zt',
          startTime: '12/09/2025',
          endTime: '30/09/2025',
          consumoKvh: '220.0',
          status: 'Finished'
        },{
          packId: 'swap-555-zt',
          startTime: '28/08/2025',
          endTime: '15/09/2025',
          consumoKvh: '200.0',
          status: 'Finished'
        },{
          packId: 'station-088-bt',
          startTime: '28/08/2025',
          endTime: '15/09/2025',
          consumoKvh: '450.5',
          status: 'Finished'
        },{
          packId: 'swap-777-zt',
          startTime: '18/06/2025',
          endTime: '05/07/2025',
          consumoKvh: '100.5',
          status: 'Finished'
        },{
          packId: 'swap-886-zt',
          startTime: '23/05/2025',
          endTime: '05/06/2025',
          consumoKvh: '130.5',
          status: 'Finished'
        },{
          packId: 'swap-999-zt',
          startTime: '18/04/2025',
          endTime: '05/05/2025',
          consumoKvh: '190.0',
          status: 'Finished'
        }
      ];

      function showNotification(message, type = 'success') {
        const notification = document.createElement('div');
        notification.className = `notification fixed top-4 right-4 p-4 rounded z-50 ${
          type === 'success' ? 'bg-[var(--turqueza)]' : 'bg-red-500'
        } text-white flex items-center gap-2`;
        
        // Agregar icono según el tipo
        const icon = document.createElement('i');
        icon.className = `fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}`;
        notification.appendChild(icon);
        
        const text = document.createElement('span');
        text.textContent = message;
        notification.appendChild(text);
        
        document.body.appendChild(notification);
        
        // Agregar clase de animación de salida antes de remover
        setTimeout(() => {
          notification.classList.add('hiding');
          setTimeout(() => {
            notification.remove();
          }, 300);
        }, 2700);
      }

      function requestReservation() {
        // Obtener valores del formulario
        const vehicle = document.getElementById('reservationVehicle').value;
        const numPacks = document.getElementById('reservationPacks').value;
        const startTime = document.getElementById('reservationStart').value;
        const endTime = document.getElementById('reservationEnd').value;

        // Validar que todos los campos estén completos
        if ((currentReservationType === 'pack' && !vehicle) || !numPacks || !startTime || !endTime) {
          showNotification('Please complete all fields', 'error');
          return;
        }

        // Validar que la fecha de inicio sea anterior a la fecha de fin
        const startDate = new Date(startTime);
        const endDate = new Date(endTime);
        if (startDate >= endDate) {
          showNotification('Start date must be before end date', 'error');
          return;
        }

        // Ajustar la validación de fecha considerando timezone
        const now = new Date();
        const userTimezoneOffset = now.getTimezoneOffset() * 60000;
        const localNow = new Date(now.getTime() - userTimezoneOffset);
        
        // Remover la parte del timezone de la fecha de inicio para comparación justa
        const localStartDate = new Date(startDate.getTime() - userTimezoneOffset);
        
        if (localStartDate.toISOString().split('T')[0] < localNow.toISOString().split('T')[0]) {
          showNotification('Start date cannot be before current date', 'error');
          return;
        }

        // Agregar reservación a la lista
        const newReservation = {
          packId: currentReservationType === 'pack' ? `${vehicle}-Pack${numPacks}` : `Battery-Station-${numPacks}`,
          startTime: new Date(new Date(startTime).getTime() - userTimezoneOffset).toLocaleDateString('es-ES'),
          endTime: new Date(new Date(endTime).getTime() - userTimezoneOffset).toLocaleDateString('es-ES'),
          consumoKvh: '0.00', // Este valor se actualizará cuando haya consumo real
          status: 'Pending'
        };

        reservationList.push(newReservation);
        updateReservationList();

        // Mostrar notificación de éxito
        showNotification('Reservation created successfully');

        // Limpiar el formulario
        document.getElementById('reservationVehicle').value = '';
        document.getElementById('reservationPacks').value = '';
        document.getElementById('reservationStart').value = '';
        document.getElementById('reservationEnd').value = '';
      }

      function updateReservationList() {
        const reservationListElement = document.getElementById('reservationList');
        reservationListElement.innerHTML = '';

        // Ordenar las reservaciones por estado: In progress primero, luego Confirmed, luego Pending, luego Finished
        const sortedReservations = [...reservationList].sort((a, b) => {
          const statusOrder = { 
            'In progress': 0,
            'Confirmed': 1,
            'Pending': 2, 
            'Finished': 3 
          };
          const orderA = statusOrder[a.status] !== undefined ? statusOrder[a.status] : 4;
          const orderB = statusOrder[b.status] !== undefined ? statusOrder[b.status] : 4;
          return orderA - orderB;
        });

        console.log('Reservaciones ordenadas:', sortedReservations.map(r => ({ id: r.packId, status: r.status })));

        sortedReservations.forEach(reservation => {
          const row = document.createElement('tr');
          row.className = 'border-t border-t-[#4ABBBD]/50';
          const isInitialReservation = reservation.packId === 'zetrabot1-Pack2';
          const isFinished = reservation.status === 'Finished';
          const isPending = reservation.status === 'Pending';
          const isInProgress = reservation.status === 'In progress';
          
          row.innerHTML = `
            <td class="px-4 py-3 text-[var(--turqueza)] text-sm">${reservation.packId}</td>
            <td class="px-4 py-3 text-[var(--turqueza)] text-sm">${reservation.startTime}</td>
            <td class="px-4 py-3 ${isFinished ? 'text-[var(--turqueza)]' : 'text-[var(--turqueza)] opacity-30'} text-sm">${reservation.endTime}</td>
            <td class="px-4 py-3 text-[var(--turqueza)] text-sm">${reservation.consumoKvh === '0.00' ? '' : reservation.consumoKvh}</td>
            <td class="px-4 py-3 flex items-center gap-2">
              ${isInProgress ? 
                '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-4 h-4 text-[var(--turqueza)]"><rect width="256" height="256" fill="none"/><line x1="128" y1="32" x2="128" y2="64" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/><line x1="224" y1="128" x2="192" y2="128" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/><line x1="195.88" y1="195.88" x2="173.25" y2="173.25" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/><line x1="128" y1="224" x2="128" y2="192" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/><line x1="60.12" y1="195.88" x2="82.75" y2="173.25" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/><line x1="32" y1="128" x2="64" y2="128" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/><line x1="60.12" y1="60.12" x2="82.75" y2="82.75" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/></svg>' :
                isFinished ?
                '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-4 h-4 text-green-500"><rect width="256" height="256" fill="none"/><polyline points="16 130.29 54.4 168 144 80" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/><polyline points="125.96 144 150.4 168 240 80" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/></svg>' :
                '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-4 h-4 text-[var(--turqueza)]"><rect width="256" height="256" fill="none"/><polyline points="40 144 96 200 224 72" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/></svg>'
              }
              <span class="status-badge px-2 py-1 text-xs font-medium rounded-full ${
                isFinished ? 'bg-green-500' : 'bg-[var(--turqueza)]'
              } text-white">
                ${reservation.status}
              </span>
            </td>
          `;
          reservationListElement.appendChild(row);
        });
      }

      // Función para actualizar el umbral mínimo
      function updateThreshold(vehicleId, value) {
        // Actualizar el valor mostrado
        document.getElementById('thresholdValue_' + vehicleId).textContent = value + '%';
        
        // Actualizar solo las líneas de umbral del vehículo específico que tienen la clase threshold-enabled
        const bars = document.querySelectorAll(`.battery-bar.threshold-enabled[data-vehicle="${vehicleId}"]`);
        bars.forEach(bar => {
          const thresholdLine = bar.querySelector('.threshold-line');
          if (thresholdLine) {
            thresholdLine.style.width = value + '%';
          }
          
          // Verificar y marcar barras bajo el umbral
          const progressBar = bar.querySelector('.progress-bar');
          const percentage = parseFloat(progressBar.style.width);
          if (percentage < value) {
            progressBar.classList.add('below-threshold');
          } else {
            progressBar.classList.remove('below-threshold');
          }
        });
      }

      // --- SCRIPT PARA EL MEDIDOR DE ENERGÍA ---
      document.addEventListener('DOMContentLoaded', () => {
        // Inicializar la lista de reservaciones
        updateReservationList();

        const totalCapacity = 132; // kWh
        const currentAvailability = 102; // kWh

        const percentage = (currentAvailability / totalCapacity) * 100;
        
        const gaugePath = document.querySelector('#dashboard-view path[stroke-dasharray]');
        const percentageText = document.querySelector('#dashboard-view .text-3xl');
        const availabilityText = document.querySelector('#dashboard-view .text-lg');

        const circumference = parseFloat(gaugePath.getAttribute('stroke-dasharray'));
        const offset = circumference * (1 - (percentage / 100) * 0.75); // 0.75 porque es un semicírculo

        gaugePath.style.strokeDashoffset = offset;
        percentageText.textContent = `${Math.round(percentage)}%`;
        
        // Opcional: actualizar el texto si es dinámico
        // availabilityText.innerHTML = `${currentAvailability} kWh <span class="text-[var(--turqueza)] text-base">/ ${totalCapacity} kWh</span>`;
      });
    </script>

    <script src="https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.js"></script>
    <script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>

    <!-- ===================================================================================================================== -->

    <!-- ============                                LIVE MONITORING 2 VIEW                                     =============== -->

    <!-- ===================================================================================================================== -->

    <script>
        // Script for the third map (spinning globe) - REFACTORED
        (function() {
          mapboxgl.accessToken = 'pk.eyJ1Ijoic2ViYXN0aWFucHJhZG8iLCJhIjoiY21ibTQ4NHNlMGdzMzJsczU0a2s3MjFlbCJ9.h3TjjeSIyavEQjqlu8oAKw';
          
          const paddockFeatures = {
            "type": "FeatureCollection",
            "features": [
              {
                id: "Finca",
                type: "Feature",
                properties: {},
                geometry: { type: "Polygon", coordinates: [[[-2.456164971296232,42.83090407619602],[-2.4558181873175045,42.83368195643942],[-2.4557915116272113,42.834249254657294],[-2.4556314574835483,42.83491435628039],[-2.4560849442243864,42.83491435628039],[-2.4575254315198265,42.83532515076624],[-2.4614734337361597,42.836342344406546],[-2.4633407320822016,42.836850934948274],[-2.4644077597075977,42.837144350663834],[-2.466168355291501,42.83739864315751],[-2.466675193413977,42.83743776498693],[-2.4669419503197787,42.83728127752147],[-2.467288734298478,42.83696830140167],[-2.4677155453490798,42.83663576253704],[-2.4679289508743807,42.83657707902239],[-2.471450142040112,42.836322783148546],[-2.46987627629224,42.835207781192054],[-2.467395437061697,42.83344721082642],[-2.46507465197476,42.831823529255075],[-2.4647011923047444,42.831530088275855],[-2.461686839261432,42.830532378523685],[-2.459072621577377,42.830669320031774],[-2.4563517011312683,42.83082582423978],[-2.456164971296232,42.83090407619602]]]}
              },
              {
                id: "poligono_1",
                type: "Feature",
                properties: {},
                geometry: { type: "Polygon", coordinates: [[[-2.4589936955511575,42.83562585279756],[-2.4591647861492447,42.835638398992614],[-2.4592332223874394,42.83553802935944],[-2.460259765974598,42.833380042816174],[-2.460191329736489,42.833292216186436],[-2.4593358767460245,42.83306637570911],[-2.459199004268328,42.83305382899138],[-2.4591134589692842,42.83320438943238],[-2.4582066788001953,42.835337289603984],[-2.4582066788001953,42.8354251133274],[-2.4584119875187582,42.83546275202767],[-2.4589936955511575,42.83562585279756]]]}
              },
              {
                id: "poligono_2",
                type: "Feature",
                properties: {},
                geometry: { type: "Polygon", coordinates: [[[-2.460645818421227,42.83309897168422],[-2.460701635284039,42.83326270180342],[-2.4607165197805614,42.83331182075426],[-2.4607500098979926,42.83334729552814],[-2.4608021056363896,42.833374583801856],[-2.4611184011922944,42.833461906196504],[-2.4625956880601336,42.83387395727328],[-2.463886373427698,42.834233759098254],[-2.4639107020152267,42.834232744530794],[-2.463929477135693,42.83423089868192],[-2.4639451218365025,42.83422004736579],[-2.463958995135556,42.83419321311641],[-2.463965062642899,42.83417139704741],[-2.4642218202116055,42.83370750073777],[-2.464452529910517,42.83333092352618],[-2.4645343933838717,42.83319175272132],[-2.4642553090698414,42.83310170110599],[-2.46390924452092,42.83299254745742],[-2.4636896981941447,42.83292978402193],[-2.4632803745346905,42.83278788384601],[-2.462692434641781,42.83258321889082],[-2.4622831109823267,42.8324194869719],[-2.4620970547729826,42.83238946940614],[-2.4619928632962456,42.83235126521086],[-2.461937046433434,42.832326705358554],[-2.4618365760798895,42.83230487437035],[-2.461739826851982,42.83227212787381],[-2.461635635374023,42.8322393813599],[-2.461517753622701,42.8321904809481],[-2.4613912354005834,42.832171378791884],[-2.4613093706680047,42.83212225893425],[-2.460795855530648,42.8321550055106],[-2.460494444472431,42.832168649912205],[-2.460401416367773,42.832174107671904],[-2.4603716473747284,42.832195938705866],[-2.4603493206294047,42.83222868524322],[-2.4603604840015123,42.83226961838966],[-2.460386531871251,42.832335111368536],[-2.4604497936716143,42.83252340608732],[-2.4604795626658245,42.83261345854487],[-2.460645818421227,42.83309897168422]]]}
              },
              {
                id: "poligono_3",
                type: "Feature",
                properties: {},
                geometry: { type: "Polygon", coordinates: [[[-2.4671253282082546,42.833255959737755],[-2.4670661697778655,42.833225294450585],[-2.4670242756506866,42.83324531407479],[-2.466935927769157,42.83331613289215],[-2.4664864331816716,42.83367479900167],[-2.46640775964093,42.83374779360966],[-2.466337959026191,42.8338012293481],[-2.4663091409267395,42.83381822083024],[-2.4662843435553157,42.83381851443903],[-2.466238139178216,42.83381710265871],[-2.4661541722547042,42.8337990679764],[-2.466130703766339,42.83379039108331],[-2.4661089986175,42.83380114194736],[-2.4660839371635745,42.83382410542447],[-2.4656367499776763,42.83419010817531],[-2.4652074770928323,42.83452917151328],[-2.46507465659181,42.8346320436502],[-2.465051290295861,42.834654007334166],[-2.465049296971358,42.834667462898636],[-2.465054782895862,42.834682648815715],[-2.465074196578513,42.83469780973829],[-2.465208925299521,42.83475959653808],[-2.46526507078579,42.8347878943855],[-2.4653750021353744,42.834849974698585],[-2.465559163770905,42.83496448391966],[-2.4656906043620097,42.83505890967646],[-2.4660073069510133,42.83529175682847],[-2.466179434672597,42.835427957716746],[-2.466285988687332,42.835514232287835],[-2.466392542702039,42.835600506738444],[-2.4665286920170217,42.83572195462406],[-2.466590020048727,42.835777887797775],[-2.466776845482997,42.83592646491567],[-2.466847251803074,42.835977043422616],[-2.4670023099746174,42.836093919903476],[-2.467193835242284,42.836233147507926],[-2.4673640307979667,42.836366120600246],[-2.4674421302564724,42.83643189627796],[-2.467512180666887,42.83648487679682],[-2.467575642174495,42.83652639389612],[-2.467614281232443,42.83654527198533],[-2.4676466872952005,42.83655028427552],[-2.467679093358612,42.83655529656528],[-2.467719867869448,42.836559760109964],[-2.4677533416597157,42.836557565130704],[-2.46778389516129,42.836552706741315],[-2.4678699778708904,42.83653095056786],[-2.4679541670868446,42.83651340208817],[-2.4681114841452256,42.836500870549884],[-2.4682801964823113,42.83649328932273],[-2.468634534880408,42.83646815490562],[-2.4688579447139034,42.83645603741124],[-2.4692121734863974,42.836433986835374],[-2.4695095419739914,42.83641313113171],[-2.4696879189488925,42.83639985175077],[-2.469898453682873,42.83638506209908],[-2.4701874580062793,42.83636927638787],[-2.4702082806950614,42.836370126652554],[-2.4702278467304666,42.836357132208065],[-2.470234809878889,42.836339899767154],[-2.4702318473421485,42.83632268513074],[-2.4702291215651258,42.83630387233674],[-2.470229782693295,42.8362843563326],[-2.470259411006216,42.836271985900886],[-2.4703839305797084,42.8362591520914],[-2.470572278908771,42.83624267708743],[-2.4706548829492716,42.83623524705635],[-2.4707063270744913,42.83625147193271],[-2.4707309609014807,42.8362855956707],[-2.4707454799816873,42.83631962616047],[-2.4707775658376274,42.83632685119278],[-2.4710377641785835,42.8363146842659],[-2.4713179351725594,42.83629284022246],[-2.471330749310698,42.83629079993946],[-2.471347707152453,42.836273180090984],[-2.471337600780169,42.83625081096817],[-2.471130733049061,42.83610539963255],[-2.4705760993536816,42.83570460849043],[-2.470037323847052,42.83532051223153],[-2.469354515526131,42.834839951429814],[-2.468586840445944,42.83429075250972],[-2.4671253282082546,42.833255959737755]]]}
              },
              {
                id: "poligono_4",
                type: "Feature",
                properties: {},
                geometry: { type: "Polygon", coordinates: [[[-2.465277789677117,42.834956301817755],[-2.4653359873647958,42.83493898901784],[-2.4654026780778793,42.834976583980335],[-2.4659841062085945,42.83540320026876],[-2.466361141785967,42.835710092022026],[-2.4666097456319562,42.83594248374811],[-2.46691104720432,42.83618009957979],[-2.467252633363586,42.836439132912886],[-2.4674653311448935,42.83659313236808],[-2.467512428383742,42.83665726335502],[-2.4675134956856937,42.83672174298087],[-2.4673924204878688,42.83681527083979],[-2.4671855841237686,42.836987576435234],[-2.4669911432684444,42.83714735653115],[-2.4668836470287374,42.83724229264095],[-2.4667704211992145,42.83730676393017],[-2.4666111766667314,42.837344080320776],[-2.4664819632148465,42.83734701941344],[-2.466117493632538,42.83730429340926],[-2.465766885178539,42.83726076842774],[-2.464900423605627,42.837155857589295],[-2.4648460227174382,42.83713883243536],[-2.4648767256589394,42.83710516627781],[-2.4649559315189435,42.83708903726665],[-2.4651198194981703,42.837012495859],[-2.4651900221115284,42.836975431682646],[-2.46524502687123,42.83691378932892],[-2.4653864063271556,42.836775519073456],[-2.465545599746747,42.83661569885206],[-2.465643601513335,42.83651370193763],[-2.465746413133445,42.836411997264975],[-2.465965525141968,42.83620540976278],[-2.465913941307633,42.83615154211222],[-2.4655706888741804,42.836016169462766],[-2.4653853838172495,42.83591056165568],[-2.465287222311531,42.83580650300925],[-2.46513931806615,42.83567103880554],[-2.464997273437291,42.835561355492445],[-2.4648278726141655,42.83541127405567],[-2.464793782300113,42.8353794737551],[-2.46487507610415,42.835315969525475],[-2.4650271392262084,42.835198436706364],[-2.465277789677117,42.834956301817755]]]}
              },
              {
                id: "poligono_5",
                type: "Feature",
                properties: {},
                geometry: { type: "Polygon", coordinates: [[[-2.4646100504139667,42.83319740763625],[-2.464316175374819,42.83362448525966],[-2.4641196653469706,42.833951303984435],[-2.464006680299377,42.83411284582442],[-2.4639823982582527,42.83417201234997],[-2.463986423802595,42.83422152397611],[-2.464040645284257,42.834249123094395],[-2.464094739162107,42.83427436376857],[-2.4641983314483014,42.83429261595418],[-2.4643844083223314,42.83433653488453],[-2.4646160878333205,42.83440443636027],[-2.4648522287764933,42.834515169855194],[-2.4649611275648056,42.83457619367147],[-2.465040561093332,42.834620084036885],[-2.46506957696937,42.83461225386017],[-2.4651007564732765,42.83458115212227],[-2.4651157146707874,42.8345542179907],[-2.4654518391569695,42.8342942300381],[-2.46568524768378,42.83411367418657],[-2.4660829333348033,42.83379066238098],[-2.4661176510022074,42.83376791054465],[-2.4661815357735577,42.83378642038008],[-2.466254301990034,42.833799285844236],[-2.4663162324568475,42.83379354740612],[-2.466690335169858,42.83346665390138],[-2.4668523613779314,42.833330513624134],[-2.4669932648501742,42.833226850859944],[-2.467010882527859,42.83319450308883],[-2.4665972406359344,42.83289550690833],[-2.465511644180168,42.83212197172216],[-2.4652316837107833,42.83191890971264],[-2.464983175306429,42.83174075615193],[-2.4647187857466406,42.83158734805073],[-2.4644912049956815,42.83148471444241],[-2.463967306366584,42.83131052487357],[-2.4633673223005985,42.831118966802876],[-2.4628932384264033,42.83095645711725],[-2.462381217021374,42.83078657240472],[-2.4618315965070963,42.83061541616672],[-2.4616421163250095,42.83056879874013],[-2.4614795594090424,42.830570344866345],[-2.46142320589243,42.83056016255941],[-2.46133861020823,42.83055264103132],[-2.4611820597046687,42.83055182994673],[-2.460529201707459,42.83059529779243],[-2.460082555300943,42.83062499594715],[-2.4596703151209454,42.83065353881827],[-2.4595939492677132,42.83066283410264],[-2.45957533292011,42.83068903471249],[-2.4595986227258493,42.83075413181433],[-2.4596492316833007,42.83088879719736],[-2.459738208942156,42.831086540817154],[-2.4599047667925333,42.83139740124594],[-2.460110884955526,42.831775782193915],[-2.4602525263674693,42.832059134976646],[-2.4603086055855954,42.83215042718609],[-2.4603680672273924,42.83215865925308],[-2.4604827065346626,42.832152625598496],[-2.4610984013506823,42.83211044399164],[-2.46127205496245,42.832101141908026],[-2.4613374603352725,42.83209508243519],[-2.4613674235055214,42.83207874191166],[-2.4613838354702864,42.832041194999846],[-2.461382652638605,42.8319921117708],[-2.4613909970188956,42.831960239326605],[-2.461394288531096,42.83190479224052],[-2.4613982613311407,42.83186721201639],[-2.4614031165891674,42.83183411723064],[-2.4614184766200538,42.831808866466815],[-2.4614438757758137,42.83183034108444],[-2.4614628248048405,42.83187652546053],[-2.461476302860774,42.83195233615871],[-2.4614871949470114,42.8320025029567],[-2.4614873693488164,42.83204508823695],[-2.4614964688101395,42.83208714464226],[-2.461528833366714,42.8321056082211],[-2.462103191666813,42.83224140688708],[-2.4621310901213462,42.83226314637534],[-2.4621535130231393,42.83230331365405],[-2.462188771096322,42.83234708109242],[-2.462245960530879,42.8323778620055],[-2.4623180609358712,42.83242113929913],[-2.4624644619441085,42.83247042638072],[-2.4625178598121806,42.83249351786978],[-2.4646100504139667,42.83319740763625]]]}
              }
            ]
          };

          const fincaFeature = paddockFeatures.features.find(f => f.id === "Finca");

          // 2. Convert the 'Finca' polygon into a LineString for the boundary
          const fincaBoundary = {
            "type": "Feature",
            "id": "Finca",
            "properties": {},
            "geometry": {
              "type": "LineString",
              "coordinates": fincaFeature.geometry.coordinates[0] // Use the outer ring
            }
          };

          // 3. Create separate FeatureCollections for the sources
          const paddockPolygons = {
            "type": "FeatureCollection",
            "features": paddockFeatures.features
              .filter(f => f.id !== "Finca")
              .map((f, i) => ({
                ...f,
                id: f.properties?.id || i + 1  // Asegura id único
              }))
          };
          const fincaSource = {
            "type": "FeatureCollection",
            "features": [fincaBoundary]
          };

          // Calculate center using the original Finca polygon for accurate centering
          const center = turf.centerOfMass(fincaFeature).geometry.coordinates;

          const map3 = new mapboxgl.Map({
              container: 'map3',
              style: 'mapbox://styles/mapbox/satellite-v9',
              projection: 'globe', 
              zoom: 15.2,
              center: center,
              pitch: 0 
          });
          window.map3Instance = map3; // Expose map instance to global scope

          // map3.scrollZoom.disable(); // Comentado para habilitar zoom con rueda del mouse

          map3.on('style.load', () => {
              map3.setFog({});

              // Source for interactive parcels (poligono_1, poligono_2)
              map3.addSource('paddock', {
                  'type': 'geojson',
                  'data': paddockPolygons
              });

              // Source for the non-interactive Finca boundary
              map3.addSource('finca-boundary', {
                  'type': 'geojson',
                  'data': fincaSource
              });
              
              // Layer for the Finca boundary line
              map3.addLayer({
                  'id': 'finca-boundary-line',
                  'type': 'line',
                  'source': 'finca-boundary',
                  'paint': {
                      'line-color': 'white', // Boundary color
                      'line-width': 1
                  }
              });

              // Layers for the interactive parcels
              map3.addLayer({
                  'id': 'paddock-fill',
                  'type': 'fill',
                  'source': 'paddock',
                  'paint': { 'fill-color': '#4ABBBD', 'fill-opacity': 0.01 }
              });

              // Lineas de los poligonos
              map3.addLayer({
                  'id': 'paddock-outline',
                  'type': 'line',
                  'source': 'paddock',
                  'paint': { 
                      'line-color': '#0b2545', 
                      'line-width': [
                        'case',
                        ['boolean', ['feature-state', 'hover'], false],
                        2, // Ancho cuando hover es true
                        0  // Ancho normal
                      ],
                      'line-width-transition': {
                        'duration': 150
                      }
                  }
              });

              let hoveredStateId = null;

              map3.on('mousemove', 'paddock-fill', (e) => {
              if (e.features.length > 0) {
               if (hoveredStateId !== null) {
               map3.setFeatureState(
                 { source: 'paddock', id: hoveredStateId },
                 { hover: false }
                 );
                }

              hoveredStateId = e.features[0].id || e.features[0].properties.id;
              map3.setFeatureState(
               { source: 'paddock', id: hoveredStateId },
                { hover: true }
               );
                }
              });
map3.on('mouseleave', 'paddock-fill', () => {
  if (hoveredStateId !== null) {
    map3.setFeatureState(
      { source: 'paddock', id: hoveredStateId },
      { hover: false }
    );
  }
  hoveredStateId = null;
});


              // Variable para guardar el ID del polígono con hover
              let hoveredPolygonId = null;

              // Hover events para los polígonos
              map3.on('mousemove', 'paddock-fill', (e) => {
                  map3.getCanvas().style.cursor = 'pointer';
                  if (e.features.length > 0) {
                      if (hoveredPolygonId !== null) {
                          // Quitar el estado hover del polígono anterior
                          map3.setFeatureState(
                              { source: 'paddock', id: hoveredPolygonId },
                              { hover: false }
                          );
                      }
                      hoveredPolygonId = e.features[0].id;
                      // Poner el estado hover en el nuevo polígono
                      map3.setFeatureState(
                          { source: 'paddock', id: hoveredPolygonId },
                          { hover: true }
                      );
                  }
              });

              map3.on('mouseleave', 'paddock-fill', () => {
                  map3.getCanvas().style.cursor = '';
                  if (hoveredPolygonId !== null) {
                      // Quitar el estado hover cuando el mouse deja el polígono
                      map3.setFeatureState(
                          { source: 'paddock', id: hoveredPolygonId },
                          { hover: false }
                      );
                  }
                  hoveredPolygonId = null;
              });
              
              // Click event for parcel popups
              map3.on('click', 'paddock-fill', (e) => {
                  // Prevent polygon click event when clicking on a marker
                  if (e.originalEvent.target.closest('.mapboxgl-marker')) {
                      return;
                  }

                  if (e.features.length > 0) {
                      const feature = e.features[0];
                      const htmlContent = `
                          <h2>Paddock ${feature.id}</h2>
                          <span class="text-white-200">Información sobre la parcela o misiones que se aproximan .</span>
                      `;
                      new mapboxgl.Popup().setLngLat(e.lngLat).setHTML(htmlContent).addTo(map3);
                  }
              });

              // Snake line coordinates
              const snakeLineCoords = [[-2.471166051338031,42.83623951331677],[-2.4677344013283573,42.83644768469631],[-2.467592459600752,42.8364538073732],[-2.467525663493575,42.83639870325791],[-2.4675841100861646,42.836355844468216],[-2.4676926537608495,42.836331353717725],[-2.4707485756671588,42.8361537954859],[-2.4708654688550666,42.83613542736376],[-2.470923915448992,42.836098691103075],[-2.470923915448992,42.836049709388504],[-2.470873818368318,42.83600072763517],[-2.4707485756671588,42.83601297307737],[-2.467525663493575,42.8362088998191],[-2.4674254693321416,42.83623339061813],[-2.4673336246839312,42.83623339061813],[-2.4672417800370567,42.8362088998191],[-2.4671666344166567,42.836166040897325],[-2.4671582849034337,42.83611705923616],[-2.4671916829563827,42.83606807753617],[-2.467291877117816,42.836049709388504],[-2.467375372251439,42.83604358667159],[-2.4674588673850906,42.83606195482105],[-2.4675507120332725,42.836074200250664],[-2.470531488319182,42.8359088867428],[-2.47060663393961,42.835878273081846],[-2.4706233329660563,42.835829291192596],[-2.47060663393961,42.83576806377613],[-2.4705565368588793,42.835731327297566],[-2.4704730417252847,42.835731327297566],[-2.470389546591605,42.835749695539334],[-2.470322750484428,42.835786432007495],[-2.4672417800370567,42.835957868568954],[-2.4671499353902107,42.83598235946752],[-2.4670497412287773,42.83599460491334],[-2.466957896581931,42.83599460491334],[-2.4668827509601385,42.835963991294875],[-2.4668243043662414,42.835902764011905],[-2.466807605339767,42.83584153666831],[-2.466874401446944,42.835786432007495],[-2.4669996441480464,42.835780309264464],[-2.4670914887962283,42.8357925547499],[-2.4671582849034337,42.83583541393074],[-2.470155760215846,42.835663977029554],[-2.4702476048640563,42.835633363246785],[-2.470272653403697,42.835578258400375],[-2.470264303890474,42.83551703073522],[-2.4702142068097714,42.835474171334084],[-2.4701474107025945,42.83544968023415],[-2.4700555660556915,42.835474171334084],[-2.4700138184882405,42.83552315350482],[-2.469955371894315,42.83554764457563],[-2.467408770305667,42.83567622253801]];
              map3.addSource('snake-line', {
                  'type': 'geojson',
                  'data': {
                      'type': 'Feature',
                      'properties': {},
                      'geometry': {
                          'type': 'LineString',
                          'coordinates': snakeLineCoords
                      }
                  }
              });

              map3.addLayer({
                  'id': 'snake-line-layer',
                  'type': 'line',
                  'source': 'snake-line',
                  'layout': {
                      'line-join': 'round',
                      'line-cap': 'round'
                  },
                  'paint': {
                      'line-color': '#4ABBBD',
                      'line-width': 2
                  }
              });

              // Dashed line continuation
              const lastCoord = snakeLineCoords[snakeLineCoords.length - 1];
             

              map3.addSource('dashed-line', {
                  'type': 'geojson',
                  'data': {
                      'type': 'Feature',
                      'properties': {},
                      'geometry': {
                          'type': 'LineString',
                          'coordinates': [[-2.4673955459733747,42.835682213958506],[-2.4672678449481396,42.83568970547813],[-2.467063523306763,42.83569345123763],[-2.4669460383632895,42.83570843427381],[-2.466874525788967,42.83574589184755],[-2.4667723649690174,42.83574589184755],[-2.4667008523946663,42.835730908821006],[-2.4666242317793206,42.83570843427381],[-2.46659358353304,42.83566723091596],[-2.466578259410312,42.835618536003864],[-2.4666037996148305,42.835581078352334],[-2.4666599880665103,42.83555860375125],[-2.466736608681856,42.83554736644703],[-2.4668234453789637,42.83553612914139],[-2.4668847418715245,42.83554736644703],[-2.4669460383632895,42.83556984105283],[-2.469837189580801,42.83542750174561],[-2.46991381019609,42.83542750174561],[-2.469969998646917,42.83540877286481],[-2.470005754934107,42.83537506086549],[-2.470005754934107,42.83534134884778],[-2.469964890606036,42.83530014524578],[-2.469939350401461,42.835266433186604],[-2.4698780539088716,42.83524395847107],[-2.469816757416254,42.83524021268374],[-2.4697605689654267,42.83525145004381],[-2.4697197046373276,42.83527017897174],[-2.469683948350138,42.83529639946187],[-2.469653300103829,42.83532636572258],[-2.4696124359650753,42.835330111461275],[-2.466721284748445,42.83546870521994],[-2.466634448050513,42.835483688310035],[-2.466562935476105,42.83550241716816],[-2.466476098778969,42.835517400250694],[-2.4663793577113893,42.835528937535145],[-2.4663386888363164,42.83550847710404],[-2.4663062114567538,42.83546810247253],[-2.4663393391824684,42.83542353143196],[-2.4664168640072432,42.83538464802595],[-2.466498415068827,42.83537503306812],[-2.4665591636682223,42.835379835304025],[-2.466634023559891,42.835381936075976],[-2.4696094390634755,42.83522051098191],[-2.4697203299564308,42.835206410674004],[-2.4697492256255202,42.83517698125294],[-2.4697498413420362,42.83513882416699],[-2.4697302232750076,42.8351026795045],[-2.4696914190944312,42.835072225798456],[-2.469641326836296,42.835057998336],[-2.4695817031108334,42.83506729278355],[-2.469517010916178,42.83507705813798],[-2.469420515804501,42.83510487915265],[-2.4667064109169416,42.83524727389246]]
                      }
                  }
              });

        map3.addLayer({
                  'id': 'dashed-line-layer',
                  'type': 'line',
                  'source': 'dashed-line',
                  'layout': {
                      'line-join': 'round',
                      'line-cap': 'round'
                  },
                  'paint': {
                      'line-color': 'white',
                      'line-width': 2,
                      'line-dasharray': [2, 2] // Creates a dashed pattern
                  }
              });

              // 1. Zetrabot 1 (Vehículo principal)
              const vehicleMarkerEl = document.createElement('div');
              vehicleMarkerEl.style.width = '50px';
              vehicleMarkerEl.style.height = '50px';
              vehicleMarkerEl.style.cursor = 'pointer';

              vehicleMarkerEl.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 52 52" style="transition: transform 0.2s ease-in-out;">
                  <defs>
                      <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
                          <feDropShadow dx="0" dy="0" stdDeviation="2" flood-color="white" flood-opacity="0.9"/>
                      </filter>
                  </defs>
                  <path d="M26 4C15.5 4 7 12.5 7 23c0 12.5 19 25 19 25s19-12.5 19-25C45 12.5 36.5 4 26 4z" fill="#0b2545" fill-opacity="0.7" stroke="white" stroke-width="2" filter="url(#shadow)"/>
                  <g transform="translate(14, 12) scale(0.75) translate(-384 -282)">
                     <g fill="#4ABBBD" stroke="#4ABBBD" stroke-width="01" filter="url(#shadow)">
                      <path d="m390.49085,289.18182l0,7.25c-1.34766,0.30469 -2.58203,0.88281 -3.625,1.71875l1.25,1.5625c1.19922,-0.96094 2.71484,-1.53125 4.375,-1.53125c3.87891,0 7,3.12109 7,7l4.5625,0c-0.34766,0.59375 -0.5625,1.26563 -0.5625,2c0,2.19922 1.80078,4 4,4c2.19922,0 4,-1.80078 4,-4c0,-1.02734 -0.41797,-1.94531 -1.0625,-2.65625l2,-4.96875l0.0625,-0.1875l0,-2.1875l-3.78888,-0.02626l-3.42733,0.02626l-3.09629,0l-2.75,-7.34375l-0.25,-0.65625l-8.6875,0zm2,2l5.3125,0l2.75,7.34375l0.25,0.65625l9.59375,0l-1.59375,4l-7.5625,0c-0.91797,-3.99609 -4.48047,-7 -8.75,-7l0,-5zm0,8c-3.30078,0 -6,2.69922 -6,6c0,3.30078 2.69922,6 6,6c3.30078,0 6,-2.69922 6,-6c0,-3.30078 -2.69922,-6 -6,-6zm0,2c2.22266,0 4,1.77734 4,4c0,2.22266 -1.77734,4 -4,4c-2.22266,0 -4,-1.77734 -4,-4c0,-2.22266 1.77734,-4 4,-4zm0,2c-1.10547,0 -2,0.89453 -2,2c0,1.10547 0.89453,2 2,2c1.10547,0 2,-0.89453 2,-2c0,-1.10547 -0.89453,-2 -2,-2zm15,2c1.11719,0 2,0.88281 2,2c0,1.11719 -0.88281,2 -2,2c-1.11719,0 -2,-0.88281 -2,-2c0,-1.11719 0.88281,-2 2,-2z" />
                      <path d="m407.27288,289.85509l2.95442,-5.12783l0,3.50852l2.95444,0l-2.95444,5.12783l0.00012,-3.50852l-2.95454,0z"/>
                    </g>
                  </g>
                </svg>
              `;

              vehicleMarkerEl.addEventListener('mouseenter', () => {
                vehicleMarkerEl.querySelector('svg').style.transform = 'scale(1.1)';
              });

              vehicleMarkerEl.addEventListener('mouseleave', () => {
                vehicleMarkerEl.querySelector('svg').style.transform = 'scale(1)';
              });

              const vehicleCoords = [-2.46744, 42.8357];

                              const vehiclePopupContent = `
                  <div style="width: 100%; font-family: sans-serif;">
                    <h1 style="font-size: 1.1rem;  margin-bottom: 12px; border-bottom: 1px solid #444; padding-bottom: 4px;">Zetrabot 001</h1>
                    <div style="display: grid; grid-template-columns: max-content auto; align-items: center; gap: 8px 12px; background-color: rgba(16, 19, 35, 0.85);   border-radius: 8px; padding: 10px;">
                      <span style="color:white ; font-weight: 500;">Status:</span>
                      <span style="color: #90b8f8 ; font-weight: 400;">Active</span>
                      <span style="color:white ; font-weight: 500;">Fixed Pack:</span>
                      <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 100px; height: 14px; background: #333; border: 1px solid #555; border-radius: 4px; overflow: hidden;">
                          <div style="width: 85%; height: 100%; background: rgba(96, 122, 251, 0.7);"></div>
                        </div>
                        <span style="color: #90b8f8 ; font-weight: 400;">85%</span>
                      </div>
                      <span style="color:white ; font-weight: 500;">Swappable Pack:</span>
                      <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 100px; height: 14px; background: #333; border: 1px solid #555; border-radius: 4px; overflow: hidden;">
                          <div style="width: 60%; height: 100%; background: rgba(96, 122, 251, 0.7);"></div>
                        </div>
                        <span style="color: #90b8f8 ; font-weight: 400;">60%</span>
                      </div>
                      <span style="color:white ; font-weight: 500;">Autonomy:</span>
                      <span style="color: #90b8f8 ; font-weight: 400;">2h 25m</span>
                    </div>
                  </div>`;

              // Hacer el pin de Zetrabot 1 clickeable para abrir el modal
              vehicleMarkerEl.style.cursor = 'pointer';
              vehicleMarkerEl.addEventListener('click', (e) => {
                e.stopPropagation(); // Evitar que se propague al mapa
                
                // Abrir el modal de Vehicle Fleet Status directamente con Zetrabot 1
                openVehicleStatusModal(1);
              });

              new mapboxgl.Marker({element: vehicleMarkerEl, anchor: 'bottom'})
                  .setLngLat(vehicleCoords)
                  .addTo(map3);

              // 2. Warehouse/Battery Station (Padre que alberga dos hijos)
              const warehouseCoords = [-2.4563193420900973, 42.83395617619635];
              const warehouseMarkerEl = document.createElement('div');
              warehouseMarkerEl.style.width = '55px';
              warehouseMarkerEl.style.height = '55px';
              warehouseMarkerEl.style.cursor = 'pointer';
              warehouseMarkerEl.style.zIndex = '10'; // Asegurarse que esté por encima de los hijos
              warehouseMarkerEl.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 52 52" style="transition: transform 0.2s ease-in-out;">
                  <defs>
                      <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
                          <feDropShadow dx="0" dy="0" stdDeviation="2" flood-color="white" flood-opacity="0.9"/>
                      </filter>
                  </defs>
                  <path d="M26 4C15.5 4 7 12.5 7 23c0 12.5 19 25 19 25s19-12.5 19-25C45 12.5 36.5 4 26 4z" fill="#4ABBBD" fill-opacity="0.3" stroke="white" stroke-width="2" filter="url(#shadow)"/>
                  <g transform="translate(15,14)" fill="#4ABBBD">
                    <path d="M7 2v11h3v9l7-12h-4l4-8z"/>
                  </g>
                </svg>
              `; 
              warehouseMarkerEl.addEventListener('mouseenter', () => { warehouseMarkerEl.querySelector('svg').style.transform = 'scale(1.2)'; });
              warehouseMarkerEl.addEventListener('mouseleave', () => { warehouseMarkerEl.querySelector('svg').style.transform = 'scale(1)'; });
              new mapboxgl.Marker(warehouseMarkerEl)
                  .setLngLat(warehouseCoords)
                  .addTo(map3);

              // --- Marcadores "Hijos" (inicialmente ocultos) ---
              let childMarkersVisible = false;

              // 3. Zetrabot 2 (Hijo 1 del Warehouse)
              const zetrabotMarkerEl = document.createElement('div');
              zetrabotMarkerEl.style.width = '40px';
              zetrabotMarkerEl.style.height = '40px';
              zetrabotMarkerEl.style.cursor = 'pointer';
              zetrabotMarkerEl.style.opacity = '0';
              zetrabotMarkerEl.style.visibility = 'hidden';
              zetrabotMarkerEl.style.transition = 'opacity 0.3s';
              zetrabotMarkerEl.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 52 52" style="transition: transform 0.2s ease-in-out;">
                  <defs>
                      <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
                          <feDropShadow dx="0" dy="0" stdDeviation="2" flood-color="white" flood-opacity="0.9"/>
                      </filter>
                  </defs>
                  <path d="M26 4C15.5 4 7 12.5 7 23c0 12.5 19 25 19 25s19-12.5 19-25C45 12.5 36.5 4 26 4z" fill="#0b2545" fill-opacity="0.7" stroke="white" stroke-width="2" filter="url(#shadow)"/>
                  <g transform="translate(14, 12) scale(0.75) translate(-384 -282)">
                     <g fill="#4ABBBD" stroke="#4ABBBD" stroke-width="01" filter="url(#shadow)">
                      <path d="m390.49085,289.18182l0,7.25c-1.34766,0.30469 -2.58203,0.88281 -3.625,1.71875l1.25,1.5625c1.19922,-0.96094 2.71484,-1.53125 4.375,-1.53125c3.87891,0 7,3.12109 7,7l4.5625,0c-0.34766,0.59375 -0.5625,1.26563 -0.5625,2c0,2.19922 1.80078,4 4,4c2.19922,0 4,-1.80078 4,-4c0,-1.02734 -0.41797,-1.94531 -1.0625,-2.65625l2,-4.96875l0.0625,-0.1875l0,-2.1875l-3.78888,-0.02626l-3.42733,0.02626l-3.09629,0l-2.75,-7.34375l-0.25,-0.65625l-8.6875,0zm2,2l5.3125,0l2.75,7.34375l0.25,0.65625l9.59375,0l-1.59375,4l-7.5625,0c-0.91797,-3.99609 -4.48047,-7 -8.75,-7l0,-5zm0,8c-3.30078,0 -6,2.69922 -6,6c0,3.30078 2.69922,6 6,6c3.30078,0 6,-2.69922 6,-6c0,-3.30078 -2.69922,-6 -6,-6zm0,2c2.22266,0 4,1.77734 4,4c0,2.22266 -1.77734,4 -4,4c-2.22266,0 -4,-1.77734 -4,-4c0,-2.22266 1.77734,-4 4,-4zm0,2c-1.10547,0 -2,0.89453 -2,2c0,1.10547 0.89453,2 2,2c1.10547,0 2,-0.89453 2,-2c0,-1.10547 -0.89453,-2 -2,-2zm15,2c1.11719,0 2,0.88281 2,2c0,1.11719 -0.88281,2 -2,2c-1.11719,0 -2,-0.88281 -2,-2c0,-1.11719 0.88281,-2 2,-2z" />
                      <path d="m407.27288,289.85509l2.95442,-5.12783l0,3.50852l2.95444,0l-2.95444,5.12783l0.00012,-3.50852l-2.95454,0z"/>
                    </g>
                  </g>
                </svg>`;

              // <svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 52 52" style="transition: transform 0.2s ease-in-out;">


              const zetrabotMarker = new mapboxgl.Marker(zetrabotMarkerEl).setLngLat(warehouseCoords).addTo(map3);
              
              // Hacer el pin clickeable para abrir el modal de Vehicle Fleet Status
              zetrabotMarkerEl.style.cursor = 'pointer';
              zetrabotMarkerEl.addEventListener('click', (e) => {
                e.stopPropagation(); // Evitar que se propague al mapa
                
                // Abrir el modal de Vehicle Fleet Status directamente con Zetrabot 2
                openVehicleStatusModal(2);
              });


              // Marcador para Battery Station
              // 4. Trailer (Hijo 2 del Warehouse)
              const batteryMarkerEl = document.createElement('div');
              batteryMarkerEl.style.width = '55px';
              batteryMarkerEl.style.height = '55px';
              batteryMarkerEl.style.cursor = 'pointer';
              batteryMarkerEl.style.opacity = '0';
              batteryMarkerEl.style.visibility = 'hidden';
              batteryMarkerEl.style.transition = 'opacity 0.3s';
              batteryMarkerEl.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 52 52" style="transition: transform 0.2s ease-in-out;">
   <defs>
        <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
            <feDropShadow dx="0" dy="0" stdDeviation="2" flood-color="white" flood-opacity="0.9"/>
        </filter>
        <filter id="trailer-icon-shadow" x="-20%" y="-20%" width="140%" height="140%">
            <feDropShadow dx="0" dy="0" stdDeviation="1" flood-color="#ff7f50" flood-opacity="1"/>
        </filter>
    </defs>
    <g style="filter: url(#shadow);">
        <!-- The pin shape -->
        <path fill="#0b2545" fill-opacity="0.7" stroke="white" stroke-width="2" d="M26 4C15.5 4 7 12.5 7 23c0 12.5 19 25 19 25s19-12.5 19-25C45 12.5 36.5 4 26 4z"/>

        <!-- The battery station icon, scaled and centered inside the circle -->
        <g transform="translate(12,9) scale(0.11)" style="filter: url(#shadow);">
        <g fill="none" stroke="white" stroke-width="18" stroke-linecap="round" stroke-linejoin="round" style="opacity: 0.4;">
            <polyline points="112 168 128 128 96 128 112 88"/>
            <path d="M56,216V56A16,16,0,0,1,72,40h80a16,16,0,0,1,16,16V216"/>
            <line x1="32" y1="216" x2="192" y2="216"/>
            <path d="M168,112h24a16,16,0,0,1,16,16v40a16,16,0,0,0,16,16h0a16,16,0,0,0,16-16V86.63a16,16,0,0,0-4.69-11.32L216,56"/>
        </g>
        <g fill="none" stroke="#4ABBBD" stroke-width="16" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="112 168 128 128 96 128 112 88"/>
            <path d="M56,216V56A16,16,0,0,1,72,40h80a16,16,0,0,1,16,16V216"/>
            <line x1="32" y1="216" x2="192" y2="216"/>
            <path d="M168,112h24a16,16,0,0,1,16,16v40a16,16,0,0,0,16,16h0a16,16,0,0,0,16-16V86.63a16,16,0,0,0-4.69-11.32L216,56"/>
        </g>
      </g>
    </svg>`;

              // Hacer el pin de Battery Station clickeable para abrir el modal
              batteryMarkerEl.style.cursor = 'pointer';
              batteryMarkerEl.addEventListener('click', (e) => {
                e.stopPropagation();
                openVehicleStatusModal(3); // Índice 3 = Battery Station
              });

              const batteryMarker = new mapboxgl.Marker(batteryMarkerEl).setLngLat(warehouseCoords).addTo(map3);

              // Lógica del clic para desplegar/ocultar
              warehouseMarkerEl.addEventListener('click', (e) => {
                e.stopPropagation(); // Evita que el clic se propague al mapa
                childMarkersVisible = !childMarkersVisible;
                const zetrabotEl = zetrabotMarker.getElement();
                const batteryEl = batteryMarker.getElement();
                const zetrabotSvg = zetrabotEl.querySelector('svg');
                const batterySvg = batteryEl.querySelector('svg');

                if (childMarkersVisible) {
                  zetrabotEl.style.visibility = 'visible';
                  zetrabotEl.style.opacity = '1';
                  zetrabotSvg.style.transform = 'translate(-55px, -45px)';
                  
                  batteryEl.style.visibility = 'visible';
                  batteryEl.style.opacity = '1';
                  batterySvg.style.transform = 'translate(45px, -85px)';
                } else {
                  zetrabotEl.style.opacity = '0';
                  zetrabotSvg.style.transform = 'translate(0, 0)';
                  
                  batteryEl.style.opacity = '0';
                  batterySvg.style.transform = 'translate(0, 0)';

                  setTimeout(() => {
                    // Solo oculta si todavía están en estado no visible
                    if (!childMarkersVisible) {
                      zetrabotEl.style.visibility = 'hidden';
                      batteryEl.style.visibility = 'hidden';
                    }
                  }, 300); // Coincide con la duración de la transición
                }
              });

              // Custom zoom controls
              const zoomIncrement = 0.3;
              const zoomDuration = 500;

              document.getElementById('zoom-in-btn').addEventListener('click', () => {
                  map3.easeTo({ zoom: map3.getZoom() + zoomIncrement, duration: zoomDuration });
              });

              document.getElementById('zoom-out-btn').addEventListener('click', () => {
                  map3.easeTo({ zoom: map3.getZoom() - zoomIncrement, duration: zoomDuration });
              });

              console.log("Map layers loaded successfully.");
          });

          // Globe spinning logic (unchanged)
          const secondsPerRevolution = 240;
          const maxSpinZoom = 5;
          const slowSpinZoom = 0;
          let userInteracting = false;
          const spinEnabled = true;

          function spinGlobe() {
              const zoom = map3.getZoom();
              if (spinEnabled && !userInteracting && zoom < maxSpinZoom) {
                  let distancePerSecond = 360 / secondsPerRevolution;
                  if (zoom > slowSpinZoom) {
                      const zoomDif = (maxSpinZoom - zoom) / (maxSpinZoom - slowSpinZoom);
                      distancePerSecond *= zoomDif;
                  }
                  const center = map3.getCenter();
                  center.lng -= distancePerSecond;
                  map3.easeTo({ center, duration: 1000, easing: (n) => n });
              }
          }

          map3.on('mousedown', () => { userInteracting = true; });
          map3.on('dragstart', () => { userInteracting = true; });
          map3.on('moveend', () => { spinGlobe(); });

          spinGlobe();
        })();

        // ====================================        FUNCIONALIDAD DEL SLIDER DE BATERÍAS           ===========================================
        
        // Variables para el slider de baterías
        let currentBatteryIndex = 0;
        const totalBatteries = 3;
        const batteryNames = ['ZT-145 (Poor)', 'ZT-145 (Fixed)', 'ZT-167 (Swappable)'];

        // Función para mostrar una batería específica
        function showBattery(index) {
          // Ocultar todos los slides
          for (let i = 1; i <= 3; i++) {
            const slide = document.getElementById(`battery-00${i}`);
            if (slide) {
              slide.classList.remove('active');
              slide.classList.add('hidden');
            }
          }

          // Mostrar el slide actual
          const currentSlide = document.getElementById(`battery-00${index + 1}`);
          if (currentSlide) {
            currentSlide.classList.remove('hidden');
            currentSlide.classList.add('active');
          }

          // Actualizar el contador
          const counter = document.getElementById('batteryCounter');
          if (counter) {
            counter.textContent = batteryNames[index].split(' ')[0];
          }

          // Actualizar indicadores
          updateBatterySlideIndicators(index);
          
          // Animar las barras de progreso
          setTimeout(() => {
            const progressBars = currentSlide.querySelectorAll('.progress-bar-animate');
            progressBars.forEach((bar, barIndex) => {
              bar.style.animation = 'none';
              bar.offsetHeight; // Trigger reflow
              bar.style.animation = `progressBarSlideIn 1.2s ease-out ${0.5 + (barIndex * 0.1)}s both`;
            });
          }, 200);
        }

        // Función para actualizar indicadores de slide
        function updateBatterySlideIndicators(activeIndex) {
          const indicators = document.querySelectorAll('.slide-indicator');
          indicators.forEach((indicator, index) => {
            if (index === activeIndex) {
              indicator.classList.add('active');
            } else {
              indicator.classList.remove('active');
            }
          });
        }

        // Función para ir a la batería anterior
        function prevBattery() {
          currentBatteryIndex = (currentBatteryIndex - 1 + totalBatteries) % totalBatteries;
          showBattery(currentBatteryIndex);
        }

        // Función para ir a la batería siguiente
        function nextBattery() {
          currentBatteryIndex = (currentBatteryIndex + 1) % totalBatteries;
          showBattery(currentBatteryIndex);
        }

        // Inicializar el slider cuando se carga la página
        document.addEventListener('DOMContentLoaded', function() {
          // Agregar event listeners a los botones
          const prevBtn = document.getElementById('prevBatteryBtn');
          const nextBtn = document.getElementById('nextBatteryBtn');
          
          if (prevBtn) prevBtn.addEventListener('click', prevBattery);
          if (nextBtn) nextBtn.addEventListener('click', nextBattery);

          // Agregar event listeners a los indicadores
          const indicators = document.querySelectorAll('.slide-indicator');
          indicators.forEach((indicator, index) => {
            indicator.addEventListener('click', () => {
              currentBatteryIndex = index;
              showBattery(index);
            });
          });

          // Mostrar la primera batería por defecto
          showBattery(0);
        });

        // ====================================        FUNCIONALIDAD DEL MODAL DE BATERÍAS           ===========================================
        
        // Variables para el modal de baterías
        let currentModalBatteryIndex = 0;
        const totalModalBatteries = 5;
        const modalBatteryNames = ['ZT-145 (Poor)', 'ZT-145 (Fixed)', 'ZT-167 (Swappable)', 'ZT-201 (Good)', 'ZT-156 (Good)'];

        // Función para abrir el modal
        function openBatteryListModal() {
          const modal = document.getElementById('batteryListModal');
          if (modal) {
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            document.body.style.overflow = 'hidden';
            
            // Mostrar la primera batería por defecto
            setTimeout(() => {
              showModalBattery(0);
            }, 100);
          }
        }

        // Función para cerrar el modal
        function closeBatteryListModal() {
          const modal = document.getElementById('batteryListModal');
          if (modal) {
            modal.classList.remove('flex');
            modal.classList.add('hidden');
            document.body.style.overflow = 'auto';
          }
        }

        // Función para mostrar una batería específica en el modal
        function showModalBattery(index) {
          // Ocultar todos los slides
          for (let i = 1; i <= 5; i++) {
            const slide = document.getElementById(`modal-battery-00${i}`);
            if (slide) {
              slide.classList.remove('active');
              slide.classList.add('hidden');
            }
          }

          // Mostrar el slide actual
          const currentSlide = document.getElementById(`modal-battery-00${index + 1}`);
          if (currentSlide) {
            currentSlide.classList.remove('hidden');
            currentSlide.classList.add('active');
          }

          // Actualizar el contador
          const counter = document.getElementById('modalBatteryCounter');
          if (counter) {
            counter.textContent = modalBatteryNames[index].split(' ')[0];
          }

          // Actualizar indicadores
          updateModalBatterySlideIndicators(index);
          
          // Animar las barras de progreso
          setTimeout(() => {
            const progressBars = currentSlide.querySelectorAll('.progress-bar-animate');
            progressBars.forEach((bar, barIndex) => {
              bar.style.animation = 'none';
              bar.offsetHeight; // Trigger reflow
              bar.style.animation = `progressBarSlideIn 1.2s ease-out ${0.5 + (barIndex * 0.1)}s both`;
            });
          }, 200);
        }

        // Función para actualizar indicadores de slide del modal
        function updateModalBatterySlideIndicators(activeIndex) {
          const indicators = document.querySelectorAll('.modal-slide-indicator');
          indicators.forEach((indicator, index) => {
            if (index === activeIndex) {
              indicator.classList.add('active');
            } else {
              indicator.classList.remove('active');
            }
          });
        }

        // Función para ir a la batería anterior en el modal
        function modalPrevBattery() {
          currentModalBatteryIndex = (currentModalBatteryIndex - 1 + totalModalBatteries) % totalModalBatteries;
          showModalBattery(currentModalBatteryIndex);
        }

        // Función para ir a la batería siguiente en el modal
        function modalNextBattery() {
          currentModalBatteryIndex = (currentModalBatteryIndex + 1) % totalModalBatteries;
          showModalBattery(currentModalBatteryIndex);
        }

        // Inicializar el modal cuando se carga la página
        document.addEventListener('DOMContentLoaded', function() {
          // Agregar event listeners a los botones del modal
          const modalPrevBtn = document.getElementById('modalPrevBatteryBtn');
          const modalNextBtn = document.getElementById('modalNextBatteryBtn');
          
          if (modalPrevBtn) modalPrevBtn.addEventListener('click', modalPrevBattery);
          if (modalNextBtn) modalNextBtn.addEventListener('click', modalNextBattery);

          // Agregar event listeners a los indicadores del modal
          const modalIndicators = document.querySelectorAll('.modal-slide-indicator');
          modalIndicators.forEach((indicator, index) => {
            indicator.addEventListener('click', () => {
              currentModalBatteryIndex = index;
              showModalBattery(index);
            });
          });

          // Cerrar modal al hacer clic en el backdrop
          const modalBackdrop = document.getElementById('batteryListModal');
          if (modalBackdrop) {
            modalBackdrop.addEventListener('click', (e) => {
              if (e.target === modalBackdrop) {
                closeBatteryListModal();
              }
            });
          }
        });

        // ====================================        SIMULACIÓN DE BATERÍA           ===========================================
        
        // Función para simular la descarga de batería de Zetrabot 1 (baja 0.04 cada 7 segundos)
        function simulateBatteryDrain() {
          const batteryElement = document.getElementById('zetrabot1-battery');
          if (!batteryElement) return;
          
          let currentBattery = 65.46; // Valor inicial con decimales
          
          const drainInterval = setInterval(() => {
            if (currentBattery > 0) {
              // Aplicar efecto visual de cambio
              batteryElement.classList.add('battery-value-changing');
              
              // Reducir batería en 0.04
              currentBattery = Math.max(0, currentBattery - 0.04);
              
              // Actualizar el HTML manteniendo los decimales pequeños y los puntos
              const [integer, decimal] = currentBattery.toFixed(2).split('.');
              batteryElement.innerHTML = integer + '<span class="battery-decimal">.' + decimal + '</span > %<span class="battery-dots"></span>';
              
              // Los valores de batería se mantienen en blanco (sin colores especiales)
              batteryElement.classList.remove('battery-low', 'battery-critical');
              
              // Remover la clase de animación después de completarse
              setTimeout(() => {
                batteryElement.classList.remove('battery-value-changing');
              }, 800);
              
              console.log(`Zetrabot 1 battery: ${currentBattery.toFixed(2)}%`);
            } else {
              // Batería agotada
              clearInterval(drainInterval);
              batteryElement.innerHTML = '0<span class="battery-decimal">.00</span>%<span class="battery-dots"></span>';
              console.log('Zetrabot 1 battery depleted!');
            }
          }, 7000); // Cambiar cada 7 segundos
          
          // Retornar el intervalo para poder detenerlo si es necesario
          return drainInterval;
        }
        
        // Función para simular la carga de batería de Zetrabot 2 (sube 0.01 cada 7 segundos)
        function simulateBatteryCharge() {
          const batteryElement = document.getElementById('zetrabot2-battery');
          if (!batteryElement) return;
          
          let currentBattery = 22.36; // Valor inicial con decimales
          
          const chargeInterval = setInterval(() => {
            if (currentBattery < 100) {
              // Aplicar efecto visual de cambio
              batteryElement.classList.add('battery-value-changing');
              
              // Aumentar batería en 0.01
              currentBattery = Math.min(100, currentBattery + 0.01);
              
              // Actualizar el HTML manteniendo los decimales pequeños y los puntos
              const [integer, decimal] = currentBattery.toFixed(2).split('.');
              batteryElement.innerHTML = integer + '<span class="battery-decimal">.' + decimal + '</span>%<span class="battery-dots"></span>';
              
              // Los valores de batería se mantienen en blanco (sin colores especiales)
              batteryElement.classList.remove('battery-low', 'battery-critical');
              
              // Remover la clase de animación después de completarse
              setTimeout(() => {
                batteryElement.classList.remove('battery-value-changing');
              }, 800);
              
              console.log(`Zetrabot 2 battery: ${currentBattery.toFixed(2)}%`);
            } else {
              // Batería completamente cargada
              clearInterval(chargeInterval);
              batteryElement.innerHTML = '100<span class="battery-decimal">.00</span>%<span class="battery-dots"></span>';
              console.log('Zetrabot 2 battery fully charged!');
            }
          }, 7000); // Cambiar cada 7 segundos
          
          // Retornar el intervalo para poder detenerlo si es necesario
          return chargeInterval;
        }
        
        // Función para inicializar los valores de batería en el HTML
        function initializeBatteryValues() {
          // Zetrabot 1 - valor inicial 61%
          const zetrabot1Element = document.getElementById('zetrabot1-battery');
          if (zetrabot1Element) {
            zetrabot1Element.innerHTML = '61<span class="battery-decimal">.0</span>%<span class="battery-dots"></span>';
          }
          
          // Zetrabot 2 - valor inicial 23%
          const zetrabot2Element = document.getElementById('zetrabot2-battery');
          if (zetrabot2Element) {
            zetrabot2Element.innerHTML = '23<span class="battery-decimal">.0</span>%<span class="battery-dots"></span>';
          }
          
          console.log('Battery values initialized: Zetrabot 1 (61.0%), Zetrabot 2 (23.0%)');
        }
        
        // Función para animar contadores desde 0 hasta el valor final
        function animateCounter(element, start, end, suffix = '', duration = 1500) {
          if (!element) return;
          
          const startTime = performance.now();
          const difference = end - start;
          
          function updateCounter(currentTime) {
            const elapsed = currentTime - startTime;
            const progress = Math.min(elapsed / duration, 1);
            
            // Función de easing para aceleración rápida al inicio y desaceleración suave al final
            const easeProgress = 1 - Math.pow(1 - progress, 2.5);
            
            const currentValue = start + (difference * easeProgress);
            
            // Actualizar el elemento
            if (suffix === '%') {
              element.textContent = Math.round(currentValue) + suffix;
            } else {
              element.textContent = currentValue.toFixed(1) + suffix;
            }
            
            // Continuar la animación si no ha terminado
            if (progress < 1) {
              requestAnimationFrame(updateCounter);
            }
          }
          
          // Iniciar la animación
          requestAnimationFrame(updateCounter);
        }
        
        // Función para actualizar dinámicamente el Energy Summary
        function updateEnergySummary(animate = false) {
          // Valores corregidos según la referencia lógica: total capacity 40 kWh (100%)
          const zetrabot1Percent = 61.0; // Valor corregido
          const zetrabot3Percent = 80.0; // Valor corregido
          const zetrabot2Percent = 23.0; // Valor corregido
          const batteryStationPercent = 100.0; // Valor corregido
          
          // Calcular kWh para cada vehículo (100% = 40 kWh)
          const zetrabot1Kwh = (zetrabot1Percent * 40) / 100;
          const zetrabot3Kwh = (zetrabot3Percent * 40) / 100;
          const zetrabot2Kwh = (zetrabot2Percent * 40) / 100;
          const batteryStationKwh = (batteryStationPercent * 40) / 100;
          
          // Calcular totales del sistema
          const totalCapacity = 40 * 4; // 160 kWh (4 vehículos de 40 kWh cada uno)
          const totalAvailable = zetrabot1Kwh + zetrabot3Kwh + zetrabot2Kwh + batteryStationKwh;
          const averagePercent = (zetrabot1Percent + zetrabot3Percent + zetrabot2Percent + batteryStationPercent) / 4;
          // const operationalRange = 196; // Valor fijo para Energy Consumed - Ya no se usa
          
          // Calcular horas estimadas (consumo promedio de 19 kWh por hora)
          const estimatedHours = totalAvailable / 19;
          
          // Actualizar los gráficos pequeños de vehículos
          const energyZetrabot1Percent = document.getElementById('energy-zetrabot1-percent');
          const energyZetrabot1Kwh = document.getElementById('energy-zetrabot1-kwh');
          if (energyZetrabot1Percent) {
            if (animate) {
              animateCounter(energyZetrabot1Percent, 0, Math.round(zetrabot1Percent), '%', 1500);
            } else {
              energyZetrabot1Percent.textContent = Math.round(zetrabot1Percent) + '%';
            }
          }
          if (energyZetrabot1Kwh) energyZetrabot1Kwh.textContent = zetrabot1Kwh.toFixed(1) + ' kWh';
          
          const energyZetrabot3Percent = document.getElementById('energy-zetrabot3-percent');
          const energyZetrabot3Kwh = document.getElementById('energy-zetrabot3-kwh');
          if (energyZetrabot3Percent) {
            if (animate) {
              animateCounter(energyZetrabot3Percent, 0, Math.round(zetrabot3Percent), '%', 1500);
            } else {
              energyZetrabot3Percent.textContent = Math.round(zetrabot3Percent) + '%';
            }
          }
          if (energyZetrabot3Kwh) energyZetrabot3Kwh.textContent = zetrabot3Kwh.toFixed(1) + ' kWh';
          
          const energyZetrabot2Percent = document.getElementById('energy-zetrabot2-percent');
          const energyZetrabot2Kwh = document.getElementById('energy-zetrabot2-kwh');
          if (energyZetrabot2Percent) {
            if (animate) {
              animateCounter(energyZetrabot2Percent, 0, Math.round(zetrabot2Percent), '%', 1500);
            } else {
              energyZetrabot2Percent.textContent = Math.round(zetrabot2Percent) + '%';
            }
          }
          if (energyZetrabot2Percent) energyZetrabot2Percent.classList.add('battery-value-change');
          if (energyZetrabot2Kwh) energyZetrabot2Kwh.textContent = zetrabot2Kwh.toFixed(1) + ' kWh';
          
          const energyBatteryStationPercent = document.getElementById('energy-battery-station-percent');
          const energyBatteryStationKwh = document.getElementById('energy-battery-station-kwh');
          if (energyBatteryStationPercent) {
            if (animate) {
              animateCounter(energyBatteryStationPercent, 0, Math.round(batteryStationPercent), '%', 1500);
            } else {
              energyBatteryStationPercent.textContent = Math.round(batteryStationPercent) + '%';
            }
          }
          if (energyBatteryStationKwh) energyBatteryStationKwh.textContent = batteryStationKwh.toFixed(1) + ' kWh';
          
          // Actualizar el gráfico central del sistema
          const energySystemPercent = document.getElementById('energy-system-percent');
          const energySystemAvailable = document.getElementById('energy-system-available');
          const energySystemTotal = document.getElementById('energy-system-total');
          const energySystemHours = document.getElementById('energy-system-hours');
          
          if (energySystemPercent) {
            if (animate) {
              animateCounter(energySystemPercent, 0, averagePercent, '%', 1500);
            } else {
              energySystemPercent.textContent = averagePercent.toFixed(1) + '%';
            }
          }
          if (energySystemAvailable) energySystemAvailable.textContent = Math.round(totalAvailable);
          if (energySystemTotal) energySystemTotal.textContent = totalCapacity;
          if (energySystemHours) energySystemHours.textContent = estimatedHours.toFixed(1);
          
          // Actualizar las tarjetas principales
          const energyTotalCapacity = document.getElementById('energy-total-capacity');
          const energyAvailable = document.getElementById('energy-available');
          // const energyAvailablePercent = document.getElementById('energy-available-percent'); // Ya no se usa
          // const energyOperationalRange = document.getElementById('energy-operational-range'); // Ya no se usa
          
          if (energyTotalCapacity) energyTotalCapacity.textContent = totalCapacity + ' kWh';
          if (energyAvailable) energyAvailable.textContent = Math.round(totalAvailable) + ' kWh';
          // if (energyAvailablePercent) {
          //   if (animate) {
          //     animateCounter(energyAvailablePercent, 0, averagePercent, '%', 1500);
          //   } else {
          //     energyAvailablePercent.textContent = averagePercent.toFixed(1) + '%';
          //   }
          // }
          // if (energyOperationalRange) energyOperationalRange.textContent = Math.round(operationalRange) + ' kWh';
          
          console.log('Energy Summary updated:', {
            totalCapacity: totalCapacity + ' kWh',
            totalAvailable: totalAvailable.toFixed(1) + ' kWh',
            averagePercent: averagePercent.toFixed(1) + '%',
            estimatedHours: estimatedHours.toFixed(1) + ' hours'
          });
        }
        
        // Iniciar la simulación cuando se carga la página
        document.addEventListener('DOMContentLoaded', () => {
          // Inicializar valores de batería inmediatamente
          initializeBatteryValues();
          
          // Esperar un poco para que el modal se inicialice
          setTimeout(() => {
            simulateBatteryDrain(); // Zetrabot 1 - descarga
            simulateBatteryCharge(); // Zetrabot 2 - carga
            
            // Actualizar el Energy Summary cada 7 segundos (sincronizado con los cambios de batería)
            setInterval(() => updateEnergySummary(false), 7000);
          }, 2000);
        });
    

    
    </script>
  </body>
</html>
</html>